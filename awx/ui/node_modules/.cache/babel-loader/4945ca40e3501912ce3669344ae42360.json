{"ast":null,"code":"import _asyncToGenerator from\"/awx_devel/awx/ui/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _classCallCheck from\"/awx_devel/awx/ui/node_modules/@babel/runtime/helpers/esm/classCallCheck.js\";import _createClass from\"/awx_devel/awx/ui/node_modules/@babel/runtime/helpers/esm/createClass.js\";import _assertThisInitialized from\"/awx_devel/awx/ui/node_modules/@babel/runtime/helpers/esm/assertThisInitialized.js\";import _inherits from\"/awx_devel/awx/ui/node_modules/@babel/runtime/helpers/esm/inherits.js\";import _createSuper from\"/awx_devel/awx/ui/node_modules/@babel/runtime/helpers/esm/createSuper.js\";import _regeneratorRuntime from\"/awx_devel/awx/ui/node_modules/@babel/runtime/regenerator/index.js\";import Base from'../Base';var Credentials=/*#__PURE__*/function(_Base){_inherits(Credentials,_Base);var _super=_createSuper(Credentials);function Credentials(http){var _this;_classCallCheck(this,Credentials);_this=_super.call(this,http);_this.baseUrl='api/v2/credentials/';_this.readAccessList=_this.readAccessList.bind(_assertThisInitialized(_this));_this.readAccessOptions=_this.readAccessOptions.bind(_assertThisInitialized(_this));_this.readInputSources=_this.readInputSources.bind(_assertThisInitialized(_this));return _this;}_createClass(Credentials,[{key:\"readAccessList\",value:function readAccessList(id,params){return this.http.get(\"\".concat(this.baseUrl).concat(id,\"/access_list/\"),{params:params});}},{key:\"readAccessOptions\",value:function readAccessOptions(id){return this.http.options(\"\".concat(this.baseUrl).concat(id,\"/access_list/\"));}},{key:\"readInputSources\",value:function readInputSources(id){var _this2=this;var maxRequests=5;var requestCounter=0;var fetchInputSources=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var pageNo,inputSources,_yield$_this2$http$ge,data,_args=arguments;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:pageNo=_args.length>0&&_args[0]!==undefined?_args[0]:1;inputSources=_args.length>1&&_args[1]!==undefined?_args[1]:[];_context.prev=2;requestCounter++;_context.next=6;return _this2.http.get(\"\".concat(_this2.baseUrl).concat(id,\"/input_sources/\"),{params:{page:pageNo,page_size:200}});case 6:_yield$_this2$http$ge=_context.sent;data=_yield$_this2$http$ge.data;if(!(data!==null&&data!==void 0&&data.next&&requestCounter<=maxRequests)){_context.next=10;break;}return _context.abrupt(\"return\",fetchInputSources(pageNo+1,inputSources.concat(data.results)));case 10:return _context.abrupt(\"return\",Promise.resolve({data:{results:inputSources.concat(data.results)}}));case 13:_context.prev=13;_context.t0=_context[\"catch\"](2);return _context.abrupt(\"return\",Promise.reject(_context.t0));case 16:case\"end\":return _context.stop();}}},_callee,null,[[2,13]]);}));return function fetchInputSources(){return _ref.apply(this,arguments);};}();return fetchInputSources();}},{key:\"test\",value:function test(id,data){return this.http.post(\"\".concat(this.baseUrl).concat(id,\"/test/\"),data);}}]);return Credentials;}(Base);export default Credentials;","map":{"version":3,"names":["Base","Credentials","_Base","_inherits","_super","_createSuper","http","_this","_classCallCheck","call","baseUrl","readAccessList","bind","_assertThisInitialized","readAccessOptions","readInputSources","_createClass","key","value","id","params","get","concat","options","_this2","maxRequests","requestCounter","fetchInputSources","_ref","_asyncToGenerator","_regeneratorRuntime","mark","_callee","pageNo","inputSources","_yield$_this2$http$ge","data","_args","arguments","wrap","_callee$","_context","prev","next","length","undefined","page","page_size","sent","abrupt","results","Promise","resolve","t0","reject","stop","apply","test","post"],"sources":["/awx_devel/awx/ui/src/api/models/Credentials.js"],"sourcesContent":["import Base from '../Base';\n\nclass Credentials extends Base {\n  constructor(http) {\n    super(http);\n    this.baseUrl = 'api/v2/credentials/';\n\n    this.readAccessList = this.readAccessList.bind(this);\n    this.readAccessOptions = this.readAccessOptions.bind(this);\n    this.readInputSources = this.readInputSources.bind(this);\n  }\n\n  readAccessList(id, params) {\n    return this.http.get(`${this.baseUrl}${id}/access_list/`, {\n      params,\n    });\n  }\n\n  readAccessOptions(id) {\n    return this.http.options(`${this.baseUrl}${id}/access_list/`);\n  }\n\n  readInputSources(id) {\n    const maxRequests = 5;\n    let requestCounter = 0;\n    const fetchInputSources = async (pageNo = 1, inputSources = []) => {\n      try {\n        requestCounter++;\n        const { data } = await this.http.get(\n          `${this.baseUrl}${id}/input_sources/`,\n          {\n            params: {\n              page: pageNo,\n              page_size: 200,\n            },\n          }\n        );\n        if (data?.next && requestCounter <= maxRequests) {\n          return fetchInputSources(\n            pageNo + 1,\n            inputSources.concat(data.results)\n          );\n        }\n        return Promise.resolve({\n          data: {\n            results: inputSources.concat(data.results),\n          },\n        });\n      } catch (error) {\n        return Promise.reject(error);\n      }\n    };\n\n    return fetchInputSources();\n  }\n\n  test(id, data) {\n    return this.http.post(`${this.baseUrl}${id}/test/`, data);\n  }\n}\n\nexport default Credentials;\n"],"mappings":"otBAAA,MAAO,CAAAA,IAAI,KAAM,SAAS,CAAC,GAErB,CAAAC,WAAW,uBAAAC,KAAA,EAAAC,SAAA,CAAAF,WAAA,CAAAC,KAAA,MAAAE,MAAA,CAAAC,YAAA,CAAAJ,WAAA,EACf,SAAAA,YAAYK,IAAI,CAAE,KAAAC,KAAA,CAAAC,eAAA,MAAAP,WAAA,EAChBM,KAAA,CAAAH,MAAA,CAAAK,IAAA,MAAMH,IAAI,EACVC,KAAA,CAAKG,OAAO,CAAG,qBAAqB,CAEpCH,KAAA,CAAKI,cAAc,CAAGJ,KAAA,CAAKI,cAAc,CAACC,IAAI,CAAAC,sBAAA,CAAAN,KAAA,CAAK,CAAC,CACpDA,KAAA,CAAKO,iBAAiB,CAAGP,KAAA,CAAKO,iBAAiB,CAACF,IAAI,CAAAC,sBAAA,CAAAN,KAAA,CAAK,CAAC,CAC1DA,KAAA,CAAKQ,gBAAgB,CAAGR,KAAA,CAAKQ,gBAAgB,CAACH,IAAI,CAAAC,sBAAA,CAAAN,KAAA,CAAK,CAAC,CAAC,OAAAA,KAAA,CAC3D,CAACS,YAAA,CAAAf,WAAA,GAAAgB,GAAA,kBAAAC,KAAA,CAED,SAAAP,eAAeQ,EAAE,CAAEC,MAAM,CAAE,CACzB,MAAO,KAAI,CAACd,IAAI,CAACe,GAAG,IAAAC,MAAA,CAAI,IAAI,CAACZ,OAAO,EAAAY,MAAA,CAAGH,EAAE,kBAAiB,CACxDC,MAAM,CAANA,MACF,CAAC,CAAC,CACJ,CAAC,GAAAH,GAAA,qBAAAC,KAAA,CAED,SAAAJ,kBAAkBK,EAAE,CAAE,CACpB,MAAO,KAAI,CAACb,IAAI,CAACiB,OAAO,IAAAD,MAAA,CAAI,IAAI,CAACZ,OAAO,EAAAY,MAAA,CAAGH,EAAE,iBAAe,CAAC,CAC/D,CAAC,GAAAF,GAAA,oBAAAC,KAAA,CAED,SAAAH,iBAAiBI,EAAE,CAAE,KAAAK,MAAA,MACnB,GAAM,CAAAC,WAAW,CAAG,CAAC,CACrB,GAAI,CAAAC,cAAc,CAAG,CAAC,CACtB,GAAM,CAAAC,iBAAiB,6BAAAC,IAAA,CAAAC,iBAAA,cAAAC,mBAAA,CAAAC,IAAA,CAAG,SAAAC,QAAA,MAAAC,MAAA,CAAAC,YAAA,CAAAC,qBAAA,CAAAC,IAAA,CAAAC,KAAA,CAAAC,SAAA,QAAAR,mBAAA,CAAAS,IAAA,UAAAC,SAAAC,QAAA,kBAAAA,QAAA,CAAAC,IAAA,CAAAD,QAAA,CAAAE,IAAA,SAAOV,MAAM,CAAAI,KAAA,CAAAO,MAAA,IAAAP,KAAA,MAAAQ,SAAA,CAAAR,KAAA,IAAG,CAAC,CAAEH,YAAY,CAAAG,KAAA,CAAAO,MAAA,IAAAP,KAAA,MAAAQ,SAAA,CAAAR,KAAA,IAAG,EAAE,CAAAI,QAAA,CAAAC,IAAA,GAE1DhB,cAAc,EAAE,CAACe,QAAA,CAAAE,IAAA,SACM,CAAAnB,MAAI,CAAClB,IAAI,CAACe,GAAG,IAAAC,MAAA,CAC/BE,MAAI,CAACd,OAAO,EAAAY,MAAA,CAAGH,EAAE,oBACpB,CACEC,MAAM,CAAE,CACN0B,IAAI,CAAEb,MAAM,CACZc,SAAS,CAAE,GACb,CACF,CACF,CAAC,QAAAZ,qBAAA,CAAAM,QAAA,CAAAO,IAAA,CAROZ,IAAI,CAAAD,qBAAA,CAAJC,IAAI,MASRA,IAAI,SAAJA,IAAI,WAAJA,IAAI,CAAEO,IAAI,EAAIjB,cAAc,EAAID,WAAW,GAAAgB,QAAA,CAAAE,IAAA,kBAAAF,QAAA,CAAAQ,MAAA,UACtCtB,iBAAiB,CACtBM,MAAM,CAAG,CAAC,CACVC,YAAY,CAACZ,MAAM,CAACc,IAAI,CAACc,OAAO,CAClC,CAAC,iBAAAT,QAAA,CAAAQ,MAAA,UAEIE,OAAO,CAACC,OAAO,CAAC,CACrBhB,IAAI,CAAE,CACJc,OAAO,CAAEhB,YAAY,CAACZ,MAAM,CAACc,IAAI,CAACc,OAAO,CAC3C,CACF,CAAC,CAAC,UAAAT,QAAA,CAAAC,IAAA,IAAAD,QAAA,CAAAY,EAAA,CAAAZ,QAAA,oBAAAA,QAAA,CAAAQ,MAAA,UAEKE,OAAO,CAACG,MAAM,CAAAb,QAAA,CAAAY,EAAM,CAAC,2BAAAZ,QAAA,CAAAc,IAAA,OAAAvB,OAAA,iBAE/B,kBA1BK,CAAAL,iBAAiBA,CAAA,SAAAC,IAAA,CAAA4B,KAAA,MAAAlB,SAAA,OA0BtB,CAED,MAAO,CAAAX,iBAAiB,CAAC,CAAC,CAC5B,CAAC,GAAAV,GAAA,QAAAC,KAAA,CAED,SAAAuC,KAAKtC,EAAE,CAAEiB,IAAI,CAAE,CACb,MAAO,KAAI,CAAC9B,IAAI,CAACoD,IAAI,IAAApC,MAAA,CAAI,IAAI,CAACZ,OAAO,EAAAY,MAAA,CAAGH,EAAE,WAAUiB,IAAI,CAAC,CAC3D,CAAC,WAAAnC,WAAA,GAxDuBD,IAAI,EA2D9B,cAAe,CAAAC,WAAW"},"metadata":{},"sourceType":"module"}