{"ast":null,"code":"import _asyncToGenerator from\"/awx_devel/awx/ui/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"/awx_devel/awx/ui/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import _regeneratorRuntime from\"/awx_devel/awx/ui/node_modules/@babel/runtime/regenerator/index.js\";import React,{useState,useEffect,useCallback}from'react';import{useHistory}from'react-router-dom';import{Card,PageSection}from'@patternfly/react-core';import{CardBody}from'components/Card';import{InstanceGroupsAPI}from'api';import useRequest from'hooks/useRequest';import ContentError from'components/ContentError';import ContentLoading from'components/ContentLoading';import ContainerGroupForm from'../shared/ContainerGroupForm';import{jsx as _jsx}from\"react/jsx-runtime\";function ContainerGroupEdit(_ref){var instanceGroup=_ref.instanceGroup;var history=useHistory();var _useState=useState(null),_useState2=_slicedToArray(_useState,2),submitError=_useState2[0],setSubmitError=_useState2[1];var detailsIUrl=\"/instance_groups/container_group/\".concat(instanceGroup.id,\"/details\");var _useRequest=useRequest(useCallback(/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var _yield$InstanceGroups,data;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return InstanceGroupsAPI.readInstanceGroupOptions(instanceGroup.id);case 2:_yield$InstanceGroups=_context.sent;data=_yield$InstanceGroups.data;return _context.abrupt(\"return\",data.actions.PUT.pod_spec_override.default);case 5:case\"end\":return _context.stop();}}},_callee);})),[instanceGroup.id]),{initialPodSpec:{}}),fetchError=_useRequest.error,isLoading=_useRequest.isLoading,fetchInitialPodSpec=_useRequest.request,initialPodSpec=_useRequest.result;useEffect(function(){fetchInitialPodSpec();},[fetchInitialPodSpec]);var handleSubmit=/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(values){return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.prev=0;_context2.next=3;return InstanceGroupsAPI.update(instanceGroup.id,{name:values.name,credential:values.credential?values.credential.id:null,pod_spec_override:values.override?values.pod_spec_override:null,max_forks:values.max_forks?values.max_forks:0,max_concurrent_jobs:values.max_concurrent_jobs?values.max_concurrent_jobs:0,is_container_group:true});case 3:history.push(detailsIUrl);_context2.next=9;break;case 6:_context2.prev=6;_context2.t0=_context2[\"catch\"](0);setSubmitError(_context2.t0);case 9:case\"end\":return _context2.stop();}}},_callee2,null,[[0,6]]);}));return function handleSubmit(_x){return _ref3.apply(this,arguments);};}();var handleCancel=function handleCancel(){history.push(detailsIUrl);};if(fetchError){return/*#__PURE__*/_jsx(PageSection,{children:/*#__PURE__*/_jsx(Card,{children:/*#__PURE__*/_jsx(CardBody,{children:/*#__PURE__*/_jsx(ContentError,{error:fetchError})})})});}if(isLoading){return/*#__PURE__*/_jsx(CardBody,{children:/*#__PURE__*/_jsx(ContentLoading,{})});}return/*#__PURE__*/_jsx(CardBody,{children:/*#__PURE__*/_jsx(ContainerGroupForm,{instanceGroup:instanceGroup,initialPodSpec:initialPodSpec,onSubmit:handleSubmit,submitError:submitError,onCancel:handleCancel})});}export default ContainerGroupEdit;","map":{"version":3,"names":["React","useState","useEffect","useCallback","useHistory","Card","PageSection","CardBody","InstanceGroupsAPI","useRequest","ContentError","ContentLoading","ContainerGroupForm","jsx","_jsx","ContainerGroupEdit","_ref","instanceGroup","history","_useState","_useState2","_slicedToArray","submitError","setSubmitError","detailsIUrl","concat","id","_useRequest","_asyncToGenerator","_regeneratorRuntime","mark","_callee","_yield$InstanceGroups","data","wrap","_callee$","_context","prev","next","readInstanceGroupOptions","sent","abrupt","actions","PUT","pod_spec_override","default","stop","initialPodSpec","fetchError","error","isLoading","fetchInitialPodSpec","request","result","handleSubmit","_ref3","_callee2","values","_callee2$","_context2","update","name","credential","override","max_forks","max_concurrent_jobs","is_container_group","push","t0","_x","apply","arguments","handleCancel","children","onSubmit","onCancel"],"sources":["/awx_devel/awx/ui/src/screens/InstanceGroup/ContainerGroupEdit/ContainerGroupEdit.js"],"sourcesContent":["import React, { useState, useEffect, useCallback } from 'react';\nimport { useHistory } from 'react-router-dom';\nimport { Card, PageSection } from '@patternfly/react-core';\n\nimport { CardBody } from 'components/Card';\nimport { InstanceGroupsAPI } from 'api';\nimport useRequest from 'hooks/useRequest';\nimport ContentError from 'components/ContentError';\nimport ContentLoading from 'components/ContentLoading';\nimport ContainerGroupForm from '../shared/ContainerGroupForm';\n\nfunction ContainerGroupEdit({ instanceGroup }) {\n  const history = useHistory();\n  const [submitError, setSubmitError] = useState(null);\n  const detailsIUrl = `/instance_groups/container_group/${instanceGroup.id}/details`;\n\n  const {\n    error: fetchError,\n    isLoading,\n    request: fetchInitialPodSpec,\n    result: initialPodSpec,\n  } = useRequest(\n    useCallback(async () => {\n      const { data } = await InstanceGroupsAPI.readInstanceGroupOptions(\n        instanceGroup.id\n      );\n      return data.actions.PUT.pod_spec_override.default;\n    }, [instanceGroup.id]),\n    {\n      initialPodSpec: {},\n    }\n  );\n\n  useEffect(() => {\n    fetchInitialPodSpec();\n  }, [fetchInitialPodSpec]);\n\n  const handleSubmit = async (values) => {\n    try {\n      await InstanceGroupsAPI.update(instanceGroup.id, {\n        name: values.name,\n        credential: values.credential ? values.credential.id : null,\n        pod_spec_override: values.override ? values.pod_spec_override : null,\n        max_forks: values.max_forks ? values.max_forks : 0,\n        max_concurrent_jobs: values.max_concurrent_jobs\n          ? values.max_concurrent_jobs\n          : 0,\n        is_container_group: true,\n      });\n      history.push(detailsIUrl);\n    } catch (error) {\n      setSubmitError(error);\n    }\n  };\n  const handleCancel = () => {\n    history.push(detailsIUrl);\n  };\n\n  if (fetchError) {\n    return (\n      <PageSection>\n        <Card>\n          <CardBody>\n            <ContentError error={fetchError} />\n          </CardBody>\n        </Card>\n      </PageSection>\n    );\n  }\n\n  if (isLoading) {\n    return (\n      <CardBody>\n        <ContentLoading />\n      </CardBody>\n    );\n  }\n\n  return (\n    <CardBody>\n      <ContainerGroupForm\n        instanceGroup={instanceGroup}\n        initialPodSpec={initialPodSpec}\n        onSubmit={handleSubmit}\n        submitError={submitError}\n        onCancel={handleCancel}\n      />\n    </CardBody>\n  );\n}\n\nexport default ContainerGroupEdit;\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}