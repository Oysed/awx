{"ast":null,"code":"import _objectSpread from\"/awx_devel/awx/ui/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import _asyncToGenerator from\"/awx_devel/awx/ui/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"/awx_devel/awx/ui/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import _styled from\"styled-components\";import _regeneratorRuntime from\"/awx_devel/awx/ui/node_modules/@babel/runtime/regenerator/index.js\";import{i18n}from\"@lingui/core\";import React,{useState}from'react';import{Link,useHistory}from'react-router-dom';import{Button}from'@patternfly/react-core';import{Host}from'types';import{CardBody,CardActionsRow}from'components/Card';import AlertModal from'components/AlertModal';import ErrorDetail from'components/ErrorDetail';import{DetailList,Detail,UserDateDetail}from'components/DetailList';import{VariablesDetail}from'components/CodeEditor';import Sparkline from'components/Sparkline';import DeleteButton from'components/DeleteButton';import{HostsAPI}from'api';import HostToggle from'components/HostToggle';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var _StyledHostToggle=_styled(HostToggle).withConfig({displayName:\"InventoryHostDetail___StyledHostToggle\",componentId:\"rej13i-0\"})([\"padding-bottom:40px\"]);function InventoryHostDetail(_ref){var host=_ref.host;var created=host.created,description=host.description,id=host.id,modified=host.modified,name=host.name,variables=host.variables,_host$summary_fields=host.summary_fields,inventory=_host$summary_fields.inventory,recent_jobs=_host$summary_fields.recent_jobs,created_by=_host$summary_fields.created_by,modified_by=_host$summary_fields.modified_by,user_capabilities=_host$summary_fields.user_capabilities;var _useState=useState(false),_useState2=_slicedToArray(_useState,2),isLoading=_useState2[0],setIsloading=_useState2[1];var _useState3=useState(false),_useState4=_slicedToArray(_useState3,2),deletionError=_useState4[0],setDeletionError=_useState4[1];var history=useHistory();var handleHostDelete=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:setIsloading(true);_context.prev=1;_context.next=4;return HostsAPI.destroy(id);case 4:history.push(\"/inventories/inventory/\".concat(inventory.id,\"/hosts\"));_context.next=10;break;case 7:_context.prev=7;_context.t0=_context[\"catch\"](1);setDeletionError(_context.t0);case 10:_context.prev=10;setIsloading(false);return _context.finish(10);case 13:case\"end\":return _context.stop();}}},_callee,null,[[1,7,10,13]]);}));return function handleHostDelete(){return _ref2.apply(this,arguments);};}();if(!isLoading&&deletionError){return/*#__PURE__*/_jsxs(AlertModal,{isOpen:deletionError,variant:\"error\",title:/*i18n*/i18n._(\"Error!\"),onClose:function onClose(){return setDeletionError(false);},children:[/*i18n*/i18n._(\"Failed to delete {name}.\",{name:name}),/*#__PURE__*/_jsx(ErrorDetail,{error:deletionError})]});}var recentPlaybookJobs=recent_jobs.map(function(job){return _objectSpread(_objectSpread({},job),{},{type:'job'});});return/*#__PURE__*/_jsxs(CardBody,{children:[/*#__PURE__*/_jsx(_StyledHostToggle,{host:host}),/*#__PURE__*/_jsxs(DetailList,{gutter:\"sm\",children:[/*#__PURE__*/_jsx(Detail,{label:/*i18n*/i18n._(\"Name\"),value:name}),/*#__PURE__*/_jsx(Detail,{label:/*i18n*/i18n._(\"Activity\"),value:/*#__PURE__*/_jsx(Sparkline,{jobs:recentPlaybookJobs}),isEmpty:(recentPlaybookJobs===null||recentPlaybookJobs===void 0?void 0:recentPlaybookJobs.length)===0}),/*#__PURE__*/_jsx(Detail,{label:/*i18n*/i18n._(\"Description\"),value:description}),/*#__PURE__*/_jsx(UserDateDetail,{date:created,label:/*i18n*/i18n._(\"Created\"),user:created_by}),/*#__PURE__*/_jsx(UserDateDetail,{date:modified,label:/*i18n*/i18n._(\"Last Modified\"),user:modified_by}),/*#__PURE__*/_jsx(VariablesDetail,{label:/*i18n*/i18n._(\"Variables\"),rows:4,value:variables,name:\"variables\",dataCy:\"inventory-host-detail-variables\"})]}),/*#__PURE__*/_jsxs(CardActionsRow,{children:[(user_capabilities===null||user_capabilities===void 0?void 0:user_capabilities.edit)&&/*#__PURE__*/_jsx(Button,{ouiaId:\"inventory-host-detail-edit-button\",\"aria-label\":/*i18n*/i18n._(\"edit\"),component:Link,to:\"/inventories/inventory/\".concat(inventory.id,\"/hosts/\").concat(id,\"/edit\"),children:/*i18n*/i18n._(\"Edit\")}),(user_capabilities===null||user_capabilities===void 0?void 0:user_capabilities.delete)&&/*#__PURE__*/_jsx(DeleteButton,{name:name,modalTitle:/*i18n*/i18n._(\"Delete Host\"),onConfirm:function onConfirm(){return handleHostDelete();}})]}),deletionError&&/*#__PURE__*/_jsxs(AlertModal,{isOpen:deletionError,variant:\"error\",title:/*i18n*/i18n._(\"Error!\"),onClose:function onClose(){return setDeletionError(null);},children:[/*i18n*/i18n._(\"Failed to delete host.\"),/*#__PURE__*/_jsx(ErrorDetail,{error:deletionError})]})]});}export default InventoryHostDetail;","map":{"version":3,"names":["React","useState","Link","useHistory","Button","Host","CardBody","CardActionsRow","AlertModal","ErrorDetail","DetailList","Detail","UserDateDetail","VariablesDetail","Sparkline","DeleteButton","HostsAPI","HostToggle","jsx","_jsx","jsxs","_jsxs","_StyledHostToggle","_styled","withConfig","displayName","componentId","InventoryHostDetail","_ref","host","created","description","id","modified","name","variables","_host$summary_fields","summary_fields","inventory","recent_jobs","created_by","modified_by","user_capabilities","_useState","_useState2","_slicedToArray","isLoading","setIsloading","_useState3","_useState4","deletionError","setDeletionError","history","handleHostDelete","_ref2","_asyncToGenerator","_regeneratorRuntime","mark","_callee","wrap","_callee$","_context","prev","next","destroy","push","concat","t0","finish","stop","apply","arguments","isOpen","variant","title","i18n","_","onClose","children","error","recentPlaybookJobs","map","job","_objectSpread","type","gutter","label","value","jobs","isEmpty","length","date","user","rows","dataCy","edit","ouiaId","component","to","delete","modalTitle","onConfirm"],"sources":["/awx_devel/awx/ui/src/screens/Inventory/InventoryHostDetail/InventoryHostDetail.js"],"sourcesContent":["import 'styled-components/macro';\nimport React, { useState } from 'react';\nimport { Link, useHistory } from 'react-router-dom';\n\nimport { t } from '@lingui/macro';\nimport { Button } from '@patternfly/react-core';\nimport { Host } from 'types';\nimport { CardBody, CardActionsRow } from 'components/Card';\nimport AlertModal from 'components/AlertModal';\nimport ErrorDetail from 'components/ErrorDetail';\nimport { DetailList, Detail, UserDateDetail } from 'components/DetailList';\nimport { VariablesDetail } from 'components/CodeEditor';\nimport Sparkline from 'components/Sparkline';\nimport DeleteButton from 'components/DeleteButton';\nimport { HostsAPI } from 'api';\nimport HostToggle from 'components/HostToggle';\n\nfunction InventoryHostDetail({ host }) {\n  const {\n    created,\n    description,\n    id,\n    modified,\n    name,\n    variables,\n    summary_fields: {\n      inventory,\n      recent_jobs,\n      created_by,\n      modified_by,\n      user_capabilities,\n    },\n  } = host;\n\n  const [isLoading, setIsloading] = useState(false);\n  const [deletionError, setDeletionError] = useState(false);\n  const history = useHistory();\n\n  const handleHostDelete = async () => {\n    setIsloading(true);\n    try {\n      await HostsAPI.destroy(id);\n      history.push(`/inventories/inventory/${inventory.id}/hosts`);\n    } catch (err) {\n      setDeletionError(err);\n    } finally {\n      setIsloading(false);\n    }\n  };\n\n  if (!isLoading && deletionError) {\n    return (\n      <AlertModal\n        isOpen={deletionError}\n        variant=\"error\"\n        title={t`Error!`}\n        onClose={() => setDeletionError(false)}\n      >\n        {t`Failed to delete ${name}.`}\n        <ErrorDetail error={deletionError} />\n      </AlertModal>\n    );\n  }\n\n  const recentPlaybookJobs = recent_jobs.map((job) => ({\n    ...job,\n    type: 'job',\n  }));\n\n  return (\n    <CardBody>\n      <HostToggle host={host} css=\"padding-bottom: 40px\" />\n      <DetailList gutter=\"sm\">\n        <Detail label={t`Name`} value={name} />\n        <Detail\n          label={t`Activity`}\n          value={<Sparkline jobs={recentPlaybookJobs} />}\n          isEmpty={recentPlaybookJobs?.length === 0}\n        />\n        <Detail label={t`Description`} value={description} />\n        <UserDateDetail date={created} label={t`Created`} user={created_by} />\n        <UserDateDetail\n          date={modified}\n          label={t`Last Modified`}\n          user={modified_by}\n        />\n        <VariablesDetail\n          label={t`Variables`}\n          rows={4}\n          value={variables}\n          name=\"variables\"\n          dataCy=\"inventory-host-detail-variables\"\n        />\n      </DetailList>\n      <CardActionsRow>\n        {user_capabilities?.edit && (\n          <Button\n            ouiaId=\"inventory-host-detail-edit-button\"\n            aria-label={t`edit`}\n            component={Link}\n            to={`/inventories/inventory/${inventory.id}/hosts/${id}/edit`}\n          >\n            {t`Edit`}\n          </Button>\n        )}\n        {user_capabilities?.delete && (\n          <DeleteButton\n            name={name}\n            modalTitle={t`Delete Host`}\n            onConfirm={() => handleHostDelete()}\n          />\n        )}\n      </CardActionsRow>\n      {deletionError && (\n        <AlertModal\n          isOpen={deletionError}\n          variant=\"error\"\n          title={t`Error!`}\n          onClose={() => setDeletionError(null)}\n        >\n          {t`Failed to delete host.`}\n          <ErrorDetail error={deletionError} />\n        </AlertModal>\n      )}\n    </CardBody>\n  );\n}\n\nInventoryHostDetail.propTypes = {\n  host: Host.isRequired,\n};\n\nexport default InventoryHostDetail;\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}