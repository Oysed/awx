{"ast":null,"code":"import _createForOfIteratorHelper from\"/awx_devel/awx/ui/node_modules/@babel/runtime/helpers/esm/createForOfIteratorHelper.js\";import _asyncToGenerator from\"/awx_devel/awx/ui/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _classCallCheck from\"/awx_devel/awx/ui/node_modules/@babel/runtime/helpers/esm/classCallCheck.js\";import _createClass from\"/awx_devel/awx/ui/node_modules/@babel/runtime/helpers/esm/createClass.js\";import _inherits from\"/awx_devel/awx/ui/node_modules/@babel/runtime/helpers/esm/inherits.js\";import _createSuper from\"/awx_devel/awx/ui/node_modules/@babel/runtime/helpers/esm/createSuper.js\";import _regeneratorRuntime from\"/awx_devel/awx/ui/node_modules/@babel/runtime/regenerator/index.js\";function isEqual(array1,array2){return array1.length===array2.length&&array1.every(function(element,index){return element.id===array2[index].id;});}var InstanceGroupsMixin=function InstanceGroupsMixin(parent){return/*#__PURE__*/function(_parent){_inherits(_class,_parent);var _super=_createSuper(_class);function _class(){_classCallCheck(this,_class);return _super.apply(this,arguments);}_createClass(_class,[{key:\"readInstanceGroups\",value:function readInstanceGroups(resourceId,params){return this.http.get(\"\".concat(this.baseUrl).concat(resourceId,\"/instance_groups/\"),{params:params});}},{key:\"associateInstanceGroup\",value:function associateInstanceGroup(resourceId,instanceGroupId){return this.http.post(\"\".concat(this.baseUrl).concat(resourceId,\"/instance_groups/\"),{id:instanceGroupId});}},{key:\"disassociateInstanceGroup\",value:function disassociateInstanceGroup(resourceId,instanceGroupId){return this.http.post(\"\".concat(this.baseUrl).concat(resourceId,\"/instance_groups/\"),{id:instanceGroupId,disassociate:true});}},{key:\"orderInstanceGroups\",value:function(){var _orderInstanceGroups=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(resourceId,current,original){var _iterator,_step,group,_iterator2,_step2,_group;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:if(isEqual(current,original)){_context.next=35;break;}_iterator=_createForOfIteratorHelper(original);_context.prev=2;_iterator.s();case 4:if((_step=_iterator.n()).done){_context.next=10;break;}group=_step.value;_context.next=8;return this.disassociateInstanceGroup(resourceId,group.id);case 8:_context.next=4;break;case 10:_context.next=15;break;case 12:_context.prev=12;_context.t0=_context[\"catch\"](2);_iterator.e(_context.t0);case 15:_context.prev=15;_iterator.f();return _context.finish(15);case 18:_iterator2=_createForOfIteratorHelper(current);_context.prev=19;_iterator2.s();case 21:if((_step2=_iterator2.n()).done){_context.next=27;break;}_group=_step2.value;_context.next=25;return this.associateInstanceGroup(resourceId,_group.id);case 25:_context.next=21;break;case 27:_context.next=32;break;case 29:_context.prev=29;_context.t1=_context[\"catch\"](19);_iterator2.e(_context.t1);case 32:_context.prev=32;_iterator2.f();return _context.finish(32);case 35:case\"end\":return _context.stop();}}},_callee,this,[[2,12,15,18],[19,29,32,35]]);}));function orderInstanceGroups(_x,_x2,_x3){return _orderInstanceGroups.apply(this,arguments);}return orderInstanceGroups;}()/* eslint-enable no-await-in-loop, no-restricted-syntax */}]);return _class;}(parent);};export default InstanceGroupsMixin;","map":{"version":3,"names":["isEqual","array1","array2","length","every","element","index","id","InstanceGroupsMixin","parent","_parent","_inherits","_class","_super","_createSuper","_classCallCheck","apply","arguments","_createClass","key","value","readInstanceGroups","resourceId","params","http","get","concat","baseUrl","associateInstanceGroup","instanceGroupId","post","disassociateInstanceGroup","disassociate","_orderInstanceGroups","_asyncToGenerator","_regeneratorRuntime","mark","_callee","current","original","_iterator","_step","group","_iterator2","_step2","_group","wrap","_callee$","_context","prev","next","_createForOfIteratorHelper","s","n","done","t0","e","f","finish","t1","stop","orderInstanceGroups","_x","_x2","_x3"],"sources":["/awx_devel/awx/ui/src/api/mixins/InstanceGroups.mixin.js"],"sourcesContent":["function isEqual(array1, array2) {\n  return (\n    array1.length === array2.length &&\n    array1.every((element, index) => element.id === array2[index].id)\n  );\n}\n\nconst InstanceGroupsMixin = (parent) =>\n  class extends parent {\n    readInstanceGroups(resourceId, params) {\n      return this.http.get(`${this.baseUrl}${resourceId}/instance_groups/`, {\n        params,\n      });\n    }\n\n    associateInstanceGroup(resourceId, instanceGroupId) {\n      return this.http.post(`${this.baseUrl}${resourceId}/instance_groups/`, {\n        id: instanceGroupId,\n      });\n    }\n\n    disassociateInstanceGroup(resourceId, instanceGroupId) {\n      return this.http.post(`${this.baseUrl}${resourceId}/instance_groups/`, {\n        id: instanceGroupId,\n        disassociate: true,\n      });\n    }\n\n    async orderInstanceGroups(resourceId, current, original) {\n      /* eslint-disable no-await-in-loop, no-restricted-syntax */\n      // Resolve Promises sequentially to maintain order and avoid race condition\n      if (!isEqual(current, original)) {\n        for (const group of original) {\n          await this.disassociateInstanceGroup(resourceId, group.id);\n        }\n        for (const group of current) {\n          await this.associateInstanceGroup(resourceId, group.id);\n        }\n      }\n    }\n    /* eslint-enable no-await-in-loop, no-restricted-syntax */\n  };\n\nexport default InstanceGroupsMixin;\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}