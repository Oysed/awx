{"ast":null,"code":"import _objectSpread from\"/awx_devel/awx/ui/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import _slicedToArray from\"/awx_devel/awx/ui/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import _asyncToGenerator from\"/awx_devel/awx/ui/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _regeneratorRuntime from\"/awx_devel/awx/ui/node_modules/@babel/runtime/regenerator/index.js\";import{i18n}from\"@lingui/core\";import React,{useEffect,useCallback}from'react';import{useLocation}from'react-router-dom';import{Card}from'@patternfly/react-core';import{ExecutionEnvironmentsAPI}from'api';import{getQSConfig,parseQueryString}from'util/qs';import useRequest from'hooks/useRequest';import DatalistToolbar from'components/DataListToolbar';import PaginatedTable,{HeaderCell,HeaderRow,getSearchableKeys}from'components/PaginatedTable';import ExecutionEnvironmentTemplateListItem from'./ExecutionEnvironmentTemplateListItem';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var QS_CONFIG=getQSConfig('execution_environments',{page:1,page_size:20,order_by:'name',type:'job_template,workflow_job_template'},['id','page','page_size']);function ExecutionEnvironmentTemplateList(_ref){var executionEnvironment=_ref.executionEnvironment;var id=executionEnvironment.id;var location=useLocation();var _useRequest=useRequest(useCallback(/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var _responseActions$data,_responseActions$data2;var params,_yield$Promise$all,_yield$Promise$all2,response,responseActions;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:params=parseQueryString(QS_CONFIG,location.search);_context.next=3;return Promise.all([ExecutionEnvironmentsAPI.readUnifiedJobTemplates(id,params),ExecutionEnvironmentsAPI.readUnifiedJobTemplateOptions(id)]);case 3:_yield$Promise$all=_context.sent;_yield$Promise$all2=_slicedToArray(_yield$Promise$all,2);response=_yield$Promise$all2[0];responseActions=_yield$Promise$all2[1];return _context.abrupt(\"return\",{templates:response.data.results,templatesCount:response.data.count,actions:responseActions.data.actions,relatedSearchableKeys:((responseActions===null||responseActions===void 0?void 0:(_responseActions$data=responseActions.data)===null||_responseActions$data===void 0?void 0:_responseActions$data.related_search_fields)||[]).map(function(val){return val.slice(0,-8);}),searchableKeys:getSearchableKeys((_responseActions$data2=responseActions.data.actions)===null||_responseActions$data2===void 0?void 0:_responseActions$data2.GET)});case 8:case\"end\":return _context.stop();}}},_callee);})),[location,id]),{templates:[],templatesCount:0,actions:{},relatedSearchableKeys:[],searchableKeys:[]}),contentError=_useRequest.error,isLoading=_useRequest.isLoading,fetchTemplates=_useRequest.request,_useRequest$result=_useRequest.result,templates=_useRequest$result.templates,templatesCount=_useRequest$result.templatesCount,relatedSearchableKeys=_useRequest$result.relatedSearchableKeys,searchableKeys=_useRequest$result.searchableKeys;useEffect(function(){fetchTemplates();},[fetchTemplates]);return/*#__PURE__*/_jsx(Card,{children:/*#__PURE__*/_jsx(PaginatedTable,{contentError:contentError,hasContentLoading:isLoading,items:templates,itemCount:templatesCount,pluralizedItemName:/*i18n*/i18n._(\"Templates\"),qsConfig:QS_CONFIG,toolbarSearchableKeys:searchableKeys,toolbarRelatedSearchableKeys:relatedSearchableKeys,toolbarSearchColumns:[{name:/*i18n*/i18n._(\"Name\"),key:'name__icontains',isDefault:true},{name:/*i18n*/i18n._(\"Type\"),key:'or__type',options:[[\"job_template\",/*i18n*/i18n._(\"Job Template\")],[\"workflow_job_template\",/*i18n*/i18n._(\"Workflow Template\")]]},{name:/*i18n*/i18n._(\"Created By (Username)\"),key:'created_by__username__icontains'},{name:/*i18n*/i18n._(\"Modified By (Username)\"),key:'modified_by__username__icontains'}],renderToolbar:function renderToolbar(props){return/*#__PURE__*/_jsx(DatalistToolbar,_objectSpread(_objectSpread({},props),{},{qsConfig:QS_CONFIG}));},headerRow:/*#__PURE__*/_jsxs(HeaderRow,{qsConfig:QS_CONFIG,isSelectable:false,children:[/*#__PURE__*/_jsx(HeaderCell,{sortKey:\"name\",children:/*i18n*/i18n._(\"Name\")}),/*#__PURE__*/_jsx(HeaderCell,{children:/*i18n*/i18n._(\"Type\")})]}),renderRow:function renderRow(template){return/*#__PURE__*/_jsx(ExecutionEnvironmentTemplateListItem,{template:template,detailUrl:\"/templates/\".concat(template.type,\"/\").concat(template.id,\"/details\")},template.id);}})});}export default ExecutionEnvironmentTemplateList;","map":{"version":3,"names":["React","useEffect","useCallback","useLocation","Card","ExecutionEnvironmentsAPI","getQSConfig","parseQueryString","useRequest","DatalistToolbar","PaginatedTable","HeaderCell","HeaderRow","getSearchableKeys","ExecutionEnvironmentTemplateListItem","jsx","_jsx","jsxs","_jsxs","QS_CONFIG","page","page_size","order_by","type","ExecutionEnvironmentTemplateList","_ref","executionEnvironment","id","location","_useRequest","_asyncToGenerator","_regeneratorRuntime","mark","_callee","_responseActions$data","_responseActions$data2","params","_yield$Promise$all","_yield$Promise$all2","response","responseActions","wrap","_callee$","_context","prev","next","search","Promise","all","readUnifiedJobTemplates","readUnifiedJobTemplateOptions","sent","_slicedToArray","abrupt","templates","data","results","templatesCount","count","actions","relatedSearchableKeys","related_search_fields","map","val","slice","searchableKeys","GET","stop","contentError","error","isLoading","fetchTemplates","request","_useRequest$result","result","children","hasContentLoading","items","itemCount","pluralizedItemName","i18n","_","qsConfig","toolbarSearchableKeys","toolbarRelatedSearchableKeys","toolbarSearchColumns","name","key","isDefault","options","renderToolbar","props","_objectSpread","headerRow","isSelectable","sortKey","renderRow","template","detailUrl","concat"],"sources":["/awx_devel/awx/ui/src/screens/ExecutionEnvironment/ExecutionEnvironmentTemplate/ExecutionEnvironmentTemplateList.js"],"sourcesContent":["import React, { useEffect, useCallback } from 'react';\nimport { useLocation } from 'react-router-dom';\n\nimport { t } from '@lingui/macro';\nimport { Card } from '@patternfly/react-core';\n\nimport { ExecutionEnvironmentsAPI } from 'api';\nimport { getQSConfig, parseQueryString } from 'util/qs';\nimport useRequest from 'hooks/useRequest';\nimport DatalistToolbar from 'components/DataListToolbar';\nimport PaginatedTable, {\n  HeaderCell,\n  HeaderRow,\n  getSearchableKeys,\n} from 'components/PaginatedTable';\n\nimport ExecutionEnvironmentTemplateListItem from './ExecutionEnvironmentTemplateListItem';\n\nconst QS_CONFIG = getQSConfig(\n  'execution_environments',\n  {\n    page: 1,\n    page_size: 20,\n    order_by: 'name',\n    type: 'job_template,workflow_job_template',\n  },\n  ['id', 'page', 'page_size']\n);\n\nfunction ExecutionEnvironmentTemplateList({ executionEnvironment }) {\n  const { id } = executionEnvironment;\n  const location = useLocation();\n\n  const {\n    error: contentError,\n    isLoading,\n    request: fetchTemplates,\n    result: {\n      templates,\n      templatesCount,\n      relatedSearchableKeys,\n      searchableKeys,\n    },\n  } = useRequest(\n    useCallback(async () => {\n      const params = parseQueryString(QS_CONFIG, location.search);\n\n      const [response, responseActions] = await Promise.all([\n        ExecutionEnvironmentsAPI.readUnifiedJobTemplates(id, params),\n        ExecutionEnvironmentsAPI.readUnifiedJobTemplateOptions(id),\n      ]);\n\n      return {\n        templates: response.data.results,\n        templatesCount: response.data.count,\n        actions: responseActions.data.actions,\n        relatedSearchableKeys: (\n          responseActions?.data?.related_search_fields || []\n        ).map((val) => val.slice(0, -8)),\n        searchableKeys: getSearchableKeys(responseActions.data.actions?.GET),\n      };\n    }, [location, id]),\n    {\n      templates: [],\n      templatesCount: 0,\n      actions: {},\n      relatedSearchableKeys: [],\n      searchableKeys: [],\n    }\n  );\n\n  useEffect(() => {\n    fetchTemplates();\n  }, [fetchTemplates]);\n\n  return (\n    <Card>\n      <PaginatedTable\n        contentError={contentError}\n        hasContentLoading={isLoading}\n        items={templates}\n        itemCount={templatesCount}\n        pluralizedItemName={t`Templates`}\n        qsConfig={QS_CONFIG}\n        toolbarSearchableKeys={searchableKeys}\n        toolbarRelatedSearchableKeys={relatedSearchableKeys}\n        toolbarSearchColumns={[\n          {\n            name: t`Name`,\n            key: 'name__icontains',\n            isDefault: true,\n          },\n          {\n            name: t`Type`,\n            key: 'or__type',\n            options: [\n              [`job_template`, t`Job Template`],\n              [`workflow_job_template`, t`Workflow Template`],\n            ],\n          },\n          {\n            name: t`Created By (Username)`,\n            key: 'created_by__username__icontains',\n          },\n          {\n            name: t`Modified By (Username)`,\n            key: 'modified_by__username__icontains',\n          },\n        ]}\n        renderToolbar={(props) => (\n          <DatalistToolbar {...props} qsConfig={QS_CONFIG} />\n        )}\n        headerRow={\n          <HeaderRow qsConfig={QS_CONFIG} isSelectable={false}>\n            <HeaderCell sortKey=\"name\">{t`Name`}</HeaderCell>\n            <HeaderCell>{t`Type`}</HeaderCell>\n          </HeaderRow>\n        }\n        renderRow={(template) => (\n          <ExecutionEnvironmentTemplateListItem\n            key={template.id}\n            template={template}\n            detailUrl={`/templates/${template.type}/${template.id}/details`}\n          />\n        )}\n      />\n    </Card>\n  );\n}\n\nexport default ExecutionEnvironmentTemplateList;\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}