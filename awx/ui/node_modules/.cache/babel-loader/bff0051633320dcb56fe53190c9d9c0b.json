{"ast":null,"code":"import _asyncToGenerator from\"/awx_devel/awx/ui/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _regeneratorRuntime from\"/awx_devel/awx/ui/node_modules/@babel/runtime/regenerator/index.js\";import{i18n}from\"@lingui/core\";import React,{useCallback}from'react';import{Button,Tooltip}from'@patternfly/react-core';import{SyncIcon}from'@patternfly/react-icons';import useRequest,{useDismissableError}from'hooks/useRequest';import AlertModal from'components/AlertModal/AlertModal';import ErrorDetail from'components/ErrorDetail/ErrorDetail';import{InventorySourcesAPI}from'api';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";function InventorySourceSyncButton(_ref){var source=_ref.source,icon=_ref.icon;var _useRequest=useRequest(useCallback(/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var _yield$InventorySourc,status;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return InventorySourcesAPI.createSyncStart(source.id);case 2:_yield$InventorySourc=_context.sent;status=_yield$InventorySourc.data.status;return _context.abrupt(\"return\",status);case 5:case\"end\":return _context.stop();}}},_callee);})),[source.id]),{}),startSyncLoading=_useRequest.isLoading,startSyncError=_useRequest.error,startSyncProcess=_useRequest.request;var _useDismissableError=useDismissableError(startSyncError),startError=_useDismissableError.error,dismissStartError=_useDismissableError.dismissError;return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(Tooltip,{content:/*i18n*/i18n._(\"Start sync process\"),position:\"top\",children:/*#__PURE__*/_jsx(Button,{ouiaId:\"\".concat(source,\"-sync-button\"),isDisabled:startSyncLoading,\"aria-label\":/*i18n*/i18n._(\"Start sync source\"),variant:icon?'plain':'secondary',onClick:startSyncProcess,children:icon?/*#__PURE__*/_jsx(SyncIcon,{}):/*i18n*/i18n._(\"Sync\")})}),startError&&/*#__PURE__*/_jsxs(AlertModal,{isOpen:startError,variant:\"error\",title:/*i18n*/i18n._(\"Error!\"),onClose:dismissStartError,children:[/*i18n*/i18n._(\"Failed to sync inventory source.\"),/*#__PURE__*/_jsx(ErrorDetail,{error:startError})]})]});}InventorySourceSyncButton.defaultProps={source:{},icon:true};export default InventorySourceSyncButton;","map":{"version":3,"names":["React","useCallback","Button","Tooltip","SyncIcon","useRequest","useDismissableError","AlertModal","ErrorDetail","InventorySourcesAPI","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","InventorySourceSyncButton","_ref","source","icon","_useRequest","_asyncToGenerator","_regeneratorRuntime","mark","_callee","_yield$InventorySourc","status","wrap","_callee$","_context","prev","next","createSyncStart","id","sent","data","abrupt","stop","startSyncLoading","isLoading","startSyncError","error","startSyncProcess","request","_useDismissableError","startError","dismissStartError","dismissError","children","content","i18n","_","position","ouiaId","concat","isDisabled","variant","onClick","isOpen","title","onClose","defaultProps"],"sources":["/awx_devel/awx/ui/src/screens/Inventory/shared/InventorySourceSyncButton.js"],"sourcesContent":["import React, { useCallback } from 'react';\n\nimport { t } from '@lingui/macro';\nimport PropTypes from 'prop-types';\nimport { Button, Tooltip } from '@patternfly/react-core';\nimport { SyncIcon } from '@patternfly/react-icons';\nimport useRequest, { useDismissableError } from 'hooks/useRequest';\nimport AlertModal from 'components/AlertModal/AlertModal';\nimport ErrorDetail from 'components/ErrorDetail/ErrorDetail';\nimport { InventorySourcesAPI } from 'api';\n\nfunction InventorySourceSyncButton({ source, icon }) {\n  const {\n    isLoading: startSyncLoading,\n    error: startSyncError,\n    request: startSyncProcess,\n  } = useRequest(\n    useCallback(async () => {\n      const {\n        data: { status },\n      } = await InventorySourcesAPI.createSyncStart(source.id);\n\n      return status;\n    }, [source.id]),\n    {}\n  );\n\n  const { error: startError, dismissError: dismissStartError } =\n    useDismissableError(startSyncError);\n\n  return (\n    <>\n      <Tooltip content={t`Start sync process`} position=\"top\">\n        <Button\n          ouiaId={`${source}-sync-button`}\n          isDisabled={startSyncLoading}\n          aria-label={t`Start sync source`}\n          variant={icon ? 'plain' : 'secondary'}\n          onClick={startSyncProcess}\n        >\n          {icon ? <SyncIcon /> : t`Sync`}\n        </Button>\n      </Tooltip>\n\n      {startError && (\n        <AlertModal\n          isOpen={startError}\n          variant=\"error\"\n          title={t`Error!`}\n          onClose={dismissStartError}\n        >\n          {t`Failed to sync inventory source.`}\n          <ErrorDetail error={startError} />\n        </AlertModal>\n      )}\n    </>\n  );\n}\n\nInventorySourceSyncButton.defaultProps = {\n  source: {},\n  icon: true,\n};\n\nInventorySourceSyncButton.propTypes = {\n  source: PropTypes.shape({}),\n  icon: PropTypes.bool,\n};\n\nexport default InventorySourceSyncButton;\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}