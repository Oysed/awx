{"ast":null,"code":"import _objectSpread from\"/awx_devel/awx/ui/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import _asyncToGenerator from\"/awx_devel/awx/ui/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _regeneratorRuntime from\"/awx_devel/awx/ui/node_modules/@babel/runtime/regenerator/index.js\";import React,{useCallback}from'react';import{useHistory,useParams}from'react-router-dom';import{CardBody}from'components/Card';import{TokensAPI,UsersAPI}from'api';import useRequest from'hooks/useRequest';import UserTokenForm from'../shared/UserTokenForm';import{jsx as _jsx}from\"react/jsx-runtime\";function UserTokenAdd(_ref){var onSuccessfulAdd=_ref.onSuccessfulAdd;var history=useHistory();var _useParams=useParams(),userId=_useParams.id;var _useRequest=useRequest(useCallback(/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(formData){var response,_formData$application;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:if(!formData.application){_context.next=6;break;}_context.next=3;return UsersAPI.createToken(userId,_objectSpread(_objectSpread({},formData),{},{application:((_formData$application=formData.application)===null||_formData$application===void 0?void 0:_formData$application.id)||null}));case 3:response=_context.sent;_context.next=9;break;case 6:_context.next=8;return TokensAPI.create(formData);case 8:response=_context.sent;case 9:onSuccessfulAdd(response.data);history.push(\"/users/\".concat(userId,\"/tokens/\").concat(response.data.id,\"/details\"));case 11:case\"end\":return _context.stop();}}},_callee);}));return function(_x){return _ref2.apply(this,arguments);};}(),[history,userId,onSuccessfulAdd])),submitError=_useRequest.error,handleSubmit=_useRequest.request;var handleCancel=function handleCancel(){history.push(\"/users/\".concat(userId,\"/tokens\"));};return/*#__PURE__*/_jsx(CardBody,{children:/*#__PURE__*/_jsx(UserTokenForm,{handleCancel:handleCancel,handleSubmit:handleSubmit,submitError:submitError})});}export default UserTokenAdd;","map":{"version":3,"names":["React","useCallback","useHistory","useParams","CardBody","TokensAPI","UsersAPI","useRequest","UserTokenForm","jsx","_jsx","UserTokenAdd","_ref","onSuccessfulAdd","history","_useParams","userId","id","_useRequest","_ref2","_asyncToGenerator","_regeneratorRuntime","mark","_callee","formData","response","_formData$application","wrap","_callee$","_context","prev","next","application","createToken","_objectSpread","sent","create","data","push","concat","stop","_x","apply","arguments","submitError","error","handleSubmit","request","handleCancel","children"],"sources":["/awx_devel/awx/ui/src/screens/User/UserTokenAdd/UserTokenAdd.js"],"sourcesContent":["import React, { useCallback } from 'react';\nimport { useHistory, useParams } from 'react-router-dom';\n\nimport { CardBody } from 'components/Card';\nimport { TokensAPI, UsersAPI } from 'api';\nimport useRequest from 'hooks/useRequest';\nimport UserTokenForm from '../shared/UserTokenForm';\n\nfunction UserTokenAdd({ onSuccessfulAdd }) {\n  const history = useHistory();\n  const { id: userId } = useParams();\n  const { error: submitError, request: handleSubmit } = useRequest(\n    useCallback(\n      async (formData) => {\n        let response;\n        if (formData.application) {\n          response = await UsersAPI.createToken(userId, {\n            ...formData,\n            application: formData.application?.id || null,\n          });\n        } else {\n          response = await TokensAPI.create(formData);\n        }\n\n        onSuccessfulAdd(response.data);\n\n        history.push(`/users/${userId}/tokens/${response.data.id}/details`);\n      },\n      [history, userId, onSuccessfulAdd]\n    )\n  );\n\n  const handleCancel = () => {\n    history.push(`/users/${userId}/tokens`);\n  };\n\n  return (\n    <CardBody>\n      <UserTokenForm\n        handleCancel={handleCancel}\n        handleSubmit={handleSubmit}\n        submitError={submitError}\n      />\n    </CardBody>\n  );\n}\nexport default UserTokenAdd;\n"],"mappings":"uTAAA,MAAO,CAAAA,KAAK,EAAIC,WAAW,KAAQ,OAAO,CAC1C,OAASC,UAAU,CAAEC,SAAS,KAAQ,kBAAkB,CAExD,OAASC,QAAQ,KAAQ,iBAAiB,CAC1C,OAASC,SAAS,CAAEC,QAAQ,KAAQ,KAAK,CACzC,MAAO,CAAAC,UAAU,KAAM,kBAAkB,CACzC,MAAO,CAAAC,aAAa,KAAM,yBAAyB,CAAC,OAAAC,GAAA,IAAAC,IAAA,yBAEpD,QAAS,CAAAC,YAAYA,CAAAC,IAAA,CAAsB,IAAnB,CAAAC,eAAe,CAAAD,IAAA,CAAfC,eAAe,CACrC,GAAM,CAAAC,OAAO,CAAGZ,UAAU,CAAC,CAAC,CAC5B,IAAAa,UAAA,CAAuBZ,SAAS,CAAC,CAAC,CAAtBa,MAAM,CAAAD,UAAA,CAAVE,EAAE,CACV,IAAAC,WAAA,CAAsDX,UAAU,CAC9DN,WAAW,6BAAAkB,KAAA,CAAAC,iBAAA,cAAAC,mBAAA,CAAAC,IAAA,CACT,SAAAC,QAAOC,QAAQ,MAAAC,QAAA,CAAAC,qBAAA,QAAAL,mBAAA,CAAAM,IAAA,UAAAC,SAAAC,QAAA,kBAAAA,QAAA,CAAAC,IAAA,CAAAD,QAAA,CAAAE,IAAA,aAETP,QAAQ,CAACQ,WAAW,EAAAH,QAAA,CAAAE,IAAA,UAAAF,QAAA,CAAAE,IAAA,SACL,CAAAzB,QAAQ,CAAC2B,WAAW,CAACjB,MAAM,CAAAkB,aAAA,CAAAA,aAAA,IACvCV,QAAQ,MACXQ,WAAW,CAAE,EAAAN,qBAAA,CAAAF,QAAQ,CAACQ,WAAW,UAAAN,qBAAA,iBAApBA,qBAAA,CAAsBT,EAAE,GAAI,IAAI,EAC9C,CAAC,QAHFQ,QAAQ,CAAAI,QAAA,CAAAM,IAAA,CAAAN,QAAA,CAAAE,IAAA,gBAAAF,QAAA,CAAAE,IAAA,SAKS,CAAA1B,SAAS,CAAC+B,MAAM,CAACZ,QAAQ,CAAC,QAA3CC,QAAQ,CAAAI,QAAA,CAAAM,IAAA,QAGVtB,eAAe,CAACY,QAAQ,CAACY,IAAI,CAAC,CAE9BvB,OAAO,CAACwB,IAAI,WAAAC,MAAA,CAAWvB,MAAM,aAAAuB,MAAA,CAAWd,QAAQ,CAACY,IAAI,CAACpB,EAAE,YAAU,CAAC,CAAC,yBAAAY,QAAA,CAAAW,IAAA,OAAAjB,OAAA,GACrE,mBAAAkB,EAAA,SAAAtB,KAAA,CAAAuB,KAAA,MAAAC,SAAA,QACD,CAAC7B,OAAO,CAAEE,MAAM,CAAEH,eAAe,CACnC,CACF,CAAC,CAnBc+B,WAAW,CAAA1B,WAAA,CAAlB2B,KAAK,CAAwBC,YAAY,CAAA5B,WAAA,CAArB6B,OAAO,CAqBnC,GAAM,CAAAC,YAAY,CAAG,QAAf,CAAAA,YAAYA,CAAA,CAAS,CACzBlC,OAAO,CAACwB,IAAI,WAAAC,MAAA,CAAWvB,MAAM,WAAS,CAAC,CACzC,CAAC,CAED,mBACEN,IAAA,CAACN,QAAQ,EAAA6C,QAAA,cACPvC,IAAA,CAACF,aAAa,EACZwC,YAAY,CAAEA,YAAa,CAC3BF,YAAY,CAAEA,YAAa,CAC3BF,WAAW,CAAEA,WAAY,CAC1B,CAAC,CACM,CAAC,CAEf,CACA,cAAe,CAAAjC,YAAY"},"metadata":{},"sourceType":"module"}