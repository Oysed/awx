{"ast":null,"code":"import _asyncToGenerator from\"/awx_devel/awx/ui/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"/awx_devel/awx/ui/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import _regeneratorRuntime from\"/awx_devel/awx/ui/node_modules/@babel/runtime/regenerator/index.js\";import{i18n}from\"@lingui/core\";import React,{useState,useCallback}from'react';import{Link}from'react-router-dom';import{Button}from'@patternfly/react-core';import{Tr,Td}from'@patternfly/react-table';import{PencilAltIcon}from'@patternfly/react-icons';import{ActionsTd,ActionItem,TdBreakWord}from'components/PaginatedTable';import{timeOfDay}from'util/dates';import{Credential}from'types';import{CredentialsAPI}from'api';import CopyButton from'components/CopyButton';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";function CredentialListItem(_ref){var credential=_ref.credential,detailUrl=_ref.detailUrl,isSelected=_ref.isSelected,onSelect=_ref.onSelect,onCopy=_ref.onCopy,fetchCredentials=_ref.fetchCredentials,rowIndex=_ref.rowIndex;var _useState=useState(false),_useState2=_slicedToArray(_useState,2),isDisabled=_useState2[0],setIsDisabled=_useState2[1];var labelId=\"check-action-\".concat(credential.id);var canEdit=credential.summary_fields.user_capabilities.edit;var copyCredential=useCallback(/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var response;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return CredentialsAPI.copy(credential.id,{name:\"\".concat(credential.name,\" @ \").concat(timeOfDay())});case 2:response=_context.sent;if(response.status===201){onCopy(response.data.id);}_context.next=6;return fetchCredentials();case 6:case\"end\":return _context.stop();}}},_callee);})),[credential.id,credential.name,fetchCredentials,onCopy]);var handleCopyStart=useCallback(function(){setIsDisabled(true);},[]);var handleCopyFinish=useCallback(function(){setIsDisabled(false);},[]);return/*#__PURE__*/_jsxs(Tr,{id:\"\".concat(credential.id),ouiaId:\"\".concat(credential.id),children:[/*#__PURE__*/_jsx(Td,{select:{rowIndex:rowIndex,isSelected:isSelected,onSelect:onSelect},dataLabel:/*i18n*/i18n._(\"Selected\")}),/*#__PURE__*/_jsx(TdBreakWord,{id:labelId,dataLabel:/*i18n*/i18n._(\"Name\"),children:/*#__PURE__*/_jsx(Link,{to:\"\".concat(detailUrl),children:/*#__PURE__*/_jsx(\"b\",{children:credential.name})})}),/*#__PURE__*/_jsx(Td,{dataLabel:/*i18n*/i18n._(\"Type\"),children:credential.summary_fields.credential_type.name}),/*#__PURE__*/_jsxs(ActionsTd,{dataLabel:/*i18n*/i18n._(\"Actions\"),children:[/*#__PURE__*/_jsx(ActionItem,{visible:canEdit,tooltip:/*i18n*/i18n._(\"Edit Credential\"),children:/*#__PURE__*/_jsx(Button,{ouiaId:\"\".concat(credential.id,\"-edit-button\"),isDisabled:isDisabled,\"aria-label\":/*i18n*/i18n._(\"Edit Credential\"),variant:\"plain\",component:Link,to:\"/credentials/\".concat(credential.id,\"/edit\"),children:/*#__PURE__*/_jsx(PencilAltIcon,{})})}),/*#__PURE__*/_jsx(ActionItem,{tooltip:/*i18n*/i18n._(\"Copy Credential\"),visible:credential.summary_fields.user_capabilities.copy,children:/*#__PURE__*/_jsx(CopyButton,{isDisabled:isDisabled,onCopyStart:handleCopyStart,onCopyFinish:handleCopyFinish,copyItem:copyCredential,errorMessage:/*i18n*/i18n._(\"Failed to copy credential.\")})})]})]});}export default CredentialListItem;","map":{"version":3,"names":["React","useState","useCallback","Link","Button","Tr","Td","PencilAltIcon","ActionsTd","ActionItem","TdBreakWord","timeOfDay","Credential","CredentialsAPI","CopyButton","jsx","_jsx","jsxs","_jsxs","CredentialListItem","_ref","credential","detailUrl","isSelected","onSelect","onCopy","fetchCredentials","rowIndex","_useState","_useState2","_slicedToArray","isDisabled","setIsDisabled","labelId","concat","id","canEdit","summary_fields","user_capabilities","edit","copyCredential","_asyncToGenerator","_regeneratorRuntime","mark","_callee","response","wrap","_callee$","_context","prev","next","copy","name","sent","status","data","stop","handleCopyStart","handleCopyFinish","ouiaId","children","select","dataLabel","i18n","_","to","credential_type","visible","tooltip","variant","component","onCopyStart","onCopyFinish","copyItem","errorMessage"],"sources":["/awx_devel/awx/ui/src/screens/Credential/CredentialList/CredentialListItem.js"],"sourcesContent":["import React, { useState, useCallback } from 'react';\nimport { string, bool, func } from 'prop-types';\n\nimport { t } from '@lingui/macro';\nimport { Link } from 'react-router-dom';\nimport { Button } from '@patternfly/react-core';\nimport { Tr, Td } from '@patternfly/react-table';\nimport { PencilAltIcon } from '@patternfly/react-icons';\nimport { ActionsTd, ActionItem, TdBreakWord } from 'components/PaginatedTable';\nimport { timeOfDay } from 'util/dates';\n\nimport { Credential } from 'types';\nimport { CredentialsAPI } from 'api';\nimport CopyButton from 'components/CopyButton';\n\nfunction CredentialListItem({\n  credential,\n  detailUrl,\n  isSelected,\n  onSelect,\n  onCopy,\n  fetchCredentials,\n  rowIndex,\n}) {\n  const [isDisabled, setIsDisabled] = useState(false);\n\n  const labelId = `check-action-${credential.id}`;\n  const canEdit = credential.summary_fields.user_capabilities.edit;\n\n  const copyCredential = useCallback(async () => {\n    const response = await CredentialsAPI.copy(credential.id, {\n      name: `${credential.name} @ ${timeOfDay()}`,\n    });\n    if (response.status === 201) {\n      onCopy(response.data.id);\n    }\n    await fetchCredentials();\n  }, [credential.id, credential.name, fetchCredentials, onCopy]);\n\n  const handleCopyStart = useCallback(() => {\n    setIsDisabled(true);\n  }, []);\n\n  const handleCopyFinish = useCallback(() => {\n    setIsDisabled(false);\n  }, []);\n\n  return (\n    <Tr id={`${credential.id}`} ouiaId={`${credential.id}`}>\n      <Td\n        select={{\n          rowIndex,\n          isSelected,\n          onSelect,\n        }}\n        dataLabel={t`Selected`}\n      />\n      <TdBreakWord id={labelId} dataLabel={t`Name`}>\n        <Link to={`${detailUrl}`}>\n          <b>{credential.name}</b>\n        </Link>\n      </TdBreakWord>\n      <Td dataLabel={t`Type`}>\n        {credential.summary_fields.credential_type.name}\n      </Td>\n      <ActionsTd dataLabel={t`Actions`}>\n        <ActionItem visible={canEdit} tooltip={t`Edit Credential`}>\n          <Button\n            ouiaId={`${credential.id}-edit-button`}\n            isDisabled={isDisabled}\n            aria-label={t`Edit Credential`}\n            variant=\"plain\"\n            component={Link}\n            to={`/credentials/${credential.id}/edit`}\n          >\n            <PencilAltIcon />\n          </Button>\n        </ActionItem>\n        <ActionItem\n          tooltip={t`Copy Credential`}\n          visible={credential.summary_fields.user_capabilities.copy}\n        >\n          <CopyButton\n            isDisabled={isDisabled}\n            onCopyStart={handleCopyStart}\n            onCopyFinish={handleCopyFinish}\n            copyItem={copyCredential}\n            errorMessage={t`Failed to copy credential.`}\n          />\n        </ActionItem>\n      </ActionsTd>\n    </Tr>\n  );\n}\n\nCredentialListItem.propTypes = {\n  detailUrl: string.isRequired,\n  credential: Credential.isRequired,\n  isSelected: bool.isRequired,\n  onSelect: func.isRequired,\n};\n\nexport default CredentialListItem;\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}