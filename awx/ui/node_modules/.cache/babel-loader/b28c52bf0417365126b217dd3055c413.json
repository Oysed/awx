{"ast":null,"code":"import _slicedToArray from\"/awx_devel/awx/ui/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import _taggedTemplateLiteral from\"/awx_devel/awx/ui/node_modules/@babel/runtime/helpers/esm/taggedTemplateLiteral.js\";var _templateObject;import{i18n}from\"@lingui/core\";/* eslint-disable react/jsx-no-useless-fragment */import React,{useState}from'react';import{useLocation}from'react-router-dom';import{Button,ButtonVariant,Dropdown,DropdownPosition,DropdownToggle,DropdownItem,InputGroup}from'@patternfly/react-core';import{SortAlphaDownIcon,SortAlphaDownAltIcon,SortNumericDownIcon,SortNumericDownAltIcon}from'@patternfly/react-icons';import styled from'styled-components';import{parseQueryString}from'util/qs';import{SortColumns,QSConfig}from'types';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";var NoOptionDropdown=styled.div(_templateObject||(_templateObject=_taggedTemplateLiteral([\"\\n  align-self: stretch;\\n  border: 1px solid var(--pf-global--BorderColor--300);\\n  padding: 5px 15px;\\n  white-space: nowrap;\\n  border-bottom-color: var(--pf-global--BorderColor--200);\\n\"])));function Sort(_ref){var columns=_ref.columns,qsConfig=_ref.qsConfig,onSort=_ref.onSort;var location=useLocation();var _useState=useState(false),_useState2=_slicedToArray(_useState,2),isSortDropdownOpen=_useState2[0],setIsSortDropdownOpen=_useState2[1];var sortKey;var sortOrder;var isNumeric;var queryParams=parseQueryString(qsConfig,location.search);if(queryParams.order_by&&queryParams.order_by.startsWith('-')){sortKey=queryParams.order_by.substr(1);sortOrder='descending';}else if(queryParams.order_by){sortKey=queryParams.order_by;sortOrder='ascending';}if(qsConfig.integerFields.find(function(field){return field===sortKey;})){isNumeric=true;}else{isNumeric=false;}var handleDropdownToggle=function handleDropdownToggle(isOpen){setIsSortDropdownOpen(isOpen);};var handleDropdownSelect=function handleDropdownSelect(_ref2){var target=_ref2.target;var innerText=target.innerText;var _columns$filter=columns.filter(function(_ref3){var name=_ref3.name;return name===innerText;}),_columns$filter2=_slicedToArray(_columns$filter,1),key=_columns$filter2[0].key;sortKey=key;if(qsConfig.integerFields.find(function(field){return field===key;})){isNumeric=true;}else{isNumeric=false;}setIsSortDropdownOpen(false);onSort(sortKey,sortOrder);};var handleSort=function handleSort(){onSort(sortKey,sortOrder==='ascending'?'descending':'ascending');};var up=DropdownPosition.up;var defaultSortedColumn=columns.find(function(_ref4){var key=_ref4.key;return key===sortKey;});if(!defaultSortedColumn){throw new Error('sortKey must match one of the column keys, check the sortColumns prop passed to <Sort />');}var sortedColumnName=defaultSortedColumn===null||defaultSortedColumn===void 0?void 0:defaultSortedColumn.name;var sortDropdownItems=columns.filter(function(_ref5){var key=_ref5.key;return key!==sortKey;}).map(function(_ref6){var key=_ref6.key,name=_ref6.name;return/*#__PURE__*/_jsx(DropdownItem,{component:\"button\",ouiaId:\"\".concat(name,\"-dropdown-item\"),children:name},key);});var SortIcon;if(isNumeric){SortIcon=sortOrder==='ascending'?SortNumericDownIcon:SortNumericDownAltIcon;}else{SortIcon=sortOrder==='ascending'?SortAlphaDownIcon:SortAlphaDownAltIcon;}return/*#__PURE__*/_jsx(_Fragment,{children:sortedColumnName&&/*#__PURE__*/_jsxs(InputGroup,{children:[sortDropdownItems.length>0&&/*#__PURE__*/_jsx(Dropdown,{onToggle:handleDropdownToggle,onSelect:handleDropdownSelect,direction:up,isOpen:isSortDropdownOpen,ouiaId:\"sort-dropdown\",toggle:/*#__PURE__*/_jsx(DropdownToggle,{id:\"awx-sort\",onToggle:handleDropdownToggle,ouiaId:\"sort-dropdown-toggle\",children:sortedColumnName}),dropdownItems:sortDropdownItems})||/*#__PURE__*/_jsx(NoOptionDropdown,{children:sortedColumnName}),/*#__PURE__*/_jsx(Button,{variant:ButtonVariant.control,\"aria-label\":/*i18n*/i18n._(\"Sort\"),onClick:handleSort,ouiaId:\"sort-button\",children:/*#__PURE__*/_jsx(SortIcon,{})})]})});}Sort.defaultProps={onSort:null};export default Sort;","map":{"version":3,"names":["React","useState","useLocation","Button","ButtonVariant","Dropdown","DropdownPosition","DropdownToggle","DropdownItem","InputGroup","SortAlphaDownIcon","SortAlphaDownAltIcon","SortNumericDownIcon","SortNumericDownAltIcon","styled","parseQueryString","SortColumns","QSConfig","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","NoOptionDropdown","div","_templateObject","_taggedTemplateLiteral","Sort","_ref","columns","qsConfig","onSort","location","_useState","_useState2","_slicedToArray","isSortDropdownOpen","setIsSortDropdownOpen","sortKey","sortOrder","isNumeric","queryParams","search","order_by","startsWith","substr","integerFields","find","field","handleDropdownToggle","isOpen","handleDropdownSelect","_ref2","target","innerText","_columns$filter","filter","_ref3","name","_columns$filter2","key","handleSort","up","defaultSortedColumn","_ref4","Error","sortedColumnName","sortDropdownItems","_ref5","map","_ref6","component","ouiaId","concat","children","SortIcon","length","onToggle","onSelect","direction","toggle","id","dropdownItems","variant","control","i18n","_","onClick","defaultProps"],"sources":["/awx_devel/awx/ui/src/components/Sort/Sort.js"],"sourcesContent":["/* eslint-disable react/jsx-no-useless-fragment */\nimport React, { useState } from 'react';\nimport PropTypes from 'prop-types';\n\nimport { useLocation } from 'react-router-dom';\nimport { t } from '@lingui/macro';\nimport {\n  Button,\n  ButtonVariant,\n  Dropdown,\n  DropdownPosition,\n  DropdownToggle,\n  DropdownItem,\n  InputGroup,\n} from '@patternfly/react-core';\nimport {\n  SortAlphaDownIcon,\n  SortAlphaDownAltIcon,\n  SortNumericDownIcon,\n  SortNumericDownAltIcon,\n} from '@patternfly/react-icons';\n\nimport styled from 'styled-components';\nimport { parseQueryString } from 'util/qs';\nimport { SortColumns, QSConfig } from 'types';\n\nconst NoOptionDropdown = styled.div`\n  align-self: stretch;\n  border: 1px solid var(--pf-global--BorderColor--300);\n  padding: 5px 15px;\n  white-space: nowrap;\n  border-bottom-color: var(--pf-global--BorderColor--200);\n`;\n\nfunction Sort({ columns, qsConfig, onSort }) {\n  const location = useLocation();\n  const [isSortDropdownOpen, setIsSortDropdownOpen] = useState(false);\n\n  let sortKey;\n  let sortOrder;\n  let isNumeric;\n\n  const queryParams = parseQueryString(qsConfig, location.search);\n  if (queryParams.order_by && queryParams.order_by.startsWith('-')) {\n    sortKey = queryParams.order_by.substr(1);\n    sortOrder = 'descending';\n  } else if (queryParams.order_by) {\n    sortKey = queryParams.order_by;\n    sortOrder = 'ascending';\n  }\n\n  if (qsConfig.integerFields.find((field) => field === sortKey)) {\n    isNumeric = true;\n  } else {\n    isNumeric = false;\n  }\n\n  const handleDropdownToggle = (isOpen) => {\n    setIsSortDropdownOpen(isOpen);\n  };\n\n  const handleDropdownSelect = ({ target }) => {\n    const { innerText } = target;\n\n    const [{ key }] = columns.filter(({ name }) => name === innerText);\n    sortKey = key;\n    if (qsConfig.integerFields.find((field) => field === key)) {\n      isNumeric = true;\n    } else {\n      isNumeric = false;\n    }\n\n    setIsSortDropdownOpen(false);\n    onSort(sortKey, sortOrder);\n  };\n\n  const handleSort = () => {\n    onSort(sortKey, sortOrder === 'ascending' ? 'descending' : 'ascending');\n  };\n\n  const { up } = DropdownPosition;\n\n  const defaultSortedColumn = columns.find(({ key }) => key === sortKey);\n\n  if (!defaultSortedColumn) {\n    throw new Error(\n      'sortKey must match one of the column keys, check the sortColumns prop passed to <Sort />'\n    );\n  }\n\n  const sortedColumnName = defaultSortedColumn?.name;\n\n  const sortDropdownItems = columns\n    .filter(({ key }) => key !== sortKey)\n    .map(({ key, name }) => (\n      <DropdownItem\n        key={key}\n        component=\"button\"\n        ouiaId={`${name}-dropdown-item`}\n      >\n        {name}\n      </DropdownItem>\n    ));\n\n  let SortIcon;\n  if (isNumeric) {\n    SortIcon =\n      sortOrder === 'ascending' ? SortNumericDownIcon : SortNumericDownAltIcon;\n  } else {\n    SortIcon =\n      sortOrder === 'ascending' ? SortAlphaDownIcon : SortAlphaDownAltIcon;\n  }\n  return (\n    <>\n      {sortedColumnName && (\n        <InputGroup>\n          {(sortDropdownItems.length > 0 && (\n            <Dropdown\n              onToggle={handleDropdownToggle}\n              onSelect={handleDropdownSelect}\n              direction={up}\n              isOpen={isSortDropdownOpen}\n              ouiaId=\"sort-dropdown\"\n              toggle={\n                <DropdownToggle\n                  id=\"awx-sort\"\n                  onToggle={handleDropdownToggle}\n                  ouiaId=\"sort-dropdown-toggle\"\n                >\n                  {sortedColumnName}\n                </DropdownToggle>\n              }\n              dropdownItems={sortDropdownItems}\n            />\n          )) || <NoOptionDropdown>{sortedColumnName}</NoOptionDropdown>}\n\n          <Button\n            variant={ButtonVariant.control}\n            aria-label={t`Sort`}\n            onClick={handleSort}\n            ouiaId=\"sort-button\"\n          >\n            <SortIcon />\n          </Button>\n        </InputGroup>\n      )}\n    </>\n  );\n}\n\nSort.propTypes = {\n  qsConfig: QSConfig.isRequired,\n  columns: SortColumns.isRequired,\n  onSort: PropTypes.func,\n};\n\nSort.defaultProps = {\n  onSort: null,\n};\n\nexport default Sort;\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}