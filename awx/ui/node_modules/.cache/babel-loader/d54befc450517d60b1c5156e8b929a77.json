{"ast":null,"code":"import _slicedToArray from\"/awx_devel/awx/ui/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import{i18n}from\"@lingui/core\";import React,{useCallback}from'react';import{Formik,useField,useFormikContext}from'formik';import{Form,FormGroup,Tooltip}from'@patternfly/react-core';import{required}from'util/validators';import FormField,{FormSubmitError}from'../FormField';import FormActionGroup from'../FormActionGroup/FormActionGroup';import{VariablesField}from'../CodeEditor';import{InventoryLookup}from'../Lookup';import{FormColumnLayout,FormFullWidthLayout}from'../FormLayout';import Popover from'../Popover';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var InventoryLookupField=function InventoryLookupField(_ref){var _inventoryField$value;var isDisabled=_ref.isDisabled;var _useFormikContext=useFormikContext(),setFieldValue=_useFormikContext.setFieldValue,setFieldTouched=_useFormikContext.setFieldTouched;var _useField=useField('inventory'),_useField2=_slicedToArray(_useField,3),inventoryField=_useField2[0],inventoryMeta=_useField2[1],inventoryHelpers=_useField2[2];var handleInventoryUpdate=useCallback(function(value){setFieldValue('inventory',value);setFieldTouched('inventory',true,false);},[setFieldValue,setFieldTouched]);var renderInventoryLookup=/*#__PURE__*/_jsx(InventoryLookup,{fieldId:\"inventory-lookup\",value:inventoryField.value,onBlur:function onBlur(){return inventoryHelpers.setTouched();},tooltip:/*i18n*/i18n._(\"Select the inventory that this host will belong to.\"),isValid:!inventoryMeta.touched||!inventoryMeta.error,helperTextInvalid:inventoryMeta.error,onChange:handleInventoryUpdate,required:true,touched:inventoryMeta.touched,error:inventoryMeta.error,validate:required(/*i18n*/i18n._(\"Select a value for this field\")),isDisabled:isDisabled,hideAdvancedInventories:true,autoPopulate:!((_inventoryField$value=inventoryField.value)!==null&&_inventoryField$value!==void 0&&_inventoryField$value.id)});return/*#__PURE__*/_jsx(FormGroup,{label:/*i18n*/i18n._(\"Inventory\"),labelIcon:/*#__PURE__*/_jsx(Popover,{content:/*i18n*/i18n._(\"Select the inventory that this host will belong to.\")}),isRequired:true,fieldId:\"inventory-lookup\",validated:!inventoryMeta.touched||!inventoryMeta.error?'default':'error',helperTextInvalid:inventoryMeta.error,children:isDisabled?/*#__PURE__*/_jsx(Tooltip,{content:/*i18n*/i18n._(\"Unable to change inventory on a host\"),children:renderInventoryLookup}):renderInventoryLookup});};var HostForm=function HostForm(_ref2){var _host$summary_fields;var handleCancel=_ref2.handleCancel,handleSubmit=_ref2.handleSubmit,host=_ref2.host,isInventoryVisible=_ref2.isInventoryVisible,submitError=_ref2.submitError,disableInventoryLookup=_ref2.disableInventoryLookup;return/*#__PURE__*/_jsx(Formik,{initialValues:{name:host.name,description:host.description,inventory:((_host$summary_fields=host.summary_fields)===null||_host$summary_fields===void 0?void 0:_host$summary_fields.inventory)||null,variables:host.variables},onSubmit:handleSubmit,children:function children(formik){return/*#__PURE__*/_jsx(Form,{autoComplete:\"off\",onSubmit:formik.handleSubmit,children:/*#__PURE__*/_jsxs(FormColumnLayout,{children:[/*#__PURE__*/_jsx(FormField,{id:\"host-name\",name:\"name\",type:\"text\",label:/*i18n*/i18n._(\"Name\"),validate:required(null),isRequired:true}),/*#__PURE__*/_jsx(FormField,{id:\"host-description\",name:\"description\",type:\"text\",label:/*i18n*/i18n._(\"Description\")}),isInventoryVisible&&/*#__PURE__*/_jsx(InventoryLookupField,{isDisabled:disableInventoryLookup}),/*#__PURE__*/_jsx(FormFullWidthLayout,{children:/*#__PURE__*/_jsx(VariablesField,{id:\"host-variables\",name:\"variables\",label:/*i18n*/i18n._(\"Variables\")})}),submitError&&/*#__PURE__*/_jsx(FormSubmitError,{error:submitError}),/*#__PURE__*/_jsx(FormActionGroup,{onCancel:handleCancel,onSubmit:formik.handleSubmit})]})});}});};HostForm.defaultProps={host:{name:'',description:'',inventory:undefined,variables:'---\\n',summary_fields:{inventory:null}},isInventoryVisible:true,submitError:null,disableInventoryLookup:false};export{HostForm as _HostForm};export default HostForm;","map":{"version":3,"names":["React","useCallback","Formik","useField","useFormikContext","Form","FormGroup","Tooltip","required","FormField","FormSubmitError","FormActionGroup","VariablesField","InventoryLookup","FormColumnLayout","FormFullWidthLayout","Popover","jsx","_jsx","jsxs","_jsxs","InventoryLookupField","_ref","_inventoryField$value","isDisabled","_useFormikContext","setFieldValue","setFieldTouched","_useField","_useField2","_slicedToArray","inventoryField","inventoryMeta","inventoryHelpers","handleInventoryUpdate","value","renderInventoryLookup","fieldId","onBlur","setTouched","tooltip","i18n","_","isValid","touched","error","helperTextInvalid","onChange","validate","hideAdvancedInventories","autoPopulate","id","label","labelIcon","content","isRequired","validated","children","HostForm","_ref2","_host$summary_fields","handleCancel","handleSubmit","host","isInventoryVisible","submitError","disableInventoryLookup","initialValues","name","description","inventory","summary_fields","variables","onSubmit","formik","autoComplete","type","onCancel","defaultProps","undefined","_HostForm"],"sources":["/awx_devel/awx/ui/src/components/HostForm/HostForm.js"],"sourcesContent":["import React, { useCallback } from 'react';\nimport { bool, func, shape } from 'prop-types';\nimport { Formik, useField, useFormikContext } from 'formik';\nimport { t } from '@lingui/macro';\nimport { Form, FormGroup, Tooltip } from '@patternfly/react-core';\nimport { required } from 'util/validators';\nimport FormField, { FormSubmitError } from '../FormField';\nimport FormActionGroup from '../FormActionGroup/FormActionGroup';\nimport { VariablesField } from '../CodeEditor';\nimport { InventoryLookup } from '../Lookup';\nimport { FormColumnLayout, FormFullWidthLayout } from '../FormLayout';\nimport Popover from '../Popover';\n\nconst InventoryLookupField = ({ isDisabled }) => {\n  const { setFieldValue, setFieldTouched } = useFormikContext();\n  const [inventoryField, inventoryMeta, inventoryHelpers] =\n    useField('inventory');\n\n  const handleInventoryUpdate = useCallback(\n    (value) => {\n      setFieldValue('inventory', value);\n      setFieldTouched('inventory', true, false);\n    },\n    [setFieldValue, setFieldTouched]\n  );\n\n  const renderInventoryLookup = (\n    <InventoryLookup\n      fieldId=\"inventory-lookup\"\n      value={inventoryField.value}\n      onBlur={() => inventoryHelpers.setTouched()}\n      tooltip={t`Select the inventory that this host will belong to.`}\n      isValid={!inventoryMeta.touched || !inventoryMeta.error}\n      helperTextInvalid={inventoryMeta.error}\n      onChange={handleInventoryUpdate}\n      required\n      touched={inventoryMeta.touched}\n      error={inventoryMeta.error}\n      validate={required(t`Select a value for this field`)}\n      isDisabled={isDisabled}\n      hideAdvancedInventories\n      autoPopulate={!inventoryField.value?.id}\n    />\n  );\n\n  return (\n    <FormGroup\n      label={t`Inventory`}\n      labelIcon={\n        <Popover\n          content={t`Select the inventory that this host will belong to.`}\n        />\n      }\n      isRequired\n      fieldId=\"inventory-lookup\"\n      validated={\n        !inventoryMeta.touched || !inventoryMeta.error ? 'default' : 'error'\n      }\n      helperTextInvalid={inventoryMeta.error}\n    >\n      {isDisabled ? (\n        <Tooltip content={t`Unable to change inventory on a host`}>\n          {renderInventoryLookup}\n        </Tooltip>\n      ) : (\n        renderInventoryLookup\n      )}\n    </FormGroup>\n  );\n};\n\nconst HostForm = ({\n  handleCancel,\n  handleSubmit,\n  host,\n  isInventoryVisible,\n  submitError,\n  disableInventoryLookup,\n}) => (\n  <Formik\n    initialValues={{\n      name: host.name,\n      description: host.description,\n      inventory: host.summary_fields?.inventory || null,\n      variables: host.variables,\n    }}\n    onSubmit={handleSubmit}\n  >\n    {(formik) => (\n      <Form autoComplete=\"off\" onSubmit={formik.handleSubmit}>\n        <FormColumnLayout>\n          <FormField\n            id=\"host-name\"\n            name=\"name\"\n            type=\"text\"\n            label={t`Name`}\n            validate={required(null)}\n            isRequired\n          />\n          <FormField\n            id=\"host-description\"\n            name=\"description\"\n            type=\"text\"\n            label={t`Description`}\n          />\n          {isInventoryVisible && (\n            <InventoryLookupField isDisabled={disableInventoryLookup} />\n          )}\n          <FormFullWidthLayout>\n            <VariablesField\n              id=\"host-variables\"\n              name=\"variables\"\n              label={t`Variables`}\n            />\n          </FormFullWidthLayout>\n          {submitError && <FormSubmitError error={submitError} />}\n          <FormActionGroup\n            onCancel={handleCancel}\n            onSubmit={formik.handleSubmit}\n          />\n        </FormColumnLayout>\n      </Form>\n    )}\n  </Formik>\n);\n\nHostForm.propTypes = {\n  handleCancel: func.isRequired,\n  handleSubmit: func.isRequired,\n  host: shape({}),\n  isInventoryVisible: bool,\n  submitError: shape({}),\n  disableInventoryLookup: bool,\n};\n\nHostForm.defaultProps = {\n  host: {\n    name: '',\n    description: '',\n    inventory: undefined,\n    variables: '---\\n',\n    summary_fields: {\n      inventory: null,\n    },\n  },\n  isInventoryVisible: true,\n  submitError: null,\n  disableInventoryLookup: false,\n};\n\nexport { HostForm as _HostForm };\nexport default HostForm;\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}