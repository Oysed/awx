{"ast":null,"code":"import _asyncToGenerator from\"/awx_devel/awx/ui/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"/awx_devel/awx/ui/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import _regeneratorRuntime from\"/awx_devel/awx/ui/node_modules/@babel/runtime/regenerator/index.js\";import{i18n}from\"@lingui/core\";import React,{useState,useEffect,useCallback}from'react';import{useHistory,Link}from'react-router-dom';import{Card,PageSection}from'@patternfly/react-core';import{CardBody}from'components/Card';import{NotificationTemplatesAPI}from'api';import useRequest from'hooks/useRequest';import ContentError from'components/ContentError';import NotificationTemplateForm from'./shared/NotificationTemplateForm';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";function NotificationTemplateAdd(){var history=useHistory();var _useState=useState(null),_useState2=_slicedToArray(_useState,2),formError=_useState2[0],setFormError=_useState2[1];var _useRequest=useRequest(useCallback(/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var _yield$NotificationTe,data;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return NotificationTemplatesAPI.readOptions();case 2:_yield$NotificationTe=_context.sent;data=_yield$NotificationTe.data;return _context.abrupt(\"return\",data.actions.POST.messages);case 5:case\"end\":return _context.stop();}}},_callee);})),[])),defaultMessages=_useRequest.result,error=_useRequest.error,fetchDefaultMessages=_useRequest.request;useEffect(function(){fetchDefaultMessages();},[fetchDefaultMessages]);var handleSubmit=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(values){var _yield$NotificationTe2,data;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.prev=0;_context2.next=3;return NotificationTemplatesAPI.create(values);case 3:_yield$NotificationTe2=_context2.sent;data=_yield$NotificationTe2.data;history.push(\"/notification_templates/\".concat(data.id));_context2.next=11;break;case 8:_context2.prev=8;_context2.t0=_context2[\"catch\"](0);setFormError(_context2.t0);case 11:case\"end\":return _context2.stop();}}},_callee2,null,[[0,8]]);}));return function handleSubmit(_x){return _ref2.apply(this,arguments);};}();var handleCancel=function handleCancel(){history.push('/notification_templates');};if(error){return/*#__PURE__*/_jsx(PageSection,{children:/*#__PURE__*/_jsx(Card,{children:/*#__PURE__*/_jsx(ContentError,{error:error,children:error.response.status===404&&/*#__PURE__*/_jsxs(\"span\",{children:[/*i18n*/i18n._(\"Notification Template not found.\"),' ',/*#__PURE__*/_jsx(Link,{to:\"/notification_templates\",children:/*i18n*/i18n._(\"View all Notification Templates.\")})]})})})});}return/*#__PURE__*/_jsx(PageSection,{children:/*#__PURE__*/_jsx(Card,{children:/*#__PURE__*/_jsx(CardBody,{children:defaultMessages&&/*#__PURE__*/_jsx(NotificationTemplateForm,{defaultMessages:defaultMessages,onSubmit:handleSubmit,onCancel:handleCancel,submitError:formError})})})});}export{NotificationTemplateAdd as _NotificationTemplateAdd};export default NotificationTemplateAdd;","map":{"version":3,"names":["React","useState","useEffect","useCallback","useHistory","Link","Card","PageSection","CardBody","NotificationTemplatesAPI","useRequest","ContentError","NotificationTemplateForm","jsx","_jsx","jsxs","_jsxs","NotificationTemplateAdd","history","_useState","_useState2","_slicedToArray","formError","setFormError","_useRequest","_asyncToGenerator","_regeneratorRuntime","mark","_callee","_yield$NotificationTe","data","wrap","_callee$","_context","prev","next","readOptions","sent","abrupt","actions","POST","messages","stop","defaultMessages","result","error","fetchDefaultMessages","request","handleSubmit","_ref2","_callee2","values","_yield$NotificationTe2","_callee2$","_context2","create","push","concat","id","t0","_x","apply","arguments","handleCancel","children","response","status","i18n","_","to","onSubmit","onCancel","submitError","_NotificationTemplateAdd"],"sources":["/awx_devel/awx/ui/src/screens/NotificationTemplate/NotificationTemplateAdd.js"],"sourcesContent":["import React, { useState, useEffect, useCallback } from 'react';\nimport { useHistory, Link } from 'react-router-dom';\nimport { t } from '@lingui/macro';\n\nimport { Card, PageSection } from '@patternfly/react-core';\nimport { CardBody } from 'components/Card';\nimport { NotificationTemplatesAPI } from 'api';\nimport useRequest from 'hooks/useRequest';\nimport ContentError from 'components/ContentError';\nimport NotificationTemplateForm from './shared/NotificationTemplateForm';\n\nfunction NotificationTemplateAdd() {\n  const history = useHistory();\n  const [formError, setFormError] = useState(null);\n  const {\n    result: defaultMessages,\n    error,\n    request: fetchDefaultMessages,\n  } = useRequest(\n    useCallback(async () => {\n      const { data } = await NotificationTemplatesAPI.readOptions();\n      return data.actions.POST.messages;\n    }, [])\n  );\n\n  useEffect(() => {\n    fetchDefaultMessages();\n  }, [fetchDefaultMessages]);\n\n  const handleSubmit = async (values) => {\n    try {\n      const { data } = await NotificationTemplatesAPI.create(values);\n      history.push(`/notification_templates/${data.id}`);\n    } catch (err) {\n      setFormError(err);\n    }\n  };\n\n  const handleCancel = () => {\n    history.push('/notification_templates');\n  };\n\n  if (error) {\n    return (\n      <PageSection>\n        <Card>\n          <ContentError error={error}>\n            {error.response.status === 404 && (\n              <span>\n                {t`Notification Template not found.`}{' '}\n                <Link to=\"/notification_templates\">\n                  {t`View all Notification Templates.`}\n                </Link>\n              </span>\n            )}\n          </ContentError>\n        </Card>\n      </PageSection>\n    );\n  }\n\n  return (\n    <PageSection>\n      <Card>\n        <CardBody>\n          {defaultMessages && (\n            <NotificationTemplateForm\n              defaultMessages={defaultMessages}\n              onSubmit={handleSubmit}\n              onCancel={handleCancel}\n              submitError={formError}\n            />\n          )}\n        </CardBody>\n      </Card>\n    </PageSection>\n  );\n}\n\nexport { NotificationTemplateAdd as _NotificationTemplateAdd };\nexport default NotificationTemplateAdd;\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}