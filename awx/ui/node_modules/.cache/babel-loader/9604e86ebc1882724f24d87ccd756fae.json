{"ast":null,"code":"import _slicedToArray from\"/awx_devel/awx/ui/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import _taggedTemplateLiteral from\"/awx_devel/awx/ui/node_modules/@babel/runtime/helpers/esm/taggedTemplateLiteral.js\";var _templateObject,_templateObject2,_templateObject3;import{i18n}from\"@lingui/core\";import React from'react';import{useField}from'formik';import{FormGroup,TextInput,Button,InputGroup as PFInputGroup}from'@patternfly/react-core';import PFCheckIcon from'@patternfly/react-icons/dist/js/icons/check-icon';import styled from'styled-components';import Popover from'components/Popover';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var InputGroup=styled(PFInputGroup)(_templateObject||(_templateObject=_taggedTemplateLiteral([\"\\n  padding-bottom: 5px;\\n\"])));var HelperTextWrapper=styled.div(_templateObject2||(_templateObject2=_taggedTemplateLiteral([\"\\n  font-size: var(--pf-c-form__label--FontSize);\\n\"])));var CheckIcon=styled(PFCheckIcon)(_templateObject3||(_templateObject3=_taggedTemplateLiteral([\"\\n  color: var(--pf-c-button--m-plain--disabled--Color);\\n  \",\";\\n\"])),function(props){return props.selected&&\"color: var(--pf-c-button--m-secondary--active--Color)\";});var validate=function validate(){return function(value){var message;var hasValue=value.find(function(_ref){var choice=_ref.choice;return choice.trim().length>0?choice:undefined;});if(!hasValue){message=/*i18n*/i18n._(\"There must be a value in at least one input\");}return message;};};function MultipleChoiceField(_ref2){var label=_ref2.label,tooltip=_ref2.tooltip;var _useField=useField({name:'formattedChoices',validate:validate()}),_useField2=_slicedToArray(_useField,3),formattedChoicesField=_useField2[0],formattedChoicesMeta=_useField2[1],formattedChoicesHelpers=_useField2[2];var _useField3=useField('type'),_useField4=_slicedToArray(_useField3,1),typeField=_useField4[0];var isValid=!(formattedChoicesMeta.touched&&formattedChoicesMeta.error);return/*#__PURE__*/_jsx(FormGroup,{label:label,isRequired:true,name:\"formattedChoices\",id:\"formattedChoices\",helperText:/*#__PURE__*/_jsxs(HelperTextWrapper,{children:[/*i18n*/i18n._(\"Type answer then click checkbox on right to select answer as\\ndefault.\"),/*#__PURE__*/_jsx(\"br\",{}),/*i18n*/i18n._(\"Press 'Enter' to add more answer choices. One answer\\nchoice per line.\")]}),helperTextInvalid:formattedChoicesMeta.error,onBlur:function onBlur(e){if(!e.currentTarget.contains(e.relatedTarget)){formattedChoicesHelpers.setTouched();}},validated:isValid?'default':'error',labelIcon:/*#__PURE__*/_jsx(Popover,{content:tooltip}),children:formattedChoicesField.value.map(function(_ref3,i){var choice=_ref3.choice,isDefault=_ref3.isDefault,id=_ref3.id;return/*#__PURE__*/_jsxs(InputGroup,{children:[/*#__PURE__*/_jsx(TextInput,{\"data-cy\":choice?\"\".concat(choice,\"-input\"):'new-choice-input',\"aria-label\":choice||/*i18n*/i18n._(\"new choice\"),onKeyUp:function onKeyUp(e){if(e.key==='Enter'&&choice.trim().length>0&&i===formattedChoicesField.value.length-1){formattedChoicesHelpers.setValue(formattedChoicesField.value.concat({choice:'',isDefault:false,id:i+1}));}if(e.key==='Backspace'&&!choice.trim()&&formattedChoicesField.value.length>1){var removeEmptyField=formattedChoicesField.value.filter(function(c,index){return index!==i;});formattedChoicesHelpers.setValue(removeEmptyField);}},value:choice,onChange:function onChange(value){var newValues=formattedChoicesField.value.map(function(choiceField,index){return i===index?{choice:value,isDefault:false,id:choiceField.id}:choiceField;});formattedChoicesHelpers.setValue(newValues);}}),/*#__PURE__*/_jsx(Button,{variant:\"control\",\"aria-label\":/*i18n*/i18n._(\"Click to toggle default value\"),ouiaId:choice?\"\".concat(choice,\"-button\"):'new-choice-button',isDisabled:!choice.trim(),onClick:function onClick(){var newValues=formattedChoicesField.value.map(function(choiceField,index){return i===index?{choice:choiceField.choice,isDefault:!choiceField.isDefault,id:choiceField.id}:choiceField;});var singleSelectValues=formattedChoicesField.value.map(function(choiceField,index){return i===index?{choice:choiceField.choice,isDefault:!choiceField.isDefault,id:choiceField.id}:{choice:choiceField.choice,isDefault:false,id:choiceField.id};});return typeField.value==='multiplechoice'?formattedChoicesHelpers.setValue(singleSelectValues):formattedChoicesHelpers.setValue(newValues);},children:/*#__PURE__*/_jsx(CheckIcon,{selected:isDefault})})]},id);})});}export default MultipleChoiceField;","map":{"version":3,"names":["React","useField","FormGroup","TextInput","Button","InputGroup","PFInputGroup","PFCheckIcon","styled","Popover","jsx","_jsx","jsxs","_jsxs","_templateObject","_taggedTemplateLiteral","HelperTextWrapper","div","_templateObject2","CheckIcon","_templateObject3","props","selected","validate","value","message","hasValue","find","_ref","choice","trim","length","undefined","i18n","_","MultipleChoiceField","_ref2","label","tooltip","_useField","name","_useField2","_slicedToArray","formattedChoicesField","formattedChoicesMeta","formattedChoicesHelpers","_useField3","_useField4","typeField","isValid","touched","error","isRequired","id","helperText","children","helperTextInvalid","onBlur","e","currentTarget","contains","relatedTarget","setTouched","validated","labelIcon","content","map","_ref3","i","isDefault","concat","onKeyUp","key","setValue","removeEmptyField","filter","c","index","onChange","newValues","choiceField","variant","ouiaId","isDisabled","onClick","singleSelectValues"],"sources":["/awx_devel/awx/ui/src/screens/Template/Survey/MultipleChoiceField.js"],"sourcesContent":["import React from 'react';\nimport { useField } from 'formik';\nimport { t } from '@lingui/macro';\nimport {\n  FormGroup,\n  TextInput,\n  Button,\n  InputGroup as PFInputGroup,\n} from '@patternfly/react-core';\nimport PFCheckIcon from '@patternfly/react-icons/dist/js/icons/check-icon';\nimport styled from 'styled-components';\nimport Popover from 'components/Popover';\n\nconst InputGroup = styled(PFInputGroup)`\n  padding-bottom: 5px;\n`;\n\nconst HelperTextWrapper = styled.div`\n  font-size: var(--pf-c-form__label--FontSize);\n`;\n\nconst CheckIcon = styled(PFCheckIcon)`\n  color: var(--pf-c-button--m-plain--disabled--Color);\n  ${(props) =>\n    props.selected && `color: var(--pf-c-button--m-secondary--active--Color)`};\n`;\n\nconst validate = () => (value) => {\n  let message;\n  const hasValue = value.find(({ choice }) =>\n    choice.trim().length > 0 ? choice : undefined\n  );\n  if (!hasValue) {\n    message = t`There must be a value in at least one input`;\n  }\n  return message;\n};\nfunction MultipleChoiceField({ label, tooltip }) {\n  const [formattedChoicesField, formattedChoicesMeta, formattedChoicesHelpers] =\n    useField({\n      name: 'formattedChoices',\n      validate: validate(),\n    });\n\n  const [typeField] = useField('type');\n  const isValid = !(formattedChoicesMeta.touched && formattedChoicesMeta.error);\n\n  return (\n    <FormGroup\n      label={label}\n      isRequired\n      name=\"formattedChoices\"\n      id=\"formattedChoices\"\n      helperText={\n        <HelperTextWrapper>\n          {t`Type answer then click checkbox on right to select answer as\n          default.`}\n          <br />\n          {t`Press 'Enter' to add more answer choices. One answer\n          choice per line.`}\n        </HelperTextWrapper>\n      }\n      helperTextInvalid={formattedChoicesMeta.error}\n      onBlur={(e) => {\n        if (!e.currentTarget.contains(e.relatedTarget)) {\n          formattedChoicesHelpers.setTouched();\n        }\n      }}\n      validated={isValid ? 'default' : 'error'}\n      labelIcon={<Popover content={tooltip} />}\n    >\n      {formattedChoicesField.value.map(({ choice, isDefault, id }, i) => (\n        <InputGroup key={id}>\n          <TextInput\n            data-cy={choice ? `${choice}-input` : 'new-choice-input'}\n            aria-label={choice || t`new choice`}\n            onKeyUp={(e) => {\n              if (\n                e.key === 'Enter' &&\n                choice.trim().length > 0 &&\n                i === formattedChoicesField.value.length - 1\n              ) {\n                formattedChoicesHelpers.setValue(\n                  formattedChoicesField.value.concat({\n                    choice: '',\n                    isDefault: false,\n                    id: i + 1,\n                  })\n                );\n              }\n\n              if (\n                e.key === 'Backspace' &&\n                !choice.trim() &&\n                formattedChoicesField.value.length > 1\n              ) {\n                const removeEmptyField = formattedChoicesField.value.filter(\n                  (c, index) => index !== i\n                );\n\n                formattedChoicesHelpers.setValue(removeEmptyField);\n              }\n            }}\n            value={choice}\n            onChange={(value) => {\n              const newValues = formattedChoicesField.value.map(\n                (choiceField, index) =>\n                  i === index\n                    ? { choice: value, isDefault: false, id: choiceField.id }\n                    : choiceField\n              );\n              formattedChoicesHelpers.setValue(newValues);\n            }}\n          />\n          <Button\n            variant=\"control\"\n            aria-label={t`Click to toggle default value`}\n            ouiaId={choice ? `${choice}-button` : 'new-choice-button'}\n            isDisabled={!choice.trim()}\n            onClick={() => {\n              const newValues = formattedChoicesField.value.map(\n                (choiceField, index) =>\n                  i === index\n                    ? {\n                        choice: choiceField.choice,\n                        isDefault: !choiceField.isDefault,\n                        id: choiceField.id,\n                      }\n                    : choiceField\n              );\n              const singleSelectValues = formattedChoicesField.value.map(\n                (choiceField, index) =>\n                  i === index\n                    ? {\n                        choice: choiceField.choice,\n                        isDefault: !choiceField.isDefault,\n                        id: choiceField.id,\n                      }\n                    : {\n                        choice: choiceField.choice,\n                        isDefault: false,\n                        id: choiceField.id,\n                      }\n              );\n              return typeField.value === 'multiplechoice'\n                ? formattedChoicesHelpers.setValue(singleSelectValues)\n                : formattedChoicesHelpers.setValue(newValues);\n            }}\n          >\n            <CheckIcon selected={isDefault} />\n          </Button>\n        </InputGroup>\n      ))}\n    </FormGroup>\n  );\n}\n\nexport default MultipleChoiceField;\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}