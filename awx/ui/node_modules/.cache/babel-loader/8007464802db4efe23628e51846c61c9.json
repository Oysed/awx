{"ast":null,"code":"import _asyncToGenerator from\"/awx_devel/awx/ui/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"/awx_devel/awx/ui/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import _taggedTemplateLiteral from\"/awx_devel/awx/ui/node_modules/@babel/runtime/helpers/esm/taggedTemplateLiteral.js\";var _templateObject;import _regeneratorRuntime from\"/awx_devel/awx/ui/node_modules/@babel/runtime/regenerator/index.js\";import{i18n}from\"@lingui/core\";import React,{useCallback,useEffect,useState}from'react';import{Link}from'react-router-dom';import styled from'styled-components';import{Dropdown,DropdownItem,DropdownToggle,DropdownPosition,NotificationBadge,NotificationBadgeVariant,PageHeaderTools,PageHeaderToolsGroup,PageHeaderToolsItem,Tooltip}from'@patternfly/react-core';import{QuestionCircleIcon,UserIcon}from'@patternfly/react-icons';import{WorkflowApprovalsAPI}from'api';import useRequest from'hooks/useRequest';import getDocsBaseUrl from'util/getDocsBaseUrl';import{useConfig}from'contexts/Config';import useWsPendingApprovalCount from'./useWsPendingApprovalCount';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var PendingWorkflowApprovals=styled.div(_templateObject||(_templateObject=_taggedTemplateLiteral([\"\\n  display: flex;\\n  align-items: center;\\n  padding: 10px;\\n  margin-right: 10px;\\n\"])));function PageHeaderToolbar(_ref){var isAboutDisabled=_ref.isAboutDisabled,onAboutClick=_ref.onAboutClick,onLogoutClick=_ref.onLogoutClick,loggedInUser=_ref.loggedInUser;var _useState=useState(false),_useState2=_slicedToArray(_useState,2),isHelpOpen=_useState2[0],setIsHelpOpen=_useState2[1];var _useState3=useState(false),_useState4=_slicedToArray(_useState3,2),isUserOpen=_useState4[0],setIsUserOpen=_useState4[1];var config=useConfig();var _useRequest=useRequest(useCallback(/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var _yield$WorkflowApprov,count;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return WorkflowApprovalsAPI.read({status:'pending',page_size:1});case 2:_yield$WorkflowApprov=_context.sent;count=_yield$WorkflowApprov.data.count;return _context.abrupt(\"return\",count);case 5:case\"end\":return _context.stop();}}},_callee);})),[]),0),fetchPendingApprovalCount=_useRequest.request,pendingApprovals=_useRequest.result;var pendingApprovalsCount=useWsPendingApprovalCount(pendingApprovals,fetchPendingApprovalCount);useEffect(function(){fetchPendingApprovalCount();},[fetchPendingApprovalCount]);var handleHelpSelect=function handleHelpSelect(){setIsHelpOpen(!isHelpOpen);};var handleUserSelect=function handleUserSelect(){setIsUserOpen(!isUserOpen);};return/*#__PURE__*/_jsx(PageHeaderTools,{children:/*#__PURE__*/_jsxs(PageHeaderToolsGroup,{children:[/*#__PURE__*/_jsx(Tooltip,{position:\"bottom\",content:/*i18n*/i18n._(\"Pending Workflow Approvals\"),children:/*#__PURE__*/_jsx(PageHeaderToolsItem,{children:/*#__PURE__*/_jsx(Link,{to:\"/workflow_approvals?workflow_approvals.status=pending\",children:/*#__PURE__*/_jsx(PendingWorkflowApprovals,{children:/*#__PURE__*/_jsx(NotificationBadge,{id:\"toolbar-workflow-approval-badge\",count:pendingApprovalsCount,variant:pendingApprovalsCount===0?NotificationBadgeVariant.read:NotificationBadgeVariant.unread})})})})}),/*#__PURE__*/_jsx(PageHeaderToolsItem,{children:/*#__PURE__*/_jsx(Dropdown,{isPlain:true,isOpen:isHelpOpen,position:DropdownPosition.right,onSelect:handleHelpSelect,ouiaId:\"toolbar-info-dropdown\",toggle:/*#__PURE__*/_jsx(DropdownToggle,{onToggle:setIsHelpOpen,\"aria-label\":/*i18n*/i18n._(\"Info\"),ouiaId:\"toolbar-info-dropdown-toggle\",children:/*#__PURE__*/_jsx(QuestionCircleIcon,{})}),dropdownItems:[/*#__PURE__*/_jsx(DropdownItem,{target:\"_blank\",href:\"\".concat(getDocsBaseUrl(config),\"/html/userguide/index.html\"),ouiaId:\"help-dropdown-item\",rel:\"noopener noreferrer\",children:/*i18n*/i18n._(\"Help\")},\"help\"),/*#__PURE__*/_jsx(DropdownItem,{component:\"button\",isDisabled:isAboutDisabled,onClick:onAboutClick,ouiaId:\"about-dropdown-item\",children:/*i18n*/i18n._(\"About\")},\"about\")]})}),/*#__PURE__*/_jsx(PageHeaderToolsItem,{children:/*#__PURE__*/_jsx(Dropdown,{id:\"toolbar-user-dropdown\",ouiaId:\"toolbar-user-dropdown\",isPlain:true,isOpen:isUserOpen,position:DropdownPosition.right,onSelect:handleUserSelect,toggle:/*#__PURE__*/_jsxs(DropdownToggle,{onToggle:setIsUserOpen,ouiaId:\"toolbar-user-dropdown-toggle\",children:[/*#__PURE__*/_jsx(UserIcon,{}),loggedInUser&&/*#__PURE__*/_jsx(\"span\",{style:{marginLeft:'10px'},children:loggedInUser.username})]}),dropdownItems:[/*#__PURE__*/_jsx(DropdownItem,{\"aria-label\":/*i18n*/i18n._(\"User details\"),href:loggedInUser?\"#/users/\".concat(loggedInUser.id,\"/details\"):'#/home',ouiaId:\"user-dropdown-item\",children:/*i18n*/i18n._(\"User Details\")},\"user\"),/*#__PURE__*/_jsx(DropdownItem,{component:\"button\",onClick:onLogoutClick,id:\"logout-button\",ouiaId:\"logout-dropdown-item\",children:/*i18n*/i18n._(\"Logout\")},\"logout\")]})})]})});}PageHeaderToolbar.defaultProps={isAboutDisabled:false};export default PageHeaderToolbar;","map":{"version":3,"names":["React","useCallback","useEffect","useState","Link","styled","Dropdown","DropdownItem","DropdownToggle","DropdownPosition","NotificationBadge","NotificationBadgeVariant","PageHeaderTools","PageHeaderToolsGroup","PageHeaderToolsItem","Tooltip","QuestionCircleIcon","UserIcon","WorkflowApprovalsAPI","useRequest","getDocsBaseUrl","useConfig","useWsPendingApprovalCount","jsx","_jsx","jsxs","_jsxs","PendingWorkflowApprovals","div","_templateObject","_taggedTemplateLiteral","PageHeaderToolbar","_ref","isAboutDisabled","onAboutClick","onLogoutClick","loggedInUser","_useState","_useState2","_slicedToArray","isHelpOpen","setIsHelpOpen","_useState3","_useState4","isUserOpen","setIsUserOpen","config","_useRequest","_asyncToGenerator","_regeneratorRuntime","mark","_callee","_yield$WorkflowApprov","count","wrap","_callee$","_context","prev","next","read","status","page_size","sent","data","abrupt","stop","fetchPendingApprovalCount","request","pendingApprovals","result","pendingApprovalsCount","handleHelpSelect","handleUserSelect","children","position","content","i18n","_","to","id","variant","unread","isPlain","isOpen","right","onSelect","ouiaId","toggle","onToggle","dropdownItems","target","href","concat","rel","component","isDisabled","onClick","style","marginLeft","username","defaultProps"],"sources":["/awx_devel/awx/ui/src/components/AppContainer/PageHeaderToolbar.js"],"sourcesContent":["import React, { useCallback, useEffect, useState } from 'react';\nimport PropTypes from 'prop-types';\n\nimport { t } from '@lingui/macro';\nimport { Link } from 'react-router-dom';\nimport styled from 'styled-components';\nimport {\n  Dropdown,\n  DropdownItem,\n  DropdownToggle,\n  DropdownPosition,\n  NotificationBadge,\n  NotificationBadgeVariant,\n  PageHeaderTools,\n  PageHeaderToolsGroup,\n  PageHeaderToolsItem,\n  Tooltip,\n} from '@patternfly/react-core';\nimport { QuestionCircleIcon, UserIcon } from '@patternfly/react-icons';\nimport { WorkflowApprovalsAPI } from 'api';\nimport useRequest from 'hooks/useRequest';\nimport getDocsBaseUrl from 'util/getDocsBaseUrl';\nimport { useConfig } from 'contexts/Config';\nimport useWsPendingApprovalCount from './useWsPendingApprovalCount';\n\nconst PendingWorkflowApprovals = styled.div`\n  display: flex;\n  align-items: center;\n  padding: 10px;\n  margin-right: 10px;\n`;\n\nfunction PageHeaderToolbar({\n  isAboutDisabled,\n  onAboutClick,\n  onLogoutClick,\n  loggedInUser,\n}) {\n  const [isHelpOpen, setIsHelpOpen] = useState(false);\n  const [isUserOpen, setIsUserOpen] = useState(false);\n  const config = useConfig();\n\n  const { request: fetchPendingApprovalCount, result: pendingApprovals } =\n    useRequest(\n      useCallback(async () => {\n        const {\n          data: { count },\n        } = await WorkflowApprovalsAPI.read({\n          status: 'pending',\n          page_size: 1,\n        });\n        return count;\n      }, []),\n      0\n    );\n\n  const pendingApprovalsCount = useWsPendingApprovalCount(\n    pendingApprovals,\n    fetchPendingApprovalCount\n  );\n\n  useEffect(() => {\n    fetchPendingApprovalCount();\n  }, [fetchPendingApprovalCount]);\n\n  const handleHelpSelect = () => {\n    setIsHelpOpen(!isHelpOpen);\n  };\n\n  const handleUserSelect = () => {\n    setIsUserOpen(!isUserOpen);\n  };\n  return (\n    <PageHeaderTools>\n      <PageHeaderToolsGroup>\n        <Tooltip position=\"bottom\" content={t`Pending Workflow Approvals`}>\n          <PageHeaderToolsItem>\n            <Link to=\"/workflow_approvals?workflow_approvals.status=pending\">\n              <PendingWorkflowApprovals>\n                <NotificationBadge\n                  id=\"toolbar-workflow-approval-badge\"\n                  count={pendingApprovalsCount}\n                  variant={\n                    pendingApprovalsCount === 0\n                      ? NotificationBadgeVariant.read\n                      : NotificationBadgeVariant.unread\n                  }\n                />\n              </PendingWorkflowApprovals>\n            </Link>\n          </PageHeaderToolsItem>\n        </Tooltip>\n        <PageHeaderToolsItem>\n          <Dropdown\n            isPlain\n            isOpen={isHelpOpen}\n            position={DropdownPosition.right}\n            onSelect={handleHelpSelect}\n            ouiaId=\"toolbar-info-dropdown\"\n            toggle={\n              <DropdownToggle\n                onToggle={setIsHelpOpen}\n                aria-label={t`Info`}\n                ouiaId=\"toolbar-info-dropdown-toggle\"\n              >\n                <QuestionCircleIcon />\n              </DropdownToggle>\n            }\n            dropdownItems={[\n              <DropdownItem\n                key=\"help\"\n                target=\"_blank\"\n                href={`${getDocsBaseUrl(config)}/html/userguide/index.html`}\n                ouiaId=\"help-dropdown-item\"\n                rel=\"noopener noreferrer\"\n              >\n                {t`Help`}\n              </DropdownItem>,\n              <DropdownItem\n                key=\"about\"\n                component=\"button\"\n                isDisabled={isAboutDisabled}\n                onClick={onAboutClick}\n                ouiaId=\"about-dropdown-item\"\n              >\n                {t`About`}\n              </DropdownItem>,\n            ]}\n          />\n        </PageHeaderToolsItem>\n        <PageHeaderToolsItem>\n          <Dropdown\n            id=\"toolbar-user-dropdown\"\n            ouiaId=\"toolbar-user-dropdown\"\n            isPlain\n            isOpen={isUserOpen}\n            position={DropdownPosition.right}\n            onSelect={handleUserSelect}\n            toggle={\n              <DropdownToggle\n                onToggle={setIsUserOpen}\n                ouiaId=\"toolbar-user-dropdown-toggle\"\n              >\n                <UserIcon />\n                {loggedInUser && (\n                  <span style={{ marginLeft: '10px' }}>\n                    {loggedInUser.username}\n                  </span>\n                )}\n              </DropdownToggle>\n            }\n            dropdownItems={[\n              <DropdownItem\n                key=\"user\"\n                aria-label={t`User details`}\n                href={\n                  loggedInUser ? `#/users/${loggedInUser.id}/details` : '#/home'\n                }\n                ouiaId=\"user-dropdown-item\"\n              >\n                {t`User Details`}\n              </DropdownItem>,\n              <DropdownItem\n                key=\"logout\"\n                component=\"button\"\n                onClick={onLogoutClick}\n                id=\"logout-button\"\n                ouiaId=\"logout-dropdown-item\"\n              >\n                {t`Logout`}\n              </DropdownItem>,\n            ]}\n          />\n        </PageHeaderToolsItem>\n      </PageHeaderToolsGroup>\n    </PageHeaderTools>\n  );\n}\n\nPageHeaderToolbar.propTypes = {\n  isAboutDisabled: PropTypes.bool,\n  onAboutClick: PropTypes.func.isRequired,\n  onLogoutClick: PropTypes.func.isRequired,\n};\n\nPageHeaderToolbar.defaultProps = {\n  isAboutDisabled: false,\n};\n\nexport default PageHeaderToolbar;\n"],"mappings":"keAAA,MAAO,CAAAA,KAAK,EAAIC,WAAW,CAAEC,SAAS,CAAEC,QAAQ,KAAQ,OAAO,CAI/D,OAASC,IAAI,KAAQ,kBAAkB,CACvC,MAAO,CAAAC,MAAM,KAAM,mBAAmB,CACtC,OACEC,QAAQ,CACRC,YAAY,CACZC,cAAc,CACdC,gBAAgB,CAChBC,iBAAiB,CACjBC,wBAAwB,CACxBC,eAAe,CACfC,oBAAoB,CACpBC,mBAAmB,CACnBC,OAAO,KACF,wBAAwB,CAC/B,OAASC,kBAAkB,CAAEC,QAAQ,KAAQ,yBAAyB,CACtE,OAASC,oBAAoB,KAAQ,KAAK,CAC1C,MAAO,CAAAC,UAAU,KAAM,kBAAkB,CACzC,MAAO,CAAAC,cAAc,KAAM,qBAAqB,CAChD,OAASC,SAAS,KAAQ,iBAAiB,CAC3C,MAAO,CAAAC,yBAAyB,KAAM,6BAA6B,CAAC,OAAAC,GAAA,IAAAC,IAAA,gCAAAC,IAAA,IAAAC,KAAA,yBAEpE,GAAM,CAAAC,wBAAwB,CAAGtB,MAAM,CAACuB,GAAG,CAAAC,eAAA,GAAAA,eAAA,CAAAC,sBAAA,6FAK1C,CAED,QAAS,CAAAC,iBAAiBA,CAAAC,IAAA,CAKvB,IAJD,CAAAC,eAAe,CAAAD,IAAA,CAAfC,eAAe,CACfC,YAAY,CAAAF,IAAA,CAAZE,YAAY,CACZC,aAAa,CAAAH,IAAA,CAAbG,aAAa,CACbC,YAAY,CAAAJ,IAAA,CAAZI,YAAY,CAEZ,IAAAC,SAAA,CAAoClC,QAAQ,CAAC,KAAK,CAAC,CAAAmC,UAAA,CAAAC,cAAA,CAAAF,SAAA,IAA5CG,UAAU,CAAAF,UAAA,IAAEG,aAAa,CAAAH,UAAA,IAChC,IAAAI,UAAA,CAAoCvC,QAAQ,CAAC,KAAK,CAAC,CAAAwC,UAAA,CAAAJ,cAAA,CAAAG,UAAA,IAA5CE,UAAU,CAAAD,UAAA,IAAEE,aAAa,CAAAF,UAAA,IAChC,GAAM,CAAAG,MAAM,CAAGzB,SAAS,CAAC,CAAC,CAE1B,IAAA0B,WAAA,CACE5B,UAAU,CACRlB,WAAW,cAAA+C,iBAAA,cAAAC,mBAAA,CAAAC,IAAA,CAAC,SAAAC,QAAA,MAAAC,qBAAA,CAAAC,KAAA,QAAAJ,mBAAA,CAAAK,IAAA,UAAAC,SAAAC,QAAA,kBAAAA,QAAA,CAAAC,IAAA,CAAAD,QAAA,CAAAE,IAAA,SAAAF,QAAA,CAAAE,IAAA,SAGA,CAAAxC,oBAAoB,CAACyC,IAAI,CAAC,CAClCC,MAAM,CAAE,SAAS,CACjBC,SAAS,CAAE,CACb,CAAC,CAAC,QAAAT,qBAAA,CAAAI,QAAA,CAAAM,IAAA,CAJQT,KAAK,CAAAD,qBAAA,CAAbW,IAAI,CAAIV,KAAK,QAAAG,QAAA,CAAAQ,MAAA,UAKRX,KAAK,0BAAAG,QAAA,CAAAS,IAAA,OAAAd,OAAA,GACb,GAAE,EAAE,CAAC,CACN,CACF,CAAC,CAZce,yBAAyB,CAAAnB,WAAA,CAAlCoB,OAAO,CAAqCC,gBAAgB,CAAArB,WAAA,CAAxBsB,MAAM,CAclD,GAAM,CAAAC,qBAAqB,CAAGhD,yBAAyB,CACrD8C,gBAAgB,CAChBF,yBACF,CAAC,CAEDhE,SAAS,CAAC,UAAM,CACdgE,yBAAyB,CAAC,CAAC,CAC7B,CAAC,CAAE,CAACA,yBAAyB,CAAC,CAAC,CAE/B,GAAM,CAAAK,gBAAgB,CAAG,QAAnB,CAAAA,gBAAgBA,CAAA,CAAS,CAC7B9B,aAAa,CAAC,CAACD,UAAU,CAAC,CAC5B,CAAC,CAED,GAAM,CAAAgC,gBAAgB,CAAG,QAAnB,CAAAA,gBAAgBA,CAAA,CAAS,CAC7B3B,aAAa,CAAC,CAACD,UAAU,CAAC,CAC5B,CAAC,CACD,mBACEpB,IAAA,CAACZ,eAAe,EAAA6D,QAAA,cACd/C,KAAA,CAACb,oBAAoB,EAAA4D,QAAA,eACnBjD,IAAA,CAACT,OAAO,EAAC2D,QAAQ,CAAC,QAAQ,CAACC,OAAO,SAAEC,IAAA,CAAAC,CAAA,6BAA4B,CAAE,CAAAJ,QAAA,cAChEjD,IAAA,CAACV,mBAAmB,EAAA2D,QAAA,cAClBjD,IAAA,CAACpB,IAAI,EAAC0E,EAAE,CAAC,uDAAuD,CAAAL,QAAA,cAC9DjD,IAAA,CAACG,wBAAwB,EAAA8C,QAAA,cACvBjD,IAAA,CAACd,iBAAiB,EAChBqE,EAAE,CAAC,iCAAiC,CACpC1B,KAAK,CAAEiB,qBAAsB,CAC7BU,OAAO,CACLV,qBAAqB,GAAK,CAAC,CACvB3D,wBAAwB,CAACgD,IAAI,CAC7BhD,wBAAwB,CAACsE,MAC9B,CACF,CAAC,CACsB,CAAC,CACvB,CAAC,CACY,CAAC,CACf,CAAC,cACVzD,IAAA,CAACV,mBAAmB,EAAA2D,QAAA,cAClBjD,IAAA,CAAClB,QAAQ,EACP4E,OAAO,MACPC,MAAM,CAAE3C,UAAW,CACnBkC,QAAQ,CAAEjE,gBAAgB,CAAC2E,KAAM,CACjCC,QAAQ,CAAEd,gBAAiB,CAC3Be,MAAM,CAAC,uBAAuB,CAC9BC,MAAM,cACJ/D,IAAA,CAAChB,cAAc,EACbgF,QAAQ,CAAE/C,aAAc,CACxB,qBAAYmC,IAAA,CAAAC,CAAA,OAAM,CAAE,CACpBS,MAAM,CAAC,8BAA8B,CAAAb,QAAA,cAErCjD,IAAA,CAACR,kBAAkB,GAAE,CAAC,CACR,CACjB,CACDyE,aAAa,CAAE,cACbjE,IAAA,CAACjB,YAAY,EAEXmF,MAAM,CAAC,QAAQ,CACfC,IAAI,IAAAC,MAAA,CAAKxE,cAAc,CAAC0B,MAAM,CAAC,8BAA6B,CAC5DwC,MAAM,CAAC,oBAAoB,CAC3BO,GAAG,CAAC,qBAAqB,CAAApB,QAAA,SAExBG,IAAA,CAAAC,CAAA,OAAM,CAAC,EANJ,MAOQ,CAAC,cACfrD,IAAA,CAACjB,YAAY,EAEXuF,SAAS,CAAC,QAAQ,CAClBC,UAAU,CAAE9D,eAAgB,CAC5B+D,OAAO,CAAE9D,YAAa,CACtBoD,MAAM,CAAC,qBAAqB,CAAAb,QAAA,SAE3BG,IAAA,CAAAC,CAAA,QAAO,CAAC,EANL,OAOQ,CAAC,CACf,CACH,CAAC,CACiB,CAAC,cACtBrD,IAAA,CAACV,mBAAmB,EAAA2D,QAAA,cAClBjD,IAAA,CAAClB,QAAQ,EACPyE,EAAE,CAAC,uBAAuB,CAC1BO,MAAM,CAAC,uBAAuB,CAC9BJ,OAAO,MACPC,MAAM,CAAEvC,UAAW,CACnB8B,QAAQ,CAAEjE,gBAAgB,CAAC2E,KAAM,CACjCC,QAAQ,CAAEb,gBAAiB,CAC3Be,MAAM,cACJ7D,KAAA,CAAClB,cAAc,EACbgF,QAAQ,CAAE3C,aAAc,CACxByC,MAAM,CAAC,8BAA8B,CAAAb,QAAA,eAErCjD,IAAA,CAACP,QAAQ,GAAE,CAAC,CACXmB,YAAY,eACXZ,IAAA,SAAMyE,KAAK,CAAE,CAAEC,UAAU,CAAE,MAAO,CAAE,CAAAzB,QAAA,CACjCrC,YAAY,CAAC+D,QAAQ,CAClB,CACP,EACa,CACjB,CACDV,aAAa,CAAE,cACbjE,IAAA,CAACjB,YAAY,EAEX,qBAAYqE,IAAA,CAAAC,CAAA,eAAc,CAAE,CAC5Bc,IAAI,CACFvD,YAAY,YAAAwD,MAAA,CAAcxD,YAAY,CAAC2C,EAAE,aAAa,QACvD,CACDO,MAAM,CAAC,oBAAoB,CAAAb,QAAA,SAE1BG,IAAA,CAAAC,CAAA,eAAc,CAAC,EAPZ,MAQQ,CAAC,cACfrD,IAAA,CAACjB,YAAY,EAEXuF,SAAS,CAAC,QAAQ,CAClBE,OAAO,CAAE7D,aAAc,CACvB4C,EAAE,CAAC,eAAe,CAClBO,MAAM,CAAC,sBAAsB,CAAAb,QAAA,SAE5BG,IAAA,CAAAC,CAAA,SAAQ,CAAC,EANN,QAOQ,CAAC,CACf,CACH,CAAC,CACiB,CAAC,EACF,CAAC,CACR,CAAC,CAEtB,CAQA9C,iBAAiB,CAACqE,YAAY,CAAG,CAC/BnE,eAAe,CAAE,KACnB,CAAC,CAED,cAAe,CAAAF,iBAAiB"},"metadata":{},"sourceType":"module"}