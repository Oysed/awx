{"ast":null,"code":"import _objectSpread from\"/awx_devel/awx/ui/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import _asyncToGenerator from\"/awx_devel/awx/ui/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"/awx_devel/awx/ui/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import _regeneratorRuntime from\"/awx_devel/awx/ui/node_modules/@babel/runtime/regenerator/index.js\";import{i18n}from\"@lingui/core\";import React,{useCallback,useEffect,useState}from'react';import ScreenHeader from'components/ScreenHeader/ScreenHeader';import{HostMetricsAPI}from'api';import useRequest from'hooks/useRequest';import PaginatedTable,{HeaderRow,HeaderCell}from'components/PaginatedTable';import DataListToolbar from'components/DataListToolbar';import{getQSConfig,parseQueryString}from'util/qs';import{Card,PageSection}from'@patternfly/react-core';import{useLocation}from'react-router-dom';import useSelected from'hooks/useSelected';import HostMetricsListItem from'./HostMetricsListItem';import HostMetricsDeleteButton from'./HostMetricsDeleteButton';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";var QS_CONFIG=getQSConfig('host_metrics',{page:1,page_size:20,order_by:'hostname',deleted:false});function HostMetrics(){var location=useLocation();var _useState=useState({'/host_metrics':/*i18n*/i18n._(\"Host Metrics\")}),_useState2=_slicedToArray(_useState,1),breadcrumbConfig=_useState2[0];var _useRequest=useRequest(useCallback(/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var params,list;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:params=parseQueryString(QS_CONFIG,location.search);_context.next=3;return HostMetricsAPI.read(params);case 3:list=_context.sent;return _context.abrupt(\"return\",{count:list.data.count,results:list.data.results});case 5:case\"end\":return _context.stop();}}},_callee);})),[location]),{results:[],count:0}),_useRequest$result=_useRequest.result,count=_useRequest$result.count,results=_useRequest$result.results,isLoading=_useRequest.isLoading,error=_useRequest.error,readHostMetrics=_useRequest.request;useEffect(function(){readHostMetrics();},[readHostMetrics]);var _useSelected=useSelected(results),selected=_useSelected.selected,isAllSelected=_useSelected.isAllSelected,handleSelect=_useSelected.handleSelect,selectAll=_useSelected.selectAll,clearSelected=_useSelected.clearSelected;return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(ScreenHeader,{streamType:\"none\",breadcrumbConfig:breadcrumbConfig}),/*#__PURE__*/_jsx(PageSection,{children:/*#__PURE__*/_jsx(Card,{children:/*#__PURE__*/_jsx(PaginatedTable,{contentError:error,hasContentLoading:isLoading,items:results,itemCount:count,pluralizedItemName:/*i18n*/i18n._(\"Host Metrics\"),renderRow:function renderRow(item,index){return/*#__PURE__*/_jsx(HostMetricsListItem,{item:item,isSelected:selected.some(function(row){return row.hostname===item.hostname;}),onSelect:function onSelect(){return handleSelect(item);},rowIndex:index},item.id);},qsConfig:QS_CONFIG,toolbarSearchColumns:[{name:/*i18n*/i18n._(\"Hostname\"),key:'hostname__icontains',isDefault:true}],toolbarSearchableKeys:[],toolbarRelatedSearchableKeys:[],renderToolbar:function renderToolbar(props){return/*#__PURE__*/_jsx(DataListToolbar,_objectSpread(_objectSpread({},props),{},{advancedSearchDisabled:true,fillWidth:true,isAllSelected:isAllSelected,onSelectAll:selectAll,additionalControls:[/*#__PURE__*/_jsx(HostMetricsDeleteButton,{onDelete:function onDelete(){return Promise.all(selected.map(function(hostMetric){return HostMetricsAPI.destroy(hostMetric.id);})).then(function(){readHostMetrics();clearSelected();});},itemsToDelete:selected,pluralizedItemName:/*i18n*/i18n._(\"Host Metrics\")},\"delete\")]}));},headerRow:/*#__PURE__*/_jsxs(HeaderRow,{qsConfig:QS_CONFIG,children:[/*#__PURE__*/_jsx(HeaderCell,{sortKey:\"hostname\",children:/*i18n*/i18n._(\"Hostname\")}),/*#__PURE__*/_jsx(HeaderCell,{sortKey:\"first_automation\",tooltip:/*i18n*/i18n._(\"When was the host first automated\"),children:/*i18n*/i18n._(\"First automated\")}),/*#__PURE__*/_jsx(HeaderCell,{sortKey:\"last_automation\",tooltip:/*i18n*/i18n._(\"When was the host last automated\"),children:/*i18n*/i18n._(\"Last automated\")}),/*#__PURE__*/_jsx(HeaderCell,{sortKey:\"automated_counter\",tooltip:/*i18n*/i18n._(\"How many times was the host automated\"),children:/*i18n*/i18n._(\"Automation\")}),/*#__PURE__*/_jsx(HeaderCell,{sortKey:\"deleted_counter\",tooltip:/*i18n*/i18n._(\"How many times was the host deleted\"),children:/*i18n*/i18n._(\"Deleted\")})]})})})})]});}export{HostMetrics as _HostMetrics};export default HostMetrics;","map":{"version":3,"names":["React","useCallback","useEffect","useState","ScreenHeader","HostMetricsAPI","useRequest","PaginatedTable","HeaderRow","HeaderCell","DataListToolbar","getQSConfig","parseQueryString","Card","PageSection","useLocation","useSelected","HostMetricsListItem","HostMetricsDeleteButton","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","QS_CONFIG","page","page_size","order_by","deleted","HostMetrics","location","_useState","i18n","_","_useState2","_slicedToArray","breadcrumbConfig","_useRequest","_asyncToGenerator","_regeneratorRuntime","mark","_callee","params","list","wrap","_callee$","_context","prev","next","search","read","sent","abrupt","count","data","results","stop","_useRequest$result","result","isLoading","error","readHostMetrics","request","_useSelected","selected","isAllSelected","handleSelect","selectAll","clearSelected","children","streamType","contentError","hasContentLoading","items","itemCount","pluralizedItemName","renderRow","item","index","isSelected","some","row","hostname","onSelect","rowIndex","id","qsConfig","toolbarSearchColumns","name","key","isDefault","toolbarSearchableKeys","toolbarRelatedSearchableKeys","renderToolbar","props","_objectSpread","advancedSearchDisabled","fillWidth","onSelectAll","additionalControls","onDelete","Promise","all","map","hostMetric","destroy","then","itemsToDelete","headerRow","sortKey","tooltip","_HostMetrics"],"sources":["/awx_devel/awx/ui/src/screens/HostMetrics/HostMetrics.js"],"sourcesContent":["import React, { useCallback, useEffect, useState } from 'react';\nimport { t } from '@lingui/macro';\nimport ScreenHeader from 'components/ScreenHeader/ScreenHeader';\nimport { HostMetricsAPI } from 'api';\nimport useRequest from 'hooks/useRequest';\nimport PaginatedTable, {\n  HeaderRow,\n  HeaderCell,\n} from 'components/PaginatedTable';\nimport DataListToolbar from 'components/DataListToolbar';\nimport { getQSConfig, parseQueryString } from 'util/qs';\nimport { Card, PageSection } from '@patternfly/react-core';\nimport { useLocation } from 'react-router-dom';\nimport useSelected from 'hooks/useSelected';\nimport HostMetricsListItem from './HostMetricsListItem';\nimport HostMetricsDeleteButton from './HostMetricsDeleteButton';\n\nconst QS_CONFIG = getQSConfig('host_metrics', {\n  page: 1,\n  page_size: 20,\n  order_by: 'hostname',\n  deleted: false,\n});\n\nfunction HostMetrics() {\n  const location = useLocation();\n\n  const [breadcrumbConfig] = useState({\n    '/host_metrics': t`Host Metrics`,\n  });\n  const {\n    result: { count, results },\n    isLoading,\n    error,\n    request: readHostMetrics,\n  } = useRequest(\n    useCallback(async () => {\n      const params = parseQueryString(QS_CONFIG, location.search);\n      const list = await HostMetricsAPI.read(params);\n      return {\n        count: list.data.count,\n        results: list.data.results,\n      };\n    }, [location]),\n    { results: [], count: 0 }\n  );\n\n  useEffect(() => {\n    readHostMetrics();\n  }, [readHostMetrics]);\n\n  const { selected, isAllSelected, handleSelect, selectAll, clearSelected } =\n    useSelected(results);\n\n  return (\n    <>\n      <ScreenHeader streamType=\"none\" breadcrumbConfig={breadcrumbConfig} />\n      <PageSection>\n        <Card>\n          <PaginatedTable\n            contentError={error}\n            hasContentLoading={isLoading}\n            items={results}\n            itemCount={count}\n            pluralizedItemName={t`Host Metrics`}\n            renderRow={(item, index) => (\n              <HostMetricsListItem\n                key={item.id}\n                item={item}\n                isSelected={selected.some(\n                  (row) => row.hostname === item.hostname\n                )}\n                onSelect={() => handleSelect(item)}\n                rowIndex={index}\n              />\n            )}\n            qsConfig={QS_CONFIG}\n            toolbarSearchColumns={[\n              {\n                name: t`Hostname`,\n                key: 'hostname__icontains',\n                isDefault: true,\n              },\n            ]}\n            toolbarSearchableKeys={[]}\n            toolbarRelatedSearchableKeys={[]}\n            renderToolbar={(props) => (\n              <DataListToolbar\n                {...props}\n                advancedSearchDisabled\n                fillWidth\n                isAllSelected={isAllSelected}\n                onSelectAll={selectAll}\n                additionalControls={[\n                  <HostMetricsDeleteButton\n                    key=\"delete\"\n                    onDelete={() =>\n                      Promise.all(\n                        selected.map((hostMetric) =>\n                          HostMetricsAPI.destroy(hostMetric.id)\n                        )\n                      ).then(() => {\n                        readHostMetrics();\n                        clearSelected();\n                      })\n                    }\n                    itemsToDelete={selected}\n                    pluralizedItemName={t`Host Metrics`}\n                  />,\n                ]}\n              />\n            )}\n            headerRow={\n              <HeaderRow qsConfig={QS_CONFIG}>\n                <HeaderCell sortKey=\"hostname\">{t`Hostname`}</HeaderCell>\n                <HeaderCell\n                  sortKey=\"first_automation\"\n                  tooltip={t`When was the host first automated`}\n                >\n                  {t`First automated`}\n                </HeaderCell>\n                <HeaderCell\n                  sortKey=\"last_automation\"\n                  tooltip={t`When was the host last automated`}\n                >\n                  {t`Last automated`}\n                </HeaderCell>\n                <HeaderCell\n                  sortKey=\"automated_counter\"\n                  tooltip={t`How many times was the host automated`}\n                >\n                  {t`Automation`}\n                </HeaderCell>\n                <HeaderCell\n                  sortKey=\"deleted_counter\"\n                  tooltip={t`How many times was the host deleted`}\n                >\n                  {t`Deleted`}\n                </HeaderCell>\n              </HeaderRow>\n            }\n          />\n        </Card>\n      </PageSection>\n    </>\n  );\n}\n\nexport { HostMetrics as _HostMetrics };\nexport default HostMetrics;\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}