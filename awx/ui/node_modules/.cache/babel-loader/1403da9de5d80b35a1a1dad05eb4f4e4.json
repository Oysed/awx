{"ast":null,"code":"import _asyncToGenerator from\"/awx_devel/awx/ui/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _regeneratorRuntime from\"/awx_devel/awx/ui/node_modules/@babel/runtime/regenerator/index.js\";import{i18n}from\"@lingui/core\";import React,{useEffect,useCallback}from'react';import{Link,Redirect,Route,Switch,useLocation,useParams}from'react-router-dom';import{CaretLeftIcon}from'@patternfly/react-icons';import{Card,PageSection}from'@patternfly/react-core';import RoutedTabs from'components/RoutedTabs';import ContentError from'components/ContentError';import{TokensAPI}from'api';import useRequest from'hooks/useRequest';import UserTokenDetail from'../UserTokenDetail';import{jsx as _jsx}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";function UserToken(_ref){var setBreadcrumb=_ref.setBreadcrumb,user=_ref.user;var location=useLocation();var _useParams=useParams(),id=_useParams.id,tokenId=_useParams.tokenId;var _useRequest=useRequest(useCallback(/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var response;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return TokensAPI.readDetail(tokenId);case 2:response=_context.sent;setBreadcrumb(user,response.data);return _context.abrupt(\"return\",{token:response.data});case 5:case\"end\":return _context.stop();}}},_callee);})),[setBreadcrumb,user,tokenId]),{token:null}),isLoading=_useRequest.isLoading,error=_useRequest.error,fetchToken=_useRequest.request,token=_useRequest.result.token;useEffect(function(){fetchToken();},[fetchToken]);var tabsArray=[{name:/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(CaretLeftIcon,{}),/*i18n*/i18n._(\"Back to Tokens\")]}),link:\"/users/\".concat(id,\"/tokens\"),id:99},{name:/*i18n*/i18n._(\"Details\"),link:\"/users/\".concat(id,\"/tokens/\").concat(tokenId,\"/details\"),id:0}];var showCardHeader=true;if(location.pathname.endsWith('edit')){showCardHeader=false;}if(!isLoading&&error){return/*#__PURE__*/_jsx(PageSection,{children:/*#__PURE__*/_jsx(Card,{children:/*#__PURE__*/_jsx(ContentError,{error:error,children:error.response.status===404&&/*#__PURE__*/_jsxs(\"span\",{children:[/*i18n*/i18n._(\"Token not found.\"),' ',/*#__PURE__*/_jsx(Link,{to:\"/users/:id/tokens\",children:/*i18n*/i18n._(\"View all tokens.\")})]})})})});}return/*#__PURE__*/_jsxs(_Fragment,{children:[showCardHeader&&/*#__PURE__*/_jsx(RoutedTabs,{tabsArray:tabsArray}),/*#__PURE__*/_jsxs(Switch,{children:[/*#__PURE__*/_jsx(Redirect,{from:\"/users/:id/tokens/:tokenId\",to:\"/users/:id/tokens/:tokenId/details\",exact:true}),token&&/*#__PURE__*/_jsx(Route,{path:\"/users/:id/tokens/:tokenId/details\",children:/*#__PURE__*/_jsx(UserTokenDetail,{token:token})}),/*#__PURE__*/_jsx(Route,{path:\"*\",children:!isLoading&&/*#__PURE__*/_jsx(ContentError,{isNotFound:true,children:id&&/*#__PURE__*/_jsx(Link,{to:\"/users/\".concat(id,\"/tokens\"),children:/*i18n*/i18n._(\"View Tokens\")})})},\"not-found\")]})]});}export default UserToken;","map":{"version":3,"names":["React","useEffect","useCallback","Link","Redirect","Route","Switch","useLocation","useParams","CaretLeftIcon","Card","PageSection","RoutedTabs","ContentError","TokensAPI","useRequest","UserTokenDetail","jsx","_jsx","Fragment","_Fragment","jsxs","_jsxs","UserToken","_ref","setBreadcrumb","user","location","_useParams","id","tokenId","_useRequest","_asyncToGenerator","_regeneratorRuntime","mark","_callee","response","wrap","_callee$","_context","prev","next","readDetail","sent","data","abrupt","token","stop","isLoading","error","fetchToken","request","result","tabsArray","name","children","i18n","_","link","concat","showCardHeader","pathname","endsWith","status","to","from","exact","path","isNotFound"],"sources":["/awx_devel/awx/ui/src/screens/User/UserToken/UserToken.js"],"sourcesContent":["import React, { useEffect, useCallback } from 'react';\n\nimport { t } from '@lingui/macro';\nimport {\n  Link,\n  Redirect,\n  Route,\n  Switch,\n  useLocation,\n  useParams,\n} from 'react-router-dom';\nimport { CaretLeftIcon } from '@patternfly/react-icons';\nimport { Card, PageSection } from '@patternfly/react-core';\nimport RoutedTabs from 'components/RoutedTabs';\nimport ContentError from 'components/ContentError';\nimport { TokensAPI } from 'api';\nimport useRequest from 'hooks/useRequest';\nimport UserTokenDetail from '../UserTokenDetail';\n\nfunction UserToken({ setBreadcrumb, user }) {\n  const location = useLocation();\n  const { id, tokenId } = useParams();\n  const {\n    isLoading,\n    error,\n    request: fetchToken,\n    result: { token },\n  } = useRequest(\n    useCallback(async () => {\n      const response = await TokensAPI.readDetail(tokenId);\n      setBreadcrumb(user, response.data);\n      return {\n        token: response.data,\n      };\n    }, [setBreadcrumb, user, tokenId]),\n    { token: null }\n  );\n  useEffect(() => {\n    fetchToken();\n  }, [fetchToken]);\n\n  const tabsArray = [\n    {\n      name: (\n        <>\n          <CaretLeftIcon />\n          {t`Back to Tokens`}\n        </>\n      ),\n      link: `/users/${id}/tokens`,\n      id: 99,\n    },\n    {\n      name: t`Details`,\n      link: `/users/${id}/tokens/${tokenId}/details`,\n      id: 0,\n    },\n  ];\n\n  let showCardHeader = true;\n\n  if (location.pathname.endsWith('edit')) {\n    showCardHeader = false;\n  }\n\n  if (!isLoading && error) {\n    return (\n      <PageSection>\n        <Card>\n          <ContentError error={error}>\n            {error.response.status === 404 && (\n              <span>\n                {t`Token not found.`}{' '}\n                <Link to=\"/users/:id/tokens\">{t`View all tokens.`}</Link>\n              </span>\n            )}\n          </ContentError>\n        </Card>\n      </PageSection>\n    );\n  }\n\n  return (\n    <>\n      {showCardHeader && <RoutedTabs tabsArray={tabsArray} />}\n      <Switch>\n        <Redirect\n          from=\"/users/:id/tokens/:tokenId\"\n          to=\"/users/:id/tokens/:tokenId/details\"\n          exact\n        />\n        {token && (\n          <Route path=\"/users/:id/tokens/:tokenId/details\">\n            <UserTokenDetail token={token} />\n          </Route>\n        )}\n        <Route key=\"not-found\" path=\"*\">\n          {!isLoading && (\n            <ContentError isNotFound>\n              {id && <Link to={`/users/${id}/tokens`}>{t`View Tokens`}</Link>}\n            </ContentError>\n          )}\n        </Route>\n      </Switch>\n    </>\n  );\n}\n\nexport default UserToken;\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}