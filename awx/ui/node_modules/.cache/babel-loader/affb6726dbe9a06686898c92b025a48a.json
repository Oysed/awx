{"ast":null,"code":"import _asyncToGenerator from\"/awx_devel/awx/ui/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _regeneratorRuntime from\"/awx_devel/awx/ui/node_modules/@babel/runtime/regenerator/index.js\";import{i18n}from\"@lingui/core\";import React,{useCallback}from'react';import{useHistory,useParams}from'react-router-dom';import AlertModal from'components/AlertModal';import{CardBody,CardActionsRow}from'components/Card';import DeleteButton from'components/DeleteButton';import{DetailList,Detail,UserDateDetail}from'components/DetailList';import ErrorDetail from'components/ErrorDetail';import{TokensAPI}from'api';import{formatDateString}from'util/dates';import useRequest,{useDismissableError}from'hooks/useRequest';import{toTitleCase}from'util/strings';import getHelptext from'../shared/User.helptext';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";function UserTokenDetail(_ref){var _summary_fields$appli,_summary_fields$appli2;var token=_ref.token;var helptext=getHelptext();var scope=token.scope,description=token.description,created=token.created,modified=token.modified,expires=token.expires,summary_fields=token.summary_fields;var history=useHistory();var _useParams=useParams(),id=_useParams.id,tokenId=_useParams.tokenId;var _useRequest=useRequest(useCallback(/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return TokensAPI.destroy(tokenId);case 2:history.push(\"/users/\".concat(id,\"/tokens\"));case 3:case\"end\":return _context.stop();}}},_callee);})),[tokenId,id,history])),deleteToken=_useRequest.request,isLoading=_useRequest.isLoading,deleteError=_useRequest.error;var _useDismissableError=useDismissableError(deleteError),error=_useDismissableError.error,dismissError=_useDismissableError.dismissError;return/*#__PURE__*/_jsxs(CardBody,{children:[/*#__PURE__*/_jsxs(DetailList,{children:[/*#__PURE__*/_jsx(Detail,{label:/*i18n*/i18n._(\"Application\"),value:summary_fields===null||summary_fields===void 0?void 0:(_summary_fields$appli=summary_fields.application)===null||_summary_fields$appli===void 0?void 0:_summary_fields$appli.name,dataCy:\"application-token-detail-name\",helpText:helptext.application}),/*#__PURE__*/_jsx(Detail,{label:/*i18n*/i18n._(\"Description\"),value:description,dataCy:\"application-token-detail-description\"}),/*#__PURE__*/_jsx(Detail,{label:/*i18n*/i18n._(\"Scope\"),value:toTitleCase(scope),dataCy:\"application-token-detail-scope\",helpText:helptext.scope}),/*#__PURE__*/_jsx(Detail,{label:/*i18n*/i18n._(\"Expires\"),value:formatDateString(expires),dataCy:\"application-token-detail-expires\"}),/*#__PURE__*/_jsx(UserDateDetail,{label:/*i18n*/i18n._(\"Created\"),date:created,user:summary_fields.user}),/*#__PURE__*/_jsx(UserDateDetail,{label:/*i18n*/i18n._(\"Last Modified\"),date:modified,user:summary_fields.user})]}),/*#__PURE__*/_jsx(CardActionsRow,{children:/*#__PURE__*/_jsx(DeleteButton,{name:(summary_fields===null||summary_fields===void 0?void 0:(_summary_fields$appli2=summary_fields.application)===null||_summary_fields$appli2===void 0?void 0:_summary_fields$appli2.name)||/*i18n*/i18n._(\"Personal Access Token\"),modalTitle:/*i18n*/i18n._(\"Delete User Token\"),onConfirm:deleteToken,isDisabled:isLoading,children:/*i18n*/i18n._(\"Delete\")})}),error&&/*#__PURE__*/_jsxs(AlertModal,{isOpen:error,variant:\"error\",title:/*i18n*/i18n._(\"Error!\"),onClose:dismissError,children:[/*i18n*/i18n._(\"Failed to user token.\"),/*#__PURE__*/_jsx(ErrorDetail,{error:error})]})]});}export default UserTokenDetail;","map":{"version":3,"names":["React","useCallback","useHistory","useParams","AlertModal","CardBody","CardActionsRow","DeleteButton","DetailList","Detail","UserDateDetail","ErrorDetail","TokensAPI","formatDateString","useRequest","useDismissableError","toTitleCase","getHelptext","jsx","_jsx","jsxs","_jsxs","UserTokenDetail","_ref","_summary_fields$appli","_summary_fields$appli2","token","helptext","scope","description","created","modified","expires","summary_fields","history","_useParams","id","tokenId","_useRequest","_asyncToGenerator","_regeneratorRuntime","mark","_callee","wrap","_callee$","_context","prev","next","destroy","push","concat","stop","deleteToken","request","isLoading","deleteError","error","_useDismissableError","dismissError","children","label","i18n","_","value","application","name","dataCy","helpText","date","user","modalTitle","onConfirm","isDisabled","isOpen","variant","title","onClose"],"sources":["/awx_devel/awx/ui/src/screens/User/UserTokenDetail/UserTokenDetail.js"],"sourcesContent":["import React, { useCallback } from 'react';\nimport { useHistory, useParams } from 'react-router-dom';\n\nimport { t } from '@lingui/macro';\n\nimport AlertModal from 'components/AlertModal';\nimport { CardBody, CardActionsRow } from 'components/Card';\nimport DeleteButton from 'components/DeleteButton';\nimport { DetailList, Detail, UserDateDetail } from 'components/DetailList';\nimport ErrorDetail from 'components/ErrorDetail';\nimport { TokensAPI } from 'api';\nimport { formatDateString } from 'util/dates';\nimport useRequest, { useDismissableError } from 'hooks/useRequest';\nimport { toTitleCase } from 'util/strings';\nimport getHelptext from '../shared/User.helptext';\n\nfunction UserTokenDetail({ token }) {\n  const helptext = getHelptext();\n  const { scope, description, created, modified, expires, summary_fields } =\n    token;\n  const history = useHistory();\n  const { id, tokenId } = useParams();\n  const {\n    request: deleteToken,\n    isLoading,\n    error: deleteError,\n  } = useRequest(\n    useCallback(async () => {\n      await TokensAPI.destroy(tokenId);\n      history.push(`/users/${id}/tokens`);\n    }, [tokenId, id, history])\n  );\n  const { error, dismissError } = useDismissableError(deleteError);\n\n  return (\n    <CardBody>\n      <DetailList>\n        <Detail\n          label={t`Application`}\n          value={summary_fields?.application?.name}\n          dataCy=\"application-token-detail-name\"\n          helpText={helptext.application}\n        />\n        <Detail\n          label={t`Description`}\n          value={description}\n          dataCy=\"application-token-detail-description\"\n        />\n        <Detail\n          label={t`Scope`}\n          value={toTitleCase(scope)}\n          dataCy=\"application-token-detail-scope\"\n          helpText={helptext.scope}\n        />\n        <Detail\n          label={t`Expires`}\n          value={formatDateString(expires)}\n          dataCy=\"application-token-detail-expires\"\n        />\n        <UserDateDetail\n          label={t`Created`}\n          date={created}\n          user={summary_fields.user}\n        />\n        <UserDateDetail\n          label={t`Last Modified`}\n          date={modified}\n          user={summary_fields.user}\n        />\n      </DetailList>\n      <CardActionsRow>\n        <DeleteButton\n          name={summary_fields?.application?.name || t`Personal Access Token`}\n          modalTitle={t`Delete User Token`}\n          onConfirm={deleteToken}\n          isDisabled={isLoading}\n        >\n          {t`Delete`}\n        </DeleteButton>\n      </CardActionsRow>\n      {error && (\n        <AlertModal\n          isOpen={error}\n          variant=\"error\"\n          title={t`Error!`}\n          onClose={dismissError}\n        >\n          {t`Failed to user token.`}\n          <ErrorDetail error={error} />\n        </AlertModal>\n      )}\n    </CardBody>\n  );\n}\n\nexport default UserTokenDetail;\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}