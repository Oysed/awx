{"ast":null,"code":"import _asyncToGenerator from\"/awx_devel/awx/ui/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"/awx_devel/awx/ui/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import _styled from\"styled-components\";import _regeneratorRuntime from\"/awx_devel/awx/ui/node_modules/@babel/runtime/regenerator/index.js\";import{i18n}from\"@lingui/core\";import React,{useState}from'react';import{Link,useHistory}from'react-router-dom';import{Button}from'@patternfly/react-core';import{Host}from'types';import{CardBody,CardActionsRow}from'components/Card';import AlertModal from'components/AlertModal';import ErrorDetail from'components/ErrorDetail';import{DetailList,Detail,UserDateDetail}from'components/DetailList';import{VariablesDetail}from'components/CodeEditor';import Sparkline from'components/Sparkline';import DeleteButton from'components/DeleteButton';import{HostsAPI}from'api';import HostToggle from'components/HostToggle';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var _StyledHostToggle=_styled(HostToggle).withConfig({displayName:\"HostDetail___StyledHostToggle\",componentId:\"sc-1g4ujma-0\"})([\"padding-bottom:40px\"]);function HostDetail(_ref){var host=_ref.host;var created=host.created,description=host.description,id=host.id,modified=host.modified,name=host.name,variables=host.variables,_host$summary_fields=host.summary_fields,inventory=_host$summary_fields.inventory,recentJobs=_host$summary_fields.recent_jobs,created_by=_host$summary_fields.created_by,modified_by=_host$summary_fields.modified_by,user_capabilities=_host$summary_fields.user_capabilities;var _useState=useState(false),_useState2=_slicedToArray(_useState,2),isLoading=_useState2[0],setIsloading=_useState2[1];var _useState3=useState(false),_useState4=_slicedToArray(_useState3,2),deletionError=_useState4[0],setDeletionError=_useState4[1];var history=useHistory();var handleHostDelete=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:setIsloading(true);_context.prev=1;_context.next=4;return HostsAPI.destroy(id);case 4:history.push('/hosts');_context.next=10;break;case 7:_context.prev=7;_context.t0=_context[\"catch\"](1);setDeletionError(_context.t0);case 10:_context.prev=10;setIsloading(false);return _context.finish(10);case 13:case\"end\":return _context.stop();}}},_callee,null,[[1,7,10,13]]);}));return function handleHostDelete(){return _ref2.apply(this,arguments);};}();if(!isLoading&&deletionError){return/*#__PURE__*/_jsxs(AlertModal,{isOpen:deletionError,variant:\"error\",title:/*i18n*/i18n._(\"Error!\"),onClose:function onClose(){return setDeletionError(false);},children:[/*i18n*/i18n._(\"Failed to delete {name}.\",{name:name}),/*#__PURE__*/_jsx(ErrorDetail,{error:deletionError})]});}return/*#__PURE__*/_jsxs(CardBody,{children:[/*#__PURE__*/_jsx(_StyledHostToggle,{host:host}),/*#__PURE__*/_jsxs(DetailList,{gutter:\"sm\",children:[/*#__PURE__*/_jsx(Detail,{label:/*i18n*/i18n._(\"Name\"),value:name,dataCy:\"host-name\"}),/*#__PURE__*/_jsx(Detail,{label:/*i18n*/i18n._(\"Activity\"),value:/*#__PURE__*/_jsx(Sparkline,{jobs:recentJobs}),isEmpty:(recentJobs===null||recentJobs===void 0?void 0:recentJobs.length)===0}),/*#__PURE__*/_jsx(Detail,{label:/*i18n*/i18n._(\"Description\"),value:description}),/*#__PURE__*/_jsx(Detail,{label:/*i18n*/i18n._(\"Inventory\"),dataCy:\"host-inventory\",helpText:/*i18n*/i18n._(\"The inventory that this host belongs to.\"),value:/*#__PURE__*/_jsx(Link,{to:\"/inventories/inventory/\".concat(inventory.id,\"/details\"),children:inventory.name})}),/*#__PURE__*/_jsx(UserDateDetail,{date:created,label:/*i18n*/i18n._(\"Created\"),user:created_by}),/*#__PURE__*/_jsx(UserDateDetail,{date:modified,label:/*i18n*/i18n._(\"Last Modified\"),user:modified_by}),/*#__PURE__*/_jsx(VariablesDetail,{label:/*i18n*/i18n._(\"Variables\"),rows:4,value:variables,name:\"variables\",dataCy:\"host-detail-variables\"})]}),/*#__PURE__*/_jsxs(CardActionsRow,{children:[(user_capabilities===null||user_capabilities===void 0?void 0:user_capabilities.edit)&&/*#__PURE__*/_jsx(Button,{ouiaId:\"host-detail-edit-button\",\"aria-label\":/*i18n*/i18n._(\"edit\"),component:Link,to:\"/hosts/\".concat(id,\"/edit\"),children:/*i18n*/i18n._(\"Edit\")}),(user_capabilities===null||user_capabilities===void 0?void 0:user_capabilities.delete)&&/*#__PURE__*/_jsx(DeleteButton,{onConfirm:function onConfirm(){return handleHostDelete();},modalTitle:/*i18n*/i18n._(\"Delete Host\"),name:name})]}),deletionError&&/*#__PURE__*/_jsxs(AlertModal,{isOpen:deletionError,variant:\"error\",title:/*i18n*/i18n._(\"Error!\"),onClose:function onClose(){return setDeletionError(null);},children:[/*i18n*/i18n._(\"Failed to delete host.\"),/*#__PURE__*/_jsx(ErrorDetail,{error:deletionError})]})]});}export default HostDetail;","map":{"version":3,"names":["React","useState","Link","useHistory","Button","Host","CardBody","CardActionsRow","AlertModal","ErrorDetail","DetailList","Detail","UserDateDetail","VariablesDetail","Sparkline","DeleteButton","HostsAPI","HostToggle","jsx","_jsx","jsxs","_jsxs","_StyledHostToggle","_styled","withConfig","displayName","componentId","HostDetail","_ref","host","created","description","id","modified","name","variables","_host$summary_fields","summary_fields","inventory","recentJobs","recent_jobs","created_by","modified_by","user_capabilities","_useState","_useState2","_slicedToArray","isLoading","setIsloading","_useState3","_useState4","deletionError","setDeletionError","history","handleHostDelete","_ref2","_asyncToGenerator","_regeneratorRuntime","mark","_callee","wrap","_callee$","_context","prev","next","destroy","push","t0","finish","stop","apply","arguments","isOpen","variant","title","i18n","_","onClose","children","error","gutter","label","value","dataCy","jobs","isEmpty","length","helpText","to","concat","date","user","rows","edit","ouiaId","component","delete","onConfirm","modalTitle"],"sources":["/awx_devel/awx/ui/src/screens/Host/HostDetail/HostDetail.js"],"sourcesContent":["import 'styled-components/macro';\nimport React, { useState } from 'react';\nimport { Link, useHistory } from 'react-router-dom';\n\nimport { t } from '@lingui/macro';\nimport { Button } from '@patternfly/react-core';\nimport { Host } from 'types';\nimport { CardBody, CardActionsRow } from 'components/Card';\nimport AlertModal from 'components/AlertModal';\nimport ErrorDetail from 'components/ErrorDetail';\nimport { DetailList, Detail, UserDateDetail } from 'components/DetailList';\nimport { VariablesDetail } from 'components/CodeEditor';\nimport Sparkline from 'components/Sparkline';\nimport DeleteButton from 'components/DeleteButton';\nimport { HostsAPI } from 'api';\nimport HostToggle from 'components/HostToggle';\n\nfunction HostDetail({ host }) {\n  const {\n    created,\n    description,\n    id,\n    modified,\n    name,\n    variables,\n    summary_fields: {\n      inventory,\n      recent_jobs: recentJobs,\n      created_by,\n      modified_by,\n      user_capabilities,\n    },\n  } = host;\n\n  const [isLoading, setIsloading] = useState(false);\n  const [deletionError, setDeletionError] = useState(false);\n  const history = useHistory();\n\n  const handleHostDelete = async () => {\n    setIsloading(true);\n    try {\n      await HostsAPI.destroy(id);\n      history.push('/hosts');\n    } catch (err) {\n      setDeletionError(err);\n    } finally {\n      setIsloading(false);\n    }\n  };\n\n  if (!isLoading && deletionError) {\n    return (\n      <AlertModal\n        isOpen={deletionError}\n        variant=\"error\"\n        title={t`Error!`}\n        onClose={() => setDeletionError(false)}\n      >\n        {t`Failed to delete ${name}.`}\n        <ErrorDetail error={deletionError} />\n      </AlertModal>\n    );\n  }\n\n  return (\n    <CardBody>\n      <HostToggle host={host} css=\"padding-bottom: 40px\" />\n      <DetailList gutter=\"sm\">\n        <Detail label={t`Name`} value={name} dataCy=\"host-name\" />\n        <Detail\n          label={t`Activity`}\n          value={<Sparkline jobs={recentJobs} />}\n          isEmpty={recentJobs?.length === 0}\n        />\n        <Detail label={t`Description`} value={description} />\n        <Detail\n          label={t`Inventory`}\n          dataCy=\"host-inventory\"\n          helpText={t`The inventory that this host belongs to.`}\n          value={\n            <Link to={`/inventories/inventory/${inventory.id}/details`}>\n              {inventory.name}\n            </Link>\n          }\n        />\n        <UserDateDetail date={created} label={t`Created`} user={created_by} />\n        <UserDateDetail\n          date={modified}\n          label={t`Last Modified`}\n          user={modified_by}\n        />\n        <VariablesDetail\n          label={t`Variables`}\n          rows={4}\n          value={variables}\n          name=\"variables\"\n          dataCy=\"host-detail-variables\"\n        />\n      </DetailList>\n      <CardActionsRow>\n        {user_capabilities?.edit && (\n          <Button\n            ouiaId=\"host-detail-edit-button\"\n            aria-label={t`edit`}\n            component={Link}\n            to={`/hosts/${id}/edit`}\n          >\n            {t`Edit`}\n          </Button>\n        )}\n        {user_capabilities?.delete && (\n          <DeleteButton\n            onConfirm={() => handleHostDelete()}\n            modalTitle={t`Delete Host`}\n            name={name}\n          />\n        )}\n      </CardActionsRow>\n      {deletionError && (\n        <AlertModal\n          isOpen={deletionError}\n          variant=\"error\"\n          title={t`Error!`}\n          onClose={() => setDeletionError(null)}\n        >\n          {t`Failed to delete host.`}\n          <ErrorDetail error={deletionError} />\n        </AlertModal>\n      )}\n    </CardBody>\n  );\n}\n\nHostDetail.propTypes = {\n  host: Host.isRequired,\n};\n\nexport default HostDetail;\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}