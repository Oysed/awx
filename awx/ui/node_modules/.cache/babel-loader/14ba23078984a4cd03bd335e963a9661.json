{"ast":null,"code":"import _toConsumableArray from\"/awx_devel/awx/ui/node_modules/@babel/runtime/helpers/esm/toConsumableArray.js\";import _objectSpread from\"/awx_devel/awx/ui/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";export default function reducer(state,action){switch(action.type){case'SELECT_ITEM':return selectItem(state,action.item);case'DESELECT_ITEM':return deselectItem(state,action.item);case'TOGGLE_MODAL':return toggleModal(state);case'CLOSE_MODAL':return closeModal(state);case'SET_MULTIPLE':return _objectSpread(_objectSpread({},state),{},{multiple:action.value});case'SET_VALUE':return _objectSpread(_objectSpread({},state),{},{value:action.value});case'SET_SELECTED_ITEMS':return _objectSpread(_objectSpread({},state),{},{selectedItems:action.selectedItems});default:throw new Error(\"Unrecognized action type: \".concat(action.type));}}function selectItem(state,item){var selectedItems=state.selectedItems,multiple=state.multiple;if(!multiple){return _objectSpread(_objectSpread({},state),{},{selectedItems:[item]});}var index=selectedItems.findIndex(function(i){return i.id===item.id;});if(index>-1){return state;}return _objectSpread(_objectSpread({},state),{},{selectedItems:[].concat(_toConsumableArray(selectedItems),[item])});}function deselectItem(state,item){return _objectSpread(_objectSpread({},state),{},{selectedItems:state.selectedItems.filter(function(i){return i.id!==item.id;})});}function toggleModal(state){var isModalOpen=state.isModalOpen,value=state.value,multiple=state.multiple;if(isModalOpen){return closeModal(state);}var selectedItems=[];if(multiple){selectedItems=_toConsumableArray(value);}else if(value){selectedItems.push(value);}return _objectSpread(_objectSpread({},state),{},{isModalOpen:!isModalOpen,selectedItems:selectedItems});}function closeModal(state){return _objectSpread(_objectSpread({},state),{},{isModalOpen:false});}export function initReducer(_ref){var value=_ref.value,_ref$multiple=_ref.multiple,multiple=_ref$multiple===void 0?false:_ref$multiple,_ref$required=_ref.required,required=_ref$required===void 0?false:_ref$required;assertCorrectValueType(value,multiple);var selectedItems=[];if(value){selectedItems=multiple?_toConsumableArray(value):[value];}return{selectedItems:selectedItems,value:value,multiple:multiple,isModalOpen:false,required:required};}function assertCorrectValueType(value,multiple){if(!multiple&&Array.isArray(value)){throw new Error('Lookup value must not be an array unless `multiple` is set');}if(multiple&&!Array.isArray(value)){throw new Error('Lookup value must be an array if `multiple` is set');}}","map":{"version":3,"names":["reducer","state","action","type","selectItem","item","deselectItem","toggleModal","closeModal","_objectSpread","multiple","value","selectedItems","Error","concat","index","findIndex","i","id","_toConsumableArray","filter","isModalOpen","push","initReducer","_ref","_ref$multiple","_ref$required","required","assertCorrectValueType","Array","isArray"],"sources":["/awx_devel/awx/ui/src/components/Lookup/shared/reducer.js"],"sourcesContent":["export default function reducer(state, action) {\n  switch (action.type) {\n    case 'SELECT_ITEM':\n      return selectItem(state, action.item);\n    case 'DESELECT_ITEM':\n      return deselectItem(state, action.item);\n    case 'TOGGLE_MODAL':\n      return toggleModal(state);\n    case 'CLOSE_MODAL':\n      return closeModal(state);\n    case 'SET_MULTIPLE':\n      return { ...state, multiple: action.value };\n    case 'SET_VALUE':\n      return { ...state, value: action.value };\n    case 'SET_SELECTED_ITEMS':\n      return { ...state, selectedItems: action.selectedItems };\n    default:\n      throw new Error(`Unrecognized action type: ${action.type}`);\n  }\n}\n\nfunction selectItem(state, item) {\n  const { selectedItems, multiple } = state;\n  if (!multiple) {\n    return {\n      ...state,\n      selectedItems: [item],\n    };\n  }\n  const index = selectedItems.findIndex((i) => i.id === item.id);\n  if (index > -1) {\n    return state;\n  }\n  return {\n    ...state,\n    selectedItems: [...selectedItems, item],\n  };\n}\n\nfunction deselectItem(state, item) {\n  return {\n    ...state,\n    selectedItems: state.selectedItems.filter((i) => i.id !== item.id),\n  };\n}\n\nfunction toggleModal(state) {\n  const { isModalOpen, value, multiple } = state;\n  if (isModalOpen) {\n    return closeModal(state);\n  }\n  let selectedItems = [];\n  if (multiple) {\n    selectedItems = [...value];\n  } else if (value) {\n    selectedItems.push(value);\n  }\n  return {\n    ...state,\n    isModalOpen: !isModalOpen,\n    selectedItems,\n  };\n}\n\nfunction closeModal(state) {\n  return {\n    ...state,\n    isModalOpen: false,\n  };\n}\n\nexport function initReducer({ value, multiple = false, required = false }) {\n  assertCorrectValueType(value, multiple);\n  let selectedItems = [];\n  if (value) {\n    selectedItems = multiple ? [...value] : [value];\n  }\n  return {\n    selectedItems,\n    value,\n    multiple,\n    isModalOpen: false,\n    required,\n  };\n}\n\nfunction assertCorrectValueType(value, multiple) {\n  if (!multiple && Array.isArray(value)) {\n    throw new Error(\n      'Lookup value must not be an array unless `multiple` is set'\n    );\n  }\n  if (multiple && !Array.isArray(value)) {\n    throw new Error('Lookup value must be an array if `multiple` is set');\n  }\n}\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}