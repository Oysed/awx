{"ast":null,"code":"import _asyncToGenerator from\"/awx_devel/awx/ui/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"/awx_devel/awx/ui/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import _taggedTemplateLiteral from\"/awx_devel/awx/ui/node_modules/@babel/runtime/helpers/esm/taggedTemplateLiteral.js\";var _templateObject,_templateObject2;import _regeneratorRuntime from\"/awx_devel/awx/ui/node_modules/@babel/runtime/regenerator/index.js\";import{i18n}from\"@lingui/core\";import React,{useState}from'react';import styled from'styled-components';import{Button,Badge,Alert,Tooltip}from'@patternfly/react-core';import{getRelatedResourceDeleteCounts}from'util/getRelatedResourceDeleteDetails';import AlertModal from'../AlertModal';import ErrorDetail from'../ErrorDetail';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";var WarningMessage=styled(Alert)(_templateObject||(_templateObject=_taggedTemplateLiteral([\"\\n  margin-top: 10px;\\n\"])));var Label=styled.span(_templateObject2||(_templateObject2=_taggedTemplateLiteral([\"\\n  && {\\n    margin-right: 10px;\\n  }\\n\"])));function DeleteButton(_ref){var onConfirm=_ref.onConfirm,modalTitle=_ref.modalTitle,name=_ref.name,variant=_ref.variant,children=_ref.children,isDisabled=_ref.isDisabled,ouiaId=_ref.ouiaId,deleteMessage=_ref.deleteMessage,deleteDetailsRequests=_ref.deleteDetailsRequests,disabledTooltip=_ref.disabledTooltip;var _useState=useState(false),_useState2=_slicedToArray(_useState,2),isOpen=_useState2[0],setIsOpen=_useState2[1];var _useState3=useState(),_useState4=_slicedToArray(_useState3,2),deleteMessageError=_useState4[0],setDeleteMessageError=_useState4[1];var _useState5=useState({}),_useState6=_slicedToArray(_useState5,2),deleteDetails=_useState6[0],setDeleteDetails=_useState6[1];var _useState7=useState(false),_useState8=_slicedToArray(_useState7,2),isLoading=_useState8[0],setIsLoading=_useState8[1];var toggleModal=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(isModalOpen){var _yield$getRelatedReso,results,error;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:setIsLoading(true);if(!(deleteDetailsRequests!==null&&deleteDetailsRequests!==void 0&&deleteDetailsRequests.length&&isModalOpen)){_context.next=8;break;}_context.next=4;return getRelatedResourceDeleteCounts(deleteDetailsRequests);case 4:_yield$getRelatedReso=_context.sent;results=_yield$getRelatedReso.results;error=_yield$getRelatedReso.error;if(error){setDeleteMessageError(error);}else{setDeleteDetails(results);}case 8:setIsLoading(false);setIsOpen(isModalOpen);case 10:case\"end\":return _context.stop();}}},_callee);}));return function toggleModal(_x){return _ref2.apply(this,arguments);};}();if(deleteMessageError){return/*#__PURE__*/_jsx(AlertModal,{isOpen:deleteMessageError,title:/*i18n*/i18n._(\"Error!\"),onClose:function onClose(){toggleModal(false);setDeleteMessageError();},children:/*#__PURE__*/_jsx(ErrorDetail,{error:deleteMessageError})});}return/*#__PURE__*/_jsxs(_Fragment,{children:[disabledTooltip?/*#__PURE__*/_jsx(Tooltip,{content:disabledTooltip,position:\"top\",children:/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsx(Button,{isLoading:isLoading,spinnerAriaValueText:isLoading?'Loading':undefined,variant:variant||'secondary',\"aria-label\":/*i18n*/i18n._(\"Delete\"),isDisabled:isDisabled,onClick:function onClick(){return toggleModal(true);},ouiaId:ouiaId,children:children||/*i18n*/i18n._(\"Delete\")})})}):/*#__PURE__*/_jsx(Button,{ouiaId:ouiaId,isLoading:isLoading,spinnerAriaValueText:isLoading?'Loading':undefined,variant:variant||'secondary',\"aria-label\":/*i18n*/i18n._(\"Delete\"),isDisabled:isDisabled,onClick:function onClick(){return toggleModal(true);},children:children||/*i18n*/i18n._(\"Delete\")}),/*#__PURE__*/_jsxs(AlertModal,{isOpen:isOpen,title:modalTitle,variant:\"danger\",onClose:function onClose(){return toggleModal(false);},actions:[/*#__PURE__*/_jsx(Button,{ouiaId:\"delete-modal-confirm\",variant:\"danger\",\"aria-label\":/*i18n*/i18n._(\"Confirm Delete\"),isDisabled:isDisabled,onClick:function onClick(){onConfirm();toggleModal(false);},children:/*i18n*/i18n._(\"Delete\")},\"delete\"),/*#__PURE__*/_jsx(Button,{ouiaId:\"delete-modal-cancel\",variant:\"link\",\"aria-label\":/*i18n*/i18n._(\"Cancel\"),onClick:function onClick(){return toggleModal(false);},children:/*i18n*/i18n._(\"Cancel\")},\"cancel\")],children:[/*i18n*/i18n._(\"Are you sure you want to delete:\"),/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsx(\"strong\",{children:name}),Object.values(deleteDetails).length>0&&/*#__PURE__*/_jsx(WarningMessage,{variant:\"warning\",isInline:true,title:/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"div\",{\"aria-label\":deleteMessage,children:deleteMessage}),/*#__PURE__*/_jsx(\"br\",{}),Object.entries(deleteDetails).map(function(_ref3){var _ref4=_slicedToArray(_ref3,2),key=_ref4[0],value=_ref4[1];return/*#__PURE__*/_jsxs(\"div\",{\"aria-label\":\"\".concat(key,\": \").concat(value),children:[/*#__PURE__*/_jsx(Label,{children:key}),\" \",/*#__PURE__*/_jsx(Badge,{children:value})]},key);})]})})]})]});}DeleteButton.defaultProps={ouiaId:null};export default DeleteButton;","map":{"version":3,"names":["React","useState","styled","Button","Badge","Alert","Tooltip","getRelatedResourceDeleteCounts","AlertModal","ErrorDetail","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","WarningMessage","_templateObject","_taggedTemplateLiteral","Label","span","_templateObject2","DeleteButton","_ref","onConfirm","modalTitle","name","variant","children","isDisabled","ouiaId","deleteMessage","deleteDetailsRequests","disabledTooltip","_useState","_useState2","_slicedToArray","isOpen","setIsOpen","_useState3","_useState4","deleteMessageError","setDeleteMessageError","_useState5","_useState6","deleteDetails","setDeleteDetails","_useState7","_useState8","isLoading","setIsLoading","toggleModal","_ref2","_asyncToGenerator","_regeneratorRuntime","mark","_callee","isModalOpen","_yield$getRelatedReso","results","error","wrap","_callee$","_context","prev","next","length","sent","stop","_x","apply","arguments","title","i18n","_","onClose","content","position","spinnerAriaValueText","undefined","onClick","actions","Object","values","isInline","entries","map","_ref3","_ref4","key","value","concat","defaultProps"],"sources":["/awx_devel/awx/ui/src/components/DeleteButton/DeleteButton.js"],"sourcesContent":["import React, { useState } from 'react';\nimport PropTypes from 'prop-types';\n\nimport { t } from '@lingui/macro';\nimport styled from 'styled-components';\nimport { Button, Badge, Alert, Tooltip } from '@patternfly/react-core';\nimport { getRelatedResourceDeleteCounts } from 'util/getRelatedResourceDeleteDetails';\nimport AlertModal from '../AlertModal';\nimport ErrorDetail from '../ErrorDetail';\n\nconst WarningMessage = styled(Alert)`\n  margin-top: 10px;\n`;\nconst Label = styled.span`\n  && {\n    margin-right: 10px;\n  }\n`;\nfunction DeleteButton({\n  onConfirm,\n  modalTitle,\n  name,\n  variant,\n  children,\n  isDisabled,\n  ouiaId,\n  deleteMessage,\n  deleteDetailsRequests,\n  disabledTooltip,\n}) {\n  const [isOpen, setIsOpen] = useState(false);\n  const [deleteMessageError, setDeleteMessageError] = useState();\n  const [deleteDetails, setDeleteDetails] = useState({});\n  const [isLoading, setIsLoading] = useState(false);\n\n  const toggleModal = async (isModalOpen) => {\n    setIsLoading(true);\n    if (deleteDetailsRequests?.length && isModalOpen) {\n      const { results, error } = await getRelatedResourceDeleteCounts(\n        deleteDetailsRequests\n      );\n      if (error) {\n        setDeleteMessageError(error);\n      } else {\n        setDeleteDetails(results);\n      }\n    }\n    setIsLoading(false);\n    setIsOpen(isModalOpen);\n  };\n\n  if (deleteMessageError) {\n    return (\n      <AlertModal\n        isOpen={deleteMessageError}\n        title={t`Error!`}\n        onClose={() => {\n          toggleModal(false);\n          setDeleteMessageError();\n        }}\n      >\n        <ErrorDetail error={deleteMessageError} />\n      </AlertModal>\n    );\n  }\n  return (\n    <>\n      {disabledTooltip ? (\n        <Tooltip content={disabledTooltip} position=\"top\">\n          <div>\n            <Button\n              isLoading={isLoading}\n              spinnerAriaValueText={isLoading ? 'Loading' : undefined}\n              variant={variant || 'secondary'}\n              aria-label={t`Delete`}\n              isDisabled={isDisabled}\n              onClick={() => toggleModal(true)}\n              ouiaId={ouiaId}\n            >\n              {children || t`Delete`}\n            </Button>\n          </div>\n        </Tooltip>\n      ) : (\n        <Button\n          ouiaId={ouiaId}\n          isLoading={isLoading}\n          spinnerAriaValueText={isLoading ? 'Loading' : undefined}\n          variant={variant || 'secondary'}\n          aria-label={t`Delete`}\n          isDisabled={isDisabled}\n          onClick={() => toggleModal(true)}\n        >\n          {children || t`Delete`}\n        </Button>\n      )}\n      <AlertModal\n        isOpen={isOpen}\n        title={modalTitle}\n        variant=\"danger\"\n        onClose={() => toggleModal(false)}\n        actions={[\n          <Button\n            ouiaId=\"delete-modal-confirm\"\n            key=\"delete\"\n            variant=\"danger\"\n            aria-label={t`Confirm Delete`}\n            isDisabled={isDisabled}\n            onClick={() => {\n              onConfirm();\n              toggleModal(false);\n            }}\n          >\n            {t`Delete`}\n          </Button>,\n          <Button\n            ouiaId=\"delete-modal-cancel\"\n            key=\"cancel\"\n            variant=\"link\"\n            aria-label={t`Cancel`}\n            onClick={() => toggleModal(false)}\n          >\n            {t`Cancel`}\n          </Button>,\n        ]}\n      >\n        {t`Are you sure you want to delete:`}\n        <br />\n        <strong>{name}</strong>\n        {Object.values(deleteDetails).length > 0 && (\n          <WarningMessage\n            variant=\"warning\"\n            isInline\n            title={\n              <div>\n                <div aria-label={deleteMessage}>{deleteMessage}</div>\n                <br />\n                {Object.entries(deleteDetails).map(([key, value]) => (\n                  <div aria-label={`${key}: ${value}`} key={key}>\n                    <Label>{key}</Label> <Badge>{value}</Badge>\n                  </div>\n                ))}\n              </div>\n            }\n          />\n        )}\n      </AlertModal>\n    </>\n  );\n}\n\nDeleteButton.propTypes = {\n  ouiaId: PropTypes.string,\n};\n\nDeleteButton.defaultProps = {\n  ouiaId: null,\n};\n\nexport default DeleteButton;\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}