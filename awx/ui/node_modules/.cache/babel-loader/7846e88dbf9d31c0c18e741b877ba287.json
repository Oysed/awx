{"ast":null,"code":"import _objectSpread from\"/awx_devel/awx/ui/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import _asyncToGenerator from\"/awx_devel/awx/ui/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"/awx_devel/awx/ui/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import _regeneratorRuntime from\"/awx_devel/awx/ui/node_modules/@babel/runtime/regenerator/index.js\";import{i18n}from\"@lingui/core\";import React,{useState}from'react';import{ExpandableSection,Wizard}from'@patternfly/react-core';import{useFormikContext}from'formik';import{useDismissableError}from'hooks/useRequest';import AlertModal from'../../AlertModal';import ContentError from'../../ContentError';import ContentLoading from'../../ContentLoading';import useSchedulePromptSteps from'./useSchedulePromptSteps';import{jsx as _jsx}from\"react/jsx-runtime\";function SchedulePromptableFields(_ref){var schedule=_ref.schedule,surveyConfig=_ref.surveyConfig,launchConfig=_ref.launchConfig,onCloseWizard=_ref.onCloseWizard,onSave=_ref.onSave,credentials=_ref.credentials,resource=_ref.resource,resourceDefaultCredentials=_ref.resourceDefaultCredentials,labels=_ref.labels,instanceGroups=_ref.instanceGroups;var _useFormikContext=useFormikContext(),setFieldTouched=_useFormikContext.setFieldTouched,values=_useFormikContext.values,initialValues=_useFormikContext.initialValues,resetForm=_useFormikContext.resetForm;var _useSchedulePromptSte=useSchedulePromptSteps(surveyConfig,launchConfig,schedule,resource,credentials,resourceDefaultCredentials,labels,instanceGroups),steps=_useSchedulePromptSte.steps,visitStep=_useSchedulePromptSte.visitStep,visitAllSteps=_useSchedulePromptSte.visitAllSteps,validateStep=_useSchedulePromptSte.validateStep,contentError=_useSchedulePromptSte.contentError,isReady=_useSchedulePromptSte.isReady;var _useState=useState(false),_useState2=_slicedToArray(_useState,2),showDescription=_useState2[0],setShowDescription=_useState2[1];var _useDismissableError=useDismissableError(contentError),error=_useDismissableError.error,dismissError=_useDismissableError.dismissError;var cancelPromptableValues=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:resetForm({values:_objectSpread(_objectSpread({},initialValues),{},{description:values.description,frequency:values.frequency,name:values.name,startDateTime:values.startDateTime,timezone:values.timezone})});onCloseWizard();case 2:case\"end\":return _context.stop();}}},_callee);}));return function cancelPromptableValues(){return _ref2.apply(this,arguments);};}();if(error){return/*#__PURE__*/_jsx(AlertModal,{isOpen:error,variant:\"error\",title:/*i18n*/i18n._(\"Error!\"),onClose:function onClose(){dismissError();onCloseWizard();},children:/*#__PURE__*/_jsx(ContentError,{error:error})});}return/*#__PURE__*/_jsx(Wizard,{isOpen:true,onClose:cancelPromptableValues,onSave:onSave,onBack:/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(nextStep){return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:validateStep(nextStep.id);case 1:case\"end\":return _context2.stop();}}},_callee2);}));return function(_x){return _ref3.apply(this,arguments);};}(),onNext:/*#__PURE__*/function(){var _ref4=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(nextStep,prevStep){return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:if(nextStep.id==='preview'){visitAllSteps(setFieldTouched);}else{visitStep(prevStep.prevId,setFieldTouched);validateStep(nextStep.id);}case 1:case\"end\":return _context3.stop();}}},_callee3);}));return function(_x2,_x3){return _ref4.apply(this,arguments);};}(),onGoToStep:/*#__PURE__*/function(){var _ref5=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee4(nextStep,prevStep){return _regeneratorRuntime.wrap(function _callee4$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:if(nextStep.id==='preview'){visitAllSteps(setFieldTouched);}else{visitStep(prevStep.prevId,setFieldTouched);validateStep(nextStep.id);}case 1:case\"end\":return _context4.stop();}}},_callee4);}));return function(_x4,_x5){return _ref5.apply(this,arguments);};}(),title:/*i18n*/i18n._(\"Prompt | {0}\",{0:resource.name}),description:resource.description.length>512?/*#__PURE__*/_jsx(ExpandableSection,{toggleText:showDescription?/*i18n*/i18n._(\"Hide description\"):/*i18n*/i18n._(\"Show description\"),onToggle:function onToggle(){setShowDescription(!showDescription);},isExpanded:showDescription,children:resource.description}):resource.description,steps:isReady?steps:[{name:/*i18n*/i18n._(\"Content Loading\"),component:/*#__PURE__*/_jsx(ContentLoading,{})}],backButtonText:/*i18n*/i18n._(\"Back\"),cancelButtonText:/*i18n*/i18n._(\"Cancel\"),nextButtonText:/*i18n*/i18n._(\"Next\")});}export default SchedulePromptableFields;","map":{"version":3,"names":["React","useState","ExpandableSection","Wizard","useFormikContext","useDismissableError","AlertModal","ContentError","ContentLoading","useSchedulePromptSteps","jsx","_jsx","SchedulePromptableFields","_ref","schedule","surveyConfig","launchConfig","onCloseWizard","onSave","credentials","resource","resourceDefaultCredentials","labels","instanceGroups","_useFormikContext","setFieldTouched","values","initialValues","resetForm","_useSchedulePromptSte","steps","visitStep","visitAllSteps","validateStep","contentError","isReady","_useState","_useState2","_slicedToArray","showDescription","setShowDescription","_useDismissableError","error","dismissError","cancelPromptableValues","_ref2","_asyncToGenerator","_regeneratorRuntime","mark","_callee","wrap","_callee$","_context","prev","next","_objectSpread","description","frequency","name","startDateTime","timezone","stop","apply","arguments","isOpen","variant","title","i18n","_","onClose","children","onBack","_ref3","_callee2","nextStep","_callee2$","_context2","id","_x","onNext","_ref4","_callee3","prevStep","_callee3$","_context3","prevId","_x2","_x3","onGoToStep","_ref5","_callee4","_callee4$","_context4","_x4","_x5","0","length","toggleText","onToggle","isExpanded","component","backButtonText","cancelButtonText","nextButtonText"],"sources":["/awx_devel/awx/ui/src/components/Schedule/shared/SchedulePromptableFields.js"],"sourcesContent":["import React, { useState } from 'react';\nimport { ExpandableSection, Wizard } from '@patternfly/react-core';\nimport { t } from '@lingui/macro';\nimport { useFormikContext } from 'formik';\nimport { useDismissableError } from 'hooks/useRequest';\nimport AlertModal from '../../AlertModal';\nimport ContentError from '../../ContentError';\nimport ContentLoading from '../../ContentLoading';\nimport useSchedulePromptSteps from './useSchedulePromptSteps';\n\nfunction SchedulePromptableFields({\n  schedule,\n  surveyConfig,\n  launchConfig,\n  onCloseWizard,\n  onSave,\n  credentials,\n  resource,\n  resourceDefaultCredentials,\n  labels,\n  instanceGroups,\n}) {\n  const { setFieldTouched, values, initialValues, resetForm } =\n    useFormikContext();\n  const {\n    steps,\n    visitStep,\n    visitAllSteps,\n    validateStep,\n    contentError,\n    isReady,\n  } = useSchedulePromptSteps(\n    surveyConfig,\n    launchConfig,\n    schedule,\n    resource,\n    credentials,\n    resourceDefaultCredentials,\n    labels,\n    instanceGroups\n  );\n  const [showDescription, setShowDescription] = useState(false);\n  const { error, dismissError } = useDismissableError(contentError);\n  const cancelPromptableValues = async () => {\n    resetForm({\n      values: {\n        ...initialValues,\n        description: values.description,\n        frequency: values.frequency,\n        name: values.name,\n        startDateTime: values.startDateTime,\n        timezone: values.timezone,\n      },\n    });\n    onCloseWizard();\n  };\n\n  if (error) {\n    return (\n      <AlertModal\n        isOpen={error}\n        variant=\"error\"\n        title={t`Error!`}\n        onClose={() => {\n          dismissError();\n          onCloseWizard();\n        }}\n      >\n        <ContentError error={error} />\n      </AlertModal>\n    );\n  }\n  return (\n    <Wizard\n      isOpen\n      onClose={cancelPromptableValues}\n      onSave={onSave}\n      onBack={async (nextStep) => {\n        validateStep(nextStep.id);\n      }}\n      onNext={async (nextStep, prevStep) => {\n        if (nextStep.id === 'preview') {\n          visitAllSteps(setFieldTouched);\n        } else {\n          visitStep(prevStep.prevId, setFieldTouched);\n          validateStep(nextStep.id);\n        }\n      }}\n      onGoToStep={async (nextStep, prevStep) => {\n        if (nextStep.id === 'preview') {\n          visitAllSteps(setFieldTouched);\n        } else {\n          visitStep(prevStep.prevId, setFieldTouched);\n          validateStep(nextStep.id);\n        }\n      }}\n      title={t`Prompt | ${resource.name}`}\n      description={\n        resource.description.length > 512 ? (\n          <ExpandableSection\n            toggleText={\n              showDescription ? t`Hide description` : t`Show description`\n            }\n            onToggle={() => {\n              setShowDescription(!showDescription);\n            }}\n            isExpanded={showDescription}\n          >\n            {resource.description}\n          </ExpandableSection>\n        ) : (\n          resource.description\n        )\n      }\n      steps={\n        isReady\n          ? steps\n          : [\n              {\n                name: t`Content Loading`,\n                component: <ContentLoading />,\n              },\n            ]\n      }\n      backButtonText={t`Back`}\n      cancelButtonText={t`Cancel`}\n      nextButtonText={t`Next`}\n    />\n  );\n}\n\nexport default SchedulePromptableFields;\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}