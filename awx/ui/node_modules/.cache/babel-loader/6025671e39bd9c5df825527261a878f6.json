{"ast":null,"code":"import _slicedToArray from\"/awx_devel/awx/ui/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import _asyncToGenerator from\"/awx_devel/awx/ui/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _regeneratorRuntime from\"/awx_devel/awx/ui/node_modules/@babel/runtime/regenerator/index.js\";import{i18n}from\"@lingui/core\";import React,{useCallback,useEffect}from'react';import{useLocation,useParams}from'react-router-dom';import PaginatedTable,{HeaderRow,HeaderCell,getSearchableKeys}from'components/PaginatedTable';import useRequest from'hooks/useRequest';import{UsersAPI}from'api';import{getQSConfig,parseQueryString}from'util/qs';import UserOrganizationListItem from'./UserOrganizationListItem';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var QS_CONFIG=getQSConfig('organizations',{page:1,page_size:20,order_by:'name',type:'organization'});function UserOrganizationList(){var location=useLocation();var _useParams=useParams(),id=_useParams.id;var _useRequest=useRequest(useCallback(/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var _actions$data$actions,_actions$data;var params,_yield$Promise$all,_yield$Promise$all2,_yield$Promise$all2$,results,orgCount,actions;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:params=parseQueryString(QS_CONFIG,location.search);_context.next=3;return Promise.all([UsersAPI.readOrganizations(id,params),UsersAPI.readOrganizationOptions(id)]);case 3:_yield$Promise$all=_context.sent;_yield$Promise$all2=_slicedToArray(_yield$Promise$all,2);_yield$Promise$all2$=_yield$Promise$all2[0].data;results=_yield$Promise$all2$.results;orgCount=_yield$Promise$all2$.count;actions=_yield$Promise$all2[1];return _context.abrupt(\"return\",{searchableKeys:getSearchableKeys((_actions$data$actions=actions.data.actions)===null||_actions$data$actions===void 0?void 0:_actions$data$actions.GET),relatedSearchableKeys:((actions===null||actions===void 0?void 0:(_actions$data=actions.data)===null||_actions$data===void 0?void 0:_actions$data.related_search_fields)||[]).map(function(val){return val.slice(0,-8);}),organizations:results,count:orgCount});case 10:case\"end\":return _context.stop();}}},_callee);})),[id,location.search]),{organizations:[],count:0,searchableKeys:[],relatedSearchableKeys:[]}),_useRequest$result=_useRequest.result,organizations=_useRequest$result.organizations,count=_useRequest$result.count,searchableKeys=_useRequest$result.searchableKeys,relatedSearchableKeys=_useRequest$result.relatedSearchableKeys,contentError=_useRequest.error,isLoading=_useRequest.isLoading,fetchOrgs=_useRequest.request;useEffect(function(){fetchOrgs();},[fetchOrgs]);return/*#__PURE__*/_jsx(PaginatedTable,{items:organizations,contentError:contentError,toolbarSearchableKeys:searchableKeys,toolbarRelatedSearchableKeys:relatedSearchableKeys,hasContentLoading:isLoading,itemCount:count,pluralizedItemName:/*i18n*/i18n._(\"Organizations\"),qsConfig:QS_CONFIG,toolbarSearchColumns:[{name:/*i18n*/i18n._(\"Name\"),key:'name__icontains',isDefault:true}],headerRow:/*#__PURE__*/_jsxs(HeaderRow,{qsConfig:QS_CONFIG,isSelectable:false,children:[/*#__PURE__*/_jsx(HeaderCell,{sortKey:\"name\",children:/*i18n*/i18n._(\"Name\")}),/*#__PURE__*/_jsx(HeaderCell,{children:/*i18n*/i18n._(\"Description\")})]}),renderRow:function renderRow(organization,index){return/*#__PURE__*/_jsx(UserOrganizationListItem,{value:organization.name,organization:organization,detailUrl:\"/organizations/\".concat(organization.id,\"/details\"),onSelect:function onSelect(){},isSelected:false,rowIndex:index},organization.id);}});}export default UserOrganizationList;","map":{"version":3,"names":["React","useCallback","useEffect","useLocation","useParams","PaginatedTable","HeaderRow","HeaderCell","getSearchableKeys","useRequest","UsersAPI","getQSConfig","parseQueryString","UserOrganizationListItem","jsx","_jsx","jsxs","_jsxs","QS_CONFIG","page","page_size","order_by","type","UserOrganizationList","location","_useParams","id","_useRequest","_asyncToGenerator","_regeneratorRuntime","mark","_callee","_actions$data$actions","_actions$data","params","_yield$Promise$all","_yield$Promise$all2","_yield$Promise$all2$","results","orgCount","actions","wrap","_callee$","_context","prev","next","search","Promise","all","readOrganizations","readOrganizationOptions","sent","_slicedToArray","data","count","abrupt","searchableKeys","GET","relatedSearchableKeys","related_search_fields","map","val","slice","organizations","stop","_useRequest$result","result","contentError","error","isLoading","fetchOrgs","request","items","toolbarSearchableKeys","toolbarRelatedSearchableKeys","hasContentLoading","itemCount","pluralizedItemName","i18n","_","qsConfig","toolbarSearchColumns","name","key","isDefault","headerRow","isSelectable","children","sortKey","renderRow","organization","index","value","detailUrl","concat","onSelect","isSelected","rowIndex"],"sources":["/awx_devel/awx/ui/src/screens/User/UserOrganizations/UserOrganizationList.js"],"sourcesContent":["import React, { useCallback, useEffect } from 'react';\nimport { useLocation, useParams } from 'react-router-dom';\nimport { t } from '@lingui/macro';\n\nimport PaginatedTable, {\n  HeaderRow,\n  HeaderCell,\n  getSearchableKeys,\n} from 'components/PaginatedTable';\nimport useRequest from 'hooks/useRequest';\nimport { UsersAPI } from 'api';\nimport { getQSConfig, parseQueryString } from 'util/qs';\nimport UserOrganizationListItem from './UserOrganizationListItem';\n\nconst QS_CONFIG = getQSConfig('organizations', {\n  page: 1,\n  page_size: 20,\n  order_by: 'name',\n  type: 'organization',\n});\n\nfunction UserOrganizationList() {\n  const location = useLocation();\n  const { id } = useParams();\n\n  const {\n    result: { organizations, count, searchableKeys, relatedSearchableKeys },\n    error: contentError,\n    isLoading,\n    request: fetchOrgs,\n  } = useRequest(\n    useCallback(async () => {\n      const params = parseQueryString(QS_CONFIG, location.search);\n      const [\n        {\n          data: { results, count: orgCount },\n        },\n        actions,\n      ] = await Promise.all([\n        UsersAPI.readOrganizations(id, params),\n        UsersAPI.readOrganizationOptions(id),\n      ]);\n      return {\n        searchableKeys: getSearchableKeys(actions.data.actions?.GET),\n        relatedSearchableKeys: (actions?.data?.related_search_fields || []).map(\n          (val) => val.slice(0, -8)\n        ),\n        organizations: results,\n        count: orgCount,\n      };\n    }, [id, location.search]),\n    {\n      organizations: [],\n      count: 0,\n      searchableKeys: [],\n      relatedSearchableKeys: [],\n    }\n  );\n\n  useEffect(() => {\n    fetchOrgs();\n  }, [fetchOrgs]);\n\n  return (\n    <PaginatedTable\n      items={organizations}\n      contentError={contentError}\n      toolbarSearchableKeys={searchableKeys}\n      toolbarRelatedSearchableKeys={relatedSearchableKeys}\n      hasContentLoading={isLoading}\n      itemCount={count}\n      pluralizedItemName={t`Organizations`}\n      qsConfig={QS_CONFIG}\n      toolbarSearchColumns={[\n        { name: t`Name`, key: 'name__icontains', isDefault: true },\n      ]}\n      headerRow={\n        <HeaderRow qsConfig={QS_CONFIG} isSelectable={false}>\n          <HeaderCell sortKey=\"name\">{t`Name`}</HeaderCell>\n          <HeaderCell>{t`Description`}</HeaderCell>\n        </HeaderRow>\n      }\n      renderRow={(organization, index) => (\n        <UserOrganizationListItem\n          key={organization.id}\n          value={organization.name}\n          organization={organization}\n          detailUrl={`/organizations/${organization.id}/details`}\n          onSelect={() => {}}\n          isSelected={false}\n          rowIndex={index}\n        />\n      )}\n    />\n  );\n}\n\nexport default UserOrganizationList;\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}