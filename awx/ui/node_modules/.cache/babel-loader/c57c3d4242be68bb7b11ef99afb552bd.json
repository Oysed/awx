{"ast":null,"code":"import _asyncToGenerator from\"/awx_devel/awx/ui/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _regeneratorRuntime from\"/awx_devel/awx/ui/node_modules/@babel/runtime/regenerator/index.js\";import{i18n}from\"@lingui/core\";import React,{useCallback}from'react';import{Tr,Td}from'@patternfly/react-table';import{Link}from'react-router-dom';import{PencilAltIcon}from'@patternfly/react-icons';import{Button,Chip}from'@patternfly/react-core';import{HostsAPI}from'api';import AlertModal from'components/AlertModal';import ChipGroup from'components/ChipGroup';import ErrorDetail from'components/ErrorDetail';import HostToggle from'components/HostToggle';import{ActionsTd,ActionItem,TdBreakWord}from'components/PaginatedTable';import useRequest,{useDismissableError}from'hooks/useRequest';import{Host}from'types';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";function InventoryHostItem(_ref){var _host$summary_fields$,_host$summary_fields,_host$summary_fields$2;var detailUrl=_ref.detailUrl,editUrl=_ref.editUrl,host=_ref.host,isSelected=_ref.isSelected,onSelect=_ref.onSelect,rowIndex=_ref.rowIndex;var labelId=\"check-action-\".concat(host.id);var initialGroups=(_host$summary_fields$=host===null||host===void 0?void 0:(_host$summary_fields=host.summary_fields)===null||_host$summary_fields===void 0?void 0:_host$summary_fields.groups)!==null&&_host$summary_fields$!==void 0?_host$summary_fields$:{results:[],count:0};var _useRequest=useRequest(useCallback(/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(hostId){var _yield$HostsAPI$readG,data;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return HostsAPI.readGroups(hostId);case 2:_yield$HostsAPI$readG=_context.sent;data=_yield$HostsAPI$readG.data;return _context.abrupt(\"return\",data.results);case 5:case\"end\":return _context.stop();}}},_callee);}));return function(_x){return _ref2.apply(this,arguments);};}(),[]),initialGroups.results),error=_useRequest.error,fetchRelatedGroups=_useRequest.request,relatedGroups=_useRequest.result;var _useDismissableError=useDismissableError(error),dismissableError=_useDismissableError.error,dismissError=_useDismissableError.dismissError;var handleOverflowChipClick=function handleOverflowChipClick(hostId){if(relatedGroups.length===initialGroups.count){return;}fetchRelatedGroups(hostId);};return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsxs(Tr,{id:\"host-row-\".concat(host.id),ouiaId:\"inventory-host-row-\".concat(host.id),children:[/*#__PURE__*/_jsx(Td,{\"data-cy\":labelId,select:{rowIndex:rowIndex,isSelected:isSelected,onSelect:onSelect}}),/*#__PURE__*/_jsx(TdBreakWord,{id:labelId,dataLabel:/*i18n*/i18n._(\"Name\"),children:/*#__PURE__*/_jsx(Link,{to:\"\".concat(detailUrl),children:/*#__PURE__*/_jsx(\"b\",{children:host.name})})}),/*#__PURE__*/_jsx(TdBreakWord,{id:\"host-description-\".concat(host.id),dataLabel:/*i18n*/i18n._(\"Description\"),children:host.description}),/*#__PURE__*/_jsx(TdBreakWord,{id:\"host-related-groups-\".concat(host.id),dataLabel:/*i18n*/i18n._(\"Related Groups\"),children:/*#__PURE__*/_jsx(ChipGroup,{\"aria-label\":/*i18n*/i18n._(\"Related Groups\"),numChips:4,totalChips:initialGroups.count,ouiaId:\"host-related-groups-chips\",onOverflowChipClick:function onOverflowChipClick(){return handleOverflowChipClick(host.id);},children:relatedGroups.map(function(group){return/*#__PURE__*/_jsx(Chip,{isReadOnly:true,children:group.name},group.name);})})}),/*#__PURE__*/_jsxs(ActionsTd,{\"aria-label\":/*i18n*/i18n._(\"Actions\"),dataLabel:/*i18n*/i18n._(\"Actions\"),gridColumns:\"auto 40px\",children:[/*#__PURE__*/_jsx(HostToggle,{host:host}),/*#__PURE__*/_jsx(ActionItem,{visible:(_host$summary_fields$2=host.summary_fields.user_capabilities)===null||_host$summary_fields$2===void 0?void 0:_host$summary_fields$2.edit,tooltip:/*i18n*/i18n._(\"Edit host\"),children:/*#__PURE__*/_jsx(Button,{\"aria-label\":/*i18n*/i18n._(\"Edit host\"),ouiaId:\"\".concat(host.id,\"-edit-button\"),variant:\"plain\",component:Link,to:\"\".concat(editUrl),children:/*#__PURE__*/_jsx(PencilAltIcon,{})})})]})]}),dismissableError&&/*#__PURE__*/_jsxs(AlertModal,{isOpen:dismissableError,onClose:dismissError,title:/*i18n*/i18n._(\"Error!\"),variant:\"error\",children:[/*i18n*/i18n._(\"Failed to load related groups.\"),/*#__PURE__*/_jsx(ErrorDetail,{error:dismissableError})]})]});}export default InventoryHostItem;","map":{"version":3,"names":["React","useCallback","Tr","Td","Link","PencilAltIcon","Button","Chip","HostsAPI","AlertModal","ChipGroup","ErrorDetail","HostToggle","ActionsTd","ActionItem","TdBreakWord","useRequest","useDismissableError","Host","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","InventoryHostItem","_ref","_host$summary_fields$","_host$summary_fields","_host$summary_fields$2","detailUrl","editUrl","host","isSelected","onSelect","rowIndex","labelId","concat","id","initialGroups","summary_fields","groups","results","count","_useRequest","_ref2","_asyncToGenerator","_regeneratorRuntime","mark","_callee","hostId","_yield$HostsAPI$readG","data","wrap","_callee$","_context","prev","next","readGroups","sent","abrupt","stop","_x","apply","arguments","error","fetchRelatedGroups","request","relatedGroups","result","_useDismissableError","dismissableError","dismissError","handleOverflowChipClick","length","children","ouiaId","select","dataLabel","i18n","_","to","name","description","numChips","totalChips","onOverflowChipClick","map","group","isReadOnly","gridColumns","visible","user_capabilities","edit","tooltip","variant","component","isOpen","onClose","title"],"sources":["/awx_devel/awx/ui/src/screens/Inventory/InventoryHosts/InventoryHostItem.js"],"sourcesContent":["import React, { useCallback } from 'react';\nimport { string, bool, func } from 'prop-types';\nimport { t } from '@lingui/macro';\nimport { Tr, Td } from '@patternfly/react-table';\nimport { Link } from 'react-router-dom';\nimport { PencilAltIcon } from '@patternfly/react-icons';\nimport { Button, Chip } from '@patternfly/react-core';\nimport { HostsAPI } from 'api';\nimport AlertModal from 'components/AlertModal';\nimport ChipGroup from 'components/ChipGroup';\nimport ErrorDetail from 'components/ErrorDetail';\nimport HostToggle from 'components/HostToggle';\nimport { ActionsTd, ActionItem, TdBreakWord } from 'components/PaginatedTable';\nimport useRequest, { useDismissableError } from 'hooks/useRequest';\nimport { Host } from 'types';\n\nfunction InventoryHostItem({\n  detailUrl,\n  editUrl,\n  host,\n  isSelected,\n  onSelect,\n  rowIndex,\n}) {\n  const labelId = `check-action-${host.id}`;\n  const initialGroups = host?.summary_fields?.groups ?? {\n    results: [],\n    count: 0,\n  };\n\n  const {\n    error,\n    request: fetchRelatedGroups,\n    result: relatedGroups,\n  } = useRequest(\n    useCallback(async (hostId) => {\n      const { data } = await HostsAPI.readGroups(hostId);\n      return data.results;\n    }, []),\n    initialGroups.results\n  );\n\n  const { error: dismissableError, dismissError } = useDismissableError(error);\n\n  const handleOverflowChipClick = (hostId) => {\n    if (relatedGroups.length === initialGroups.count) {\n      return;\n    }\n    fetchRelatedGroups(hostId);\n  };\n\n  return (\n    <>\n      <Tr id={`host-row-${host.id}`} ouiaId={`inventory-host-row-${host.id}`}>\n        <Td\n          data-cy={labelId}\n          select={{\n            rowIndex,\n            isSelected,\n            onSelect,\n          }}\n        />\n        <TdBreakWord id={labelId} dataLabel={t`Name`}>\n          <Link to={`${detailUrl}`}>\n            <b>{host.name}</b>\n          </Link>\n        </TdBreakWord>\n        <TdBreakWord\n          id={`host-description-${host.id}`}\n          dataLabel={t`Description`}\n        >\n          {host.description}\n        </TdBreakWord>\n        <TdBreakWord\n          id={`host-related-groups-${host.id}`}\n          dataLabel={t`Related Groups`}\n        >\n          <ChipGroup\n            aria-label={t`Related Groups`}\n            numChips={4}\n            totalChips={initialGroups.count}\n            ouiaId=\"host-related-groups-chips\"\n            onOverflowChipClick={() => handleOverflowChipClick(host.id)}\n          >\n            {relatedGroups.map((group) => (\n              <Chip key={group.name} isReadOnly>\n                {group.name}\n              </Chip>\n            ))}\n          </ChipGroup>\n        </TdBreakWord>\n        <ActionsTd\n          aria-label={t`Actions`}\n          dataLabel={t`Actions`}\n          gridColumns=\"auto 40px\"\n        >\n          <HostToggle host={host} />\n          <ActionItem\n            visible={host.summary_fields.user_capabilities?.edit}\n            tooltip={t`Edit host`}\n          >\n            <Button\n              aria-label={t`Edit host`}\n              ouiaId={`${host.id}-edit-button`}\n              variant=\"plain\"\n              component={Link}\n              to={`${editUrl}`}\n            >\n              <PencilAltIcon />\n            </Button>\n          </ActionItem>\n        </ActionsTd>\n      </Tr>\n      {dismissableError && (\n        <AlertModal\n          isOpen={dismissableError}\n          onClose={dismissError}\n          title={t`Error!`}\n          variant=\"error\"\n        >\n          {t`Failed to load related groups.`}\n          <ErrorDetail error={dismissableError} />\n        </AlertModal>\n      )}\n    </>\n  );\n}\n\nInventoryHostItem.propTypes = {\n  detailUrl: string.isRequired,\n  host: Host.isRequired,\n  isSelected: bool.isRequired,\n  onSelect: func.isRequired,\n};\n\nexport default InventoryHostItem;\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}