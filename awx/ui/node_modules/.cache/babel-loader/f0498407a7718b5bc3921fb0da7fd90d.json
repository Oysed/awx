{"ast":null,"code":"import _slicedToArray from\"/awx_devel/awx/ui/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import _asyncToGenerator from\"/awx_devel/awx/ui/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _regeneratorRuntime from\"/awx_devel/awx/ui/node_modules/@babel/runtime/regenerator/index.js\";import{i18n}from\"@lingui/core\";import React,{useCallback,useEffect}from'react';import{useLocation}from'react-router-dom';import{OrganizationsAPI}from'api';import PaginatedTable,{HeaderRow,HeaderCell,getSearchableKeys}from'components/PaginatedTable';import{getQSConfig,parseQueryString}from'util/qs';import useRequest from'hooks/useRequest';import OrganizationTeamListItem from'./OrganizationTeamListItem';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var QS_CONFIG=getQSConfig('team',{page:1,page_size:5,order_by:'name'});function OrganizationTeamList(_ref){var id=_ref.id;var location=useLocation();var _useRequest=useRequest(useCallback(/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var _actionsResponse$data,_actionsResponse$data2;var params,_yield$Promise$all,_yield$Promise$all2,response,actionsResponse;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:params=parseQueryString(QS_CONFIG,location.search);_context.next=3;return Promise.all([OrganizationsAPI.readTeams(id,params),OrganizationsAPI.readTeamsOptions(id)]);case 3:_yield$Promise$all=_context.sent;_yield$Promise$all2=_slicedToArray(_yield$Promise$all,2);response=_yield$Promise$all2[0];actionsResponse=_yield$Promise$all2[1];return _context.abrupt(\"return\",{teams:response.data.results,count:response.data.count,relatedSearchableKeys:((actionsResponse===null||actionsResponse===void 0?void 0:(_actionsResponse$data=actionsResponse.data)===null||_actionsResponse$data===void 0?void 0:_actionsResponse$data.related_search_fields)||[]).map(function(val){return val.slice(0,-8);}),searchableKeys:getSearchableKeys((_actionsResponse$data2=actionsResponse.data.actions)===null||_actionsResponse$data2===void 0?void 0:_actionsResponse$data2.GET)});case 8:case\"end\":return _context.stop();}}},_callee);})),[id,location]),{teams:[],count:0,relatedSearchableKeys:[],searchableKeys:[]}),_useRequest$result=_useRequest.result,teams=_useRequest$result.teams,count=_useRequest$result.count,relatedSearchableKeys=_useRequest$result.relatedSearchableKeys,searchableKeys=_useRequest$result.searchableKeys,error=_useRequest.error,isLoading=_useRequest.isLoading,fetchTeams=_useRequest.request;useEffect(function(){fetchTeams();},[fetchTeams]);return/*#__PURE__*/_jsx(PaginatedTable,{contentError:error,hasContentLoading:isLoading,items:teams,itemCount:count,pluralizedItemName:/*i18n*/i18n._(\"Teams\"),qsConfig:QS_CONFIG,toolbarSearchColumns:[{name:/*i18n*/i18n._(\"Name\"),key:'name__icontains',isDefault:true},{name:/*i18n*/i18n._(\"Created by (username)\"),key:'created_by__username__icontains'},{name:/*i18n*/i18n._(\"Modified by (username)\"),key:'modified_by__username__icontains'}],toolbarSearchableKeys:searchableKeys,toolbarRelatedSearchableKeys:relatedSearchableKeys,headerRow:/*#__PURE__*/_jsxs(HeaderRow,{qsConfig:QS_CONFIG,isSelectable:false,children:[/*#__PURE__*/_jsx(HeaderCell,{sortKey:\"name\",children:/*i18n*/i18n._(\"Name\")}),/*#__PURE__*/_jsx(HeaderCell,{children:/*i18n*/i18n._(\"Actions\")})]}),renderRow:function renderRow(item){return/*#__PURE__*/_jsx(OrganizationTeamListItem,{value:item.name,team:item,detailUrl:\"/teams/\".concat(item.id)},item.id);}});}export{OrganizationTeamList as _OrganizationTeamList};export default OrganizationTeamList;","map":{"version":3,"names":["React","useCallback","useEffect","useLocation","OrganizationsAPI","PaginatedTable","HeaderRow","HeaderCell","getSearchableKeys","getQSConfig","parseQueryString","useRequest","OrganizationTeamListItem","jsx","_jsx","jsxs","_jsxs","QS_CONFIG","page","page_size","order_by","OrganizationTeamList","_ref","id","location","_useRequest","_asyncToGenerator","_regeneratorRuntime","mark","_callee","_actionsResponse$data","_actionsResponse$data2","params","_yield$Promise$all","_yield$Promise$all2","response","actionsResponse","wrap","_callee$","_context","prev","next","search","Promise","all","readTeams","readTeamsOptions","sent","_slicedToArray","abrupt","teams","data","results","count","relatedSearchableKeys","related_search_fields","map","val","slice","searchableKeys","actions","GET","stop","_useRequest$result","result","error","isLoading","fetchTeams","request","contentError","hasContentLoading","items","itemCount","pluralizedItemName","i18n","_","qsConfig","toolbarSearchColumns","name","key","isDefault","toolbarSearchableKeys","toolbarRelatedSearchableKeys","headerRow","isSelectable","children","sortKey","renderRow","item","value","team","detailUrl","concat","_OrganizationTeamList"],"sources":["/awx_devel/awx/ui/src/screens/Organization/OrganizationTeams/OrganizationTeamList.js"],"sourcesContent":["import React, { useCallback, useEffect } from 'react';\nimport PropTypes from 'prop-types';\nimport { useLocation } from 'react-router-dom';\n\nimport { t } from '@lingui/macro';\nimport { OrganizationsAPI } from 'api';\nimport PaginatedTable, {\n  HeaderRow,\n  HeaderCell,\n  getSearchableKeys,\n} from 'components/PaginatedTable';\nimport { getQSConfig, parseQueryString } from 'util/qs';\nimport useRequest from 'hooks/useRequest';\nimport OrganizationTeamListItem from './OrganizationTeamListItem';\n\nconst QS_CONFIG = getQSConfig('team', {\n  page: 1,\n  page_size: 5,\n  order_by: 'name',\n});\n\nfunction OrganizationTeamList({ id }) {\n  const location = useLocation();\n\n  const {\n    result: { teams, count, relatedSearchableKeys, searchableKeys },\n    error,\n    isLoading,\n    request: fetchTeams,\n  } = useRequest(\n    useCallback(async () => {\n      const params = parseQueryString(QS_CONFIG, location.search);\n      const [response, actionsResponse] = await Promise.all([\n        OrganizationsAPI.readTeams(id, params),\n        OrganizationsAPI.readTeamsOptions(id),\n      ]);\n      return {\n        teams: response.data.results,\n        count: response.data.count,\n        relatedSearchableKeys: (\n          actionsResponse?.data?.related_search_fields || []\n        ).map((val) => val.slice(0, -8)),\n        searchableKeys: getSearchableKeys(actionsResponse.data.actions?.GET),\n      };\n    }, [id, location]),\n    {\n      teams: [],\n      count: 0,\n      relatedSearchableKeys: [],\n      searchableKeys: [],\n    }\n  );\n\n  useEffect(() => {\n    fetchTeams();\n  }, [fetchTeams]);\n\n  return (\n    <PaginatedTable\n      contentError={error}\n      hasContentLoading={isLoading}\n      items={teams}\n      itemCount={count}\n      pluralizedItemName={t`Teams`}\n      qsConfig={QS_CONFIG}\n      toolbarSearchColumns={[\n        {\n          name: t`Name`,\n          key: 'name__icontains',\n          isDefault: true,\n        },\n        {\n          name: t`Created by (username)`,\n          key: 'created_by__username__icontains',\n        },\n        {\n          name: t`Modified by (username)`,\n          key: 'modified_by__username__icontains',\n        },\n      ]}\n      toolbarSearchableKeys={searchableKeys}\n      toolbarRelatedSearchableKeys={relatedSearchableKeys}\n      headerRow={\n        <HeaderRow qsConfig={QS_CONFIG} isSelectable={false}>\n          <HeaderCell sortKey=\"name\">{t`Name`}</HeaderCell>\n          <HeaderCell>{t`Actions`}</HeaderCell>\n        </HeaderRow>\n      }\n      renderRow={(item) => (\n        <OrganizationTeamListItem\n          key={item.id}\n          value={item.name}\n          team={item}\n          detailUrl={`/teams/${item.id}`}\n        />\n      )}\n    />\n  );\n}\n\nOrganizationTeamList.propTypes = {\n  id: PropTypes.number.isRequired,\n};\n\nexport { OrganizationTeamList as _OrganizationTeamList };\nexport default OrganizationTeamList;\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}