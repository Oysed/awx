{"ast":null,"code":"import _slicedToArray from\"/awx_devel/awx/ui/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import _taggedTemplateLiteral from\"/awx_devel/awx/ui/node_modules/@babel/runtime/helpers/esm/taggedTemplateLiteral.js\";var _templateObject;import{Trans}from\"@lingui/react\";import{i18n}from\"@lingui/core\";import React,{useState,useEffect}from'react';import{withRouter}from'react-router-dom';import{Button,Nav,NavList,Page,PageHeader as PFPageHeader,PageHeaderTools,PageHeaderToolsGroup,PageHeaderToolsItem,PageSidebar}from'@patternfly/react-core';import styled from'styled-components';import{useConfig,useAuthorizedPath}from'contexts/Config';import{useSession}from'contexts/Session';import issuePendoIdentity from'util/issuePendoIdentity';import About from'../About';import BrandLogo from'./BrandLogo';import NavExpandableGroup from'./NavExpandableGroup';import PageHeaderToolbar from'./PageHeaderToolbar';import AlertModal from'../AlertModal';import{jsx as _jsx}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var PageHeader=styled(PFPageHeader)(_templateObject||(_templateObject=_taggedTemplateLiteral([\"\\n  & .pf-c-page__header-brand-link {\\n    color: inherit;\\n    &:hover {\\n      color: inherit;\\n    }\\n  }\\n\"])));function AppContainer(_ref){var _config$license_info;var _ref$navRouteConfig=_ref.navRouteConfig,navRouteConfig=_ref$navRouteConfig===void 0?[]:_ref$navRouteConfig,children=_ref.children;var config=useConfig();var _useSession=useSession(),logout=_useSession.logout,handleSessionContinue=_useSession.handleSessionContinue,sessionCountdown=_useSession.sessionCountdown;var isReady=!!config.license_info;var isSidebarVisible=useAuthorizedPath();var _useState=useState(false),_useState2=_slicedToArray(_useState,2),isAboutModalOpen=_useState2[0],setIsAboutModalOpen=_useState2[1];var handleAboutModalOpen=function handleAboutModalOpen(){return setIsAboutModalOpen(true);};var handleAboutModalClose=function handleAboutModalClose(){return setIsAboutModalOpen(false);};useEffect(function(){if('analytics_status'in config){issuePendoIdentity(config);}// eslint-disable-next-line react-hooks/exhaustive-deps\n},[config.analytics_status]);var brandName=config===null||config===void 0?void 0:(_config$license_info=config.license_info)===null||_config$license_info===void 0?void 0:_config$license_info.product_name;var alt=brandName?/*i18n*/i18n._(\"{brandName} logo\",{brandName:brandName}):/*i18n*/i18n._(\"brand logo\");var header=/*#__PURE__*/_jsx(PageHeader,{showNavToggle:true,logo:/*#__PURE__*/_jsx(BrandLogo,{alt:alt}),logoProps:{href:'/'},headerTools:/*#__PURE__*/_jsx(PageHeaderToolbar,{loggedInUser:config===null||config===void 0?void 0:config.me,isAboutDisabled:!(config!==null&&config!==void 0&&config.version),onAboutClick:handleAboutModalOpen,onLogoutClick:logout})});var simpleHeader=config.isLoading?null:/*#__PURE__*/_jsx(PageHeader,{logo:/*#__PURE__*/_jsx(BrandLogo,{alt:alt}),headerTools:/*#__PURE__*/_jsx(PageHeaderTools,{children:/*#__PURE__*/_jsx(PageHeaderToolsGroup,{children:/*#__PURE__*/_jsx(PageHeaderToolsItem,{children:/*#__PURE__*/_jsx(Button,{onClick:logout,variant:\"tertiary\",ouiaId:\"logout\",children:/*i18n*/i18n._(\"Logout\")})})})})});var sidebar=/*#__PURE__*/_jsx(PageSidebar,{theme:\"dark\",nav:/*#__PURE__*/_jsx(Nav,{\"aria-label\":/*i18n*/i18n._(\"Navigation\"),theme:\"dark\",ouiaId:\"sidebar-navigation\",children:/*#__PURE__*/_jsx(NavList,{children:navRouteConfig.map(function(_ref2){var groupId=_ref2.groupId,groupTitle=_ref2.groupTitle,routes=_ref2.routes;return/*#__PURE__*/_jsx(NavExpandableGroup,{groupId:groupId,groupTitle:groupTitle,routes:routes},groupId);})})})});return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(Page,{isManagedSidebar:isSidebarVisible,header:isSidebarVisible?header:simpleHeader,sidebar:isSidebarVisible&&sidebar,children:isReady?children:null}),/*#__PURE__*/_jsx(About,{version:config===null||config===void 0?void 0:config.version,isOpen:isAboutModalOpen,onClose:handleAboutModalClose}),/*#__PURE__*/_jsx(AlertModal,{ouiaId:\"session-expiration-modal\",title:/*i18n*/i18n._(\"Your session is about to expire\"),isOpen:sessionCountdown&&sessionCountdown>0,onClose:logout,showClose:false,variant:\"warning\",actions:[/*#__PURE__*/_jsx(Button,{ouiaId:\"session-expiration-continue-button\",variant:\"primary\",onClick:handleSessionContinue,children:/*i18n*/i18n._(\"Continue\")},\"confirm\"),/*#__PURE__*/_jsx(Button,{ouiaId:\"session-expiration-logout-button\",variant:\"secondary\",onClick:logout,children:/*i18n*/i18n._(\"Logout\")},\"logout\")],children:/*#__PURE__*/_jsx(Trans,{id:\"{sessionCountdown, plural, one {You will be logged out in # second due to inactivity} other {You will be logged out in # seconds due to inactivity}}\",values:{sessionCountdown:sessionCountdown}})})]});}export{AppContainer as _AppContainer};export default withRouter(AppContainer);","map":{"version":3,"names":["React","useState","useEffect","withRouter","Button","Nav","NavList","Page","PageHeader","PFPageHeader","PageHeaderTools","PageHeaderToolsGroup","PageHeaderToolsItem","PageSidebar","styled","useConfig","useAuthorizedPath","useSession","issuePendoIdentity","About","BrandLogo","NavExpandableGroup","PageHeaderToolbar","AlertModal","jsx","_jsx","Fragment","_Fragment","jsxs","_jsxs","_templateObject","_taggedTemplateLiteral","AppContainer","_ref","_config$license_info","_ref$navRouteConfig","navRouteConfig","children","config","_useSession","logout","handleSessionContinue","sessionCountdown","isReady","license_info","isSidebarVisible","_useState","_useState2","_slicedToArray","isAboutModalOpen","setIsAboutModalOpen","handleAboutModalOpen","handleAboutModalClose","analytics_status","brandName","product_name","alt","i18n","_","header","showNavToggle","logo","logoProps","href","headerTools","loggedInUser","me","isAboutDisabled","version","onAboutClick","onLogoutClick","simpleHeader","isLoading","onClick","variant","ouiaId","sidebar","theme","nav","map","_ref2","groupId","groupTitle","routes","isManagedSidebar","isOpen","onClose","title","showClose","actions","Trans","id","values","_AppContainer"],"sources":["/awx_devel/awx/ui/src/components/AppContainer/AppContainer.js"],"sourcesContent":["import React, { useState, useEffect } from 'react';\nimport { withRouter } from 'react-router-dom';\nimport {\n  Button,\n  Nav,\n  NavList,\n  Page,\n  PageHeader as PFPageHeader,\n  PageHeaderTools,\n  PageHeaderToolsGroup,\n  PageHeaderToolsItem,\n  PageSidebar,\n} from '@patternfly/react-core';\nimport { t, Plural } from '@lingui/macro';\n\nimport styled from 'styled-components';\n\nimport { useConfig, useAuthorizedPath } from 'contexts/Config';\nimport { useSession } from 'contexts/Session';\nimport issuePendoIdentity from 'util/issuePendoIdentity';\nimport About from '../About';\nimport BrandLogo from './BrandLogo';\nimport NavExpandableGroup from './NavExpandableGroup';\nimport PageHeaderToolbar from './PageHeaderToolbar';\nimport AlertModal from '../AlertModal';\n\nconst PageHeader = styled(PFPageHeader)`\n  & .pf-c-page__header-brand-link {\n    color: inherit;\n    &:hover {\n      color: inherit;\n    }\n  }\n`;\n\nfunction AppContainer({ navRouteConfig = [], children }) {\n  const config = useConfig();\n  const { logout, handleSessionContinue, sessionCountdown } = useSession();\n\n  const isReady = !!config.license_info;\n  const isSidebarVisible = useAuthorizedPath();\n  const [isAboutModalOpen, setIsAboutModalOpen] = useState(false);\n\n  const handleAboutModalOpen = () => setIsAboutModalOpen(true);\n  const handleAboutModalClose = () => setIsAboutModalOpen(false);\n\n  useEffect(() => {\n    if ('analytics_status' in config) {\n      issuePendoIdentity(config);\n    }\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [config.analytics_status]);\n\n  const brandName = config?.license_info?.product_name;\n  const alt = brandName ? t`${brandName} logo` : t`brand logo`;\n\n  const header = (\n    <PageHeader\n      showNavToggle\n      logo={<BrandLogo alt={alt} />}\n      logoProps={{ href: '/' }}\n      headerTools={\n        <PageHeaderToolbar\n          loggedInUser={config?.me}\n          isAboutDisabled={!config?.version}\n          onAboutClick={handleAboutModalOpen}\n          onLogoutClick={logout}\n        />\n      }\n    />\n  );\n\n  const simpleHeader = config.isLoading ? null : (\n    <PageHeader\n      logo={<BrandLogo alt={alt} />}\n      headerTools={\n        <PageHeaderTools>\n          <PageHeaderToolsGroup>\n            <PageHeaderToolsItem>\n              <Button onClick={logout} variant=\"tertiary\" ouiaId=\"logout\">\n                {t`Logout`}\n              </Button>\n            </PageHeaderToolsItem>\n          </PageHeaderToolsGroup>\n        </PageHeaderTools>\n      }\n    />\n  );\n\n  const sidebar = (\n    <PageSidebar\n      theme=\"dark\"\n      nav={\n        <Nav\n          aria-label={t`Navigation`}\n          theme=\"dark\"\n          ouiaId=\"sidebar-navigation\"\n        >\n          <NavList>\n            {navRouteConfig.map(({ groupId, groupTitle, routes }) => (\n              <NavExpandableGroup\n                key={groupId}\n                groupId={groupId}\n                groupTitle={groupTitle}\n                routes={routes}\n              />\n            ))}\n          </NavList>\n        </Nav>\n      }\n    />\n  );\n\n  return (\n    <>\n      <Page\n        isManagedSidebar={isSidebarVisible}\n        header={isSidebarVisible ? header : simpleHeader}\n        sidebar={isSidebarVisible && sidebar}\n      >\n        {isReady ? children : null}\n      </Page>\n      <About\n        version={config?.version}\n        isOpen={isAboutModalOpen}\n        onClose={handleAboutModalClose}\n      />\n      <AlertModal\n        ouiaId=\"session-expiration-modal\"\n        title={t`Your session is about to expire`}\n        isOpen={sessionCountdown && sessionCountdown > 0}\n        onClose={logout}\n        showClose={false}\n        variant=\"warning\"\n        actions={[\n          <Button\n            ouiaId=\"session-expiration-continue-button\"\n            key=\"confirm\"\n            variant=\"primary\"\n            onClick={handleSessionContinue}\n          >\n            {t`Continue`}\n          </Button>,\n          <Button\n            ouiaId=\"session-expiration-logout-button\"\n            key=\"logout\"\n            variant=\"secondary\"\n            onClick={logout}\n          >\n            {t`Logout`}\n          </Button>,\n        ]}\n      >\n        <Plural\n          value={sessionCountdown}\n          one=\"You will be logged out in # second due to inactivity\"\n          other=\"You will be logged out in # seconds due to inactivity\"\n        />\n      </AlertModal>\n    </>\n  );\n}\n\nexport { AppContainer as _AppContainer };\nexport default withRouter(AppContainer);\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}