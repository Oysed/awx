{"ast":null,"code":"import _asyncToGenerator from\"/awx_devel/awx/ui/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _regeneratorRuntime from\"/awx_devel/awx/ui/node_modules/@babel/runtime/regenerator/index.js\";import{i18n}from\"@lingui/core\";import React,{useEffect,useCallback}from'react';import{Switch,Route,Redirect,Link,useRouteMatch,useLocation}from'react-router-dom';import{CaretLeftIcon}from'@patternfly/react-icons';import{Card,PageSection}from'@patternfly/react-core';import useRequest from'hooks/useRequest';import{UsersAPI}from'api';import ContentError from'components/ContentError';import RoutedTabs from'components/RoutedTabs';import UserDetail from'./UserDetail';import UserEdit from'./UserEdit';import UserOrganizations from'./UserOrganizations';import UserTeams from'./UserTeams';import UserTokens from'./UserTokens';import UserRolesList from'./UserRoles/UserRolesList';import{jsx as _jsx}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";function User(_ref){var setBreadcrumb=_ref.setBreadcrumb,me=_ref.me;var location=useLocation();var match=useRouteMatch('/users/:id');var userListUrl=\"/users\";var _useRequest=useRequest(useCallback(/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var _yield$UsersAPI$readD,data;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return UsersAPI.readDetail(match.params.id);case 2:_yield$UsersAPI$readD=_context.sent;data=_yield$UsersAPI$readD.data;return _context.abrupt(\"return\",data);case 5:case\"end\":return _context.stop();}}},_callee);})),[match.params.id]),null),user=_useRequest.result,contentError=_useRequest.error,isLoading=_useRequest.isLoading,fetchUser=_useRequest.request;useEffect(function(){fetchUser();},[fetchUser,location.pathname]);useEffect(function(){if(user){setBreadcrumb(user);}},[user,setBreadcrumb]);var tabsArray=[{name:/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(CaretLeftIcon,{}),/*i18n*/i18n._(\"Back to Users\")]}),link:\"/users\",id:99,persistentFilterKey:'users'},{name:/*i18n*/i18n._(\"Details\"),link:\"\".concat(match.url,\"/details\"),id:0},{name:/*i18n*/i18n._(\"Organizations\"),link:\"\".concat(match.url,\"/organizations\"),id:1},{name:/*i18n*/i18n._(\"Teams\"),link:\"\".concat(match.url,\"/teams\"),id:2},{name:/*i18n*/i18n._(\"Roles\"),link:\"\".concat(match.url,\"/roles\"),id:3}];if((me===null||me===void 0?void 0:me.id)===Number(match.params.id)){tabsArray.push({name:/*i18n*/i18n._(\"Tokens\"),link:\"\".concat(match.url,\"/tokens\"),id:4});}var showCardHeader=true;if(['edit','add','tokens/'].some(function(name){return location.pathname.includes(name);})){showCardHeader=false;}if(!isLoading&&contentError){return/*#__PURE__*/_jsx(PageSection,{children:/*#__PURE__*/_jsx(Card,{children:/*#__PURE__*/_jsx(ContentError,{error:contentError,children:contentError.response&&contentError.response.status===404&&/*#__PURE__*/_jsxs(\"span\",{children:[/*i18n*/i18n._(\"User not found.\"),' ',/*#__PURE__*/_jsx(Link,{to:userListUrl,children:/*i18n*/i18n._(\"View all Users.\")})]})})})});}return/*#__PURE__*/_jsx(PageSection,{children:/*#__PURE__*/_jsxs(Card,{children:[showCardHeader&&/*#__PURE__*/_jsx(RoutedTabs,{tabsArray:tabsArray}),/*#__PURE__*/_jsxs(Switch,{children:[/*#__PURE__*/_jsx(Redirect,{from:\"/users/:id\",to:\"/users/:id/details\",exact:true}),user&&[/*#__PURE__*/_jsx(Route,{path:\"/users/:id/edit\",children:/*#__PURE__*/_jsx(UserEdit,{user:user})},\"edit\"),/*#__PURE__*/_jsx(Route,{path:\"/users/:id/details\",children:/*#__PURE__*/_jsx(UserDetail,{user:user})},\"details\"),/*#__PURE__*/_jsx(Route,{path:\"/users/:id/organizations\",children:/*#__PURE__*/_jsx(UserOrganizations,{id:Number(match.params.id)})},\"organizations\"),/*#__PURE__*/_jsx(Route,{path:\"/users/:id/teams\",children:/*#__PURE__*/_jsx(UserTeams,{})},\"teams\"),/*#__PURE__*/_jsx(Route,{path:\"/users/:id/roles\",children:/*#__PURE__*/_jsx(UserRolesList,{user:user})},\"roles\"),/*#__PURE__*/_jsx(Route,{path:\"/users/:id/tokens\",children:/*#__PURE__*/_jsx(UserTokens,{user:user,setBreadcrumb:setBreadcrumb,id:Number(match.params.id)})},\"tokens\")],/*#__PURE__*/_jsx(Route,{path:\"*\",children:!isLoading&&/*#__PURE__*/_jsx(ContentError,{isNotFound:true,children:match.params.id&&/*#__PURE__*/_jsx(Link,{to:\"/users/\".concat(match.params.id,\"/details\"),children:/*i18n*/i18n._(\"View User Details\")})})},\"not-found\")]})]})});}export default User;","map":{"version":3,"names":["React","useEffect","useCallback","Switch","Route","Redirect","Link","useRouteMatch","useLocation","CaretLeftIcon","Card","PageSection","useRequest","UsersAPI","ContentError","RoutedTabs","UserDetail","UserEdit","UserOrganizations","UserTeams","UserTokens","UserRolesList","jsx","_jsx","Fragment","_Fragment","jsxs","_jsxs","User","_ref","setBreadcrumb","me","location","match","userListUrl","_useRequest","_asyncToGenerator","_regeneratorRuntime","mark","_callee","_yield$UsersAPI$readD","data","wrap","_callee$","_context","prev","next","readDetail","params","id","sent","abrupt","stop","user","result","contentError","error","isLoading","fetchUser","request","pathname","tabsArray","name","children","i18n","_","link","persistentFilterKey","concat","url","Number","push","showCardHeader","some","includes","response","status","to","from","exact","path","isNotFound"],"sources":["/awx_devel/awx/ui/src/screens/User/User.js"],"sourcesContent":["import React, { useEffect, useCallback } from 'react';\n\nimport { t } from '@lingui/macro';\nimport {\n  Switch,\n  Route,\n  Redirect,\n  Link,\n  useRouteMatch,\n  useLocation,\n} from 'react-router-dom';\nimport { CaretLeftIcon } from '@patternfly/react-icons';\nimport { Card, PageSection } from '@patternfly/react-core';\nimport useRequest from 'hooks/useRequest';\nimport { UsersAPI } from 'api';\nimport ContentError from 'components/ContentError';\nimport RoutedTabs from 'components/RoutedTabs';\nimport UserDetail from './UserDetail';\nimport UserEdit from './UserEdit';\nimport UserOrganizations from './UserOrganizations';\nimport UserTeams from './UserTeams';\nimport UserTokens from './UserTokens';\nimport UserRolesList from './UserRoles/UserRolesList';\n\nfunction User({ setBreadcrumb, me }) {\n  const location = useLocation();\n  const match = useRouteMatch('/users/:id');\n  const userListUrl = `/users`;\n  const {\n    result: user,\n    error: contentError,\n    isLoading,\n    request: fetchUser,\n  } = useRequest(\n    useCallback(async () => {\n      const { data } = await UsersAPI.readDetail(match.params.id);\n      return data;\n    }, [match.params.id]),\n    null\n  );\n\n  useEffect(() => {\n    fetchUser();\n  }, [fetchUser, location.pathname]);\n\n  useEffect(() => {\n    if (user) {\n      setBreadcrumb(user);\n    }\n  }, [user, setBreadcrumb]);\n\n  const tabsArray = [\n    {\n      name: (\n        <>\n          <CaretLeftIcon />\n          {t`Back to Users`}\n        </>\n      ),\n      link: `/users`,\n      id: 99,\n      persistentFilterKey: 'users',\n    },\n    { name: t`Details`, link: `${match.url}/details`, id: 0 },\n    {\n      name: t`Organizations`,\n      link: `${match.url}/organizations`,\n      id: 1,\n    },\n    { name: t`Teams`, link: `${match.url}/teams`, id: 2 },\n    { name: t`Roles`, link: `${match.url}/roles`, id: 3 },\n  ];\n\n  if (me?.id === Number(match.params.id)) {\n    tabsArray.push({\n      name: t`Tokens`,\n      link: `${match.url}/tokens`,\n      id: 4,\n    });\n  }\n\n  let showCardHeader = true;\n  if (\n    ['edit', 'add', 'tokens/'].some((name) => location.pathname.includes(name))\n  ) {\n    showCardHeader = false;\n  }\n\n  if (!isLoading && contentError) {\n    return (\n      <PageSection>\n        <Card>\n          <ContentError error={contentError}>\n            {contentError.response && contentError.response.status === 404 && (\n              <span>\n                {t`User not found.`}{' '}\n                <Link to={userListUrl}>{t`View all Users.`}</Link>\n              </span>\n            )}\n          </ContentError>\n        </Card>\n      </PageSection>\n    );\n  }\n\n  return (\n    <PageSection>\n      <Card>\n        {showCardHeader && <RoutedTabs tabsArray={tabsArray} />}\n        <Switch>\n          <Redirect from=\"/users/:id\" to=\"/users/:id/details\" exact />\n          {user && [\n            <Route path=\"/users/:id/edit\" key=\"edit\">\n              <UserEdit user={user} />\n            </Route>,\n            <Route path=\"/users/:id/details\" key=\"details\">\n              <UserDetail user={user} />\n            </Route>,\n            <Route path=\"/users/:id/organizations\" key=\"organizations\">\n              <UserOrganizations id={Number(match.params.id)} />\n            </Route>,\n            <Route path=\"/users/:id/teams\" key=\"teams\">\n              <UserTeams />\n            </Route>,\n            <Route path=\"/users/:id/roles\" key=\"roles\">\n              <UserRolesList user={user} />\n            </Route>,\n            <Route path=\"/users/:id/tokens\" key=\"tokens\">\n              <UserTokens\n                user={user}\n                setBreadcrumb={setBreadcrumb}\n                id={Number(match.params.id)}\n              />\n            </Route>,\n          ]}\n          <Route key=\"not-found\" path=\"*\">\n            {!isLoading && (\n              <ContentError isNotFound>\n                {match.params.id && (\n                  <Link to={`/users/${match.params.id}/details`}>\n                    {t`View User Details`}\n                  </Link>\n                )}\n              </ContentError>\n            )}\n          </Route>\n        </Switch>\n      </Card>\n    </PageSection>\n  );\n}\n\nexport default User;\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}