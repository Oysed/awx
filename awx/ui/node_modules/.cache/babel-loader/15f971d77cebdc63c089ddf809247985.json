{"ast":null,"code":"import _slicedToArray from\"/awx_devel/awx/ui/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import _asyncToGenerator from\"/awx_devel/awx/ui/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _regeneratorRuntime from\"/awx_devel/awx/ui/node_modules/@babel/runtime/regenerator/index.js\";import{i18n}from\"@lingui/core\";import React,{useCallback,useEffect}from'react';import{Route,Switch,Redirect,useParams,useLocation,Link}from'react-router-dom';import{CaretLeftIcon}from'@patternfly/react-icons';import{Card,PageSection}from'@patternfly/react-core';import useRequest from'hooks/useRequest';import{ApplicationsAPI}from'api';import ContentError from'components/ContentError';import RoutedTabs from'components/RoutedTabs';import ApplicationEdit from'../ApplicationEdit';import ApplicationDetails from'../ApplicationDetails';import ApplicationTokens from'../ApplicationTokens';import{jsx as _jsx}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";function Application(_ref){var setBreadcrumb=_ref.setBreadcrumb;var _useParams=useParams(),id=_useParams.id;var _useLocation=useLocation(),pathname=_useLocation.pathname;var _useRequest=useRequest(useCallback(/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var _yield$Promise$all,_yield$Promise$all2,detail,options,authorization,clientType;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return Promise.all([ApplicationsAPI.readDetail(id),ApplicationsAPI.readOptions()]);case 2:_yield$Promise$all=_context.sent;_yield$Promise$all2=_slicedToArray(_yield$Promise$all,2);detail=_yield$Promise$all2[0];options=_yield$Promise$all2[1];authorization=options.data.actions.GET.authorization_grant_type.choices.map(function(choice){return{value:choice[0],label:choice[1],key:choice[0]};});clientType=options.data.actions.GET.client_type.choices.map(function(choice){return{value:choice[0],label:choice[1],key:choice[0]};});setBreadcrumb(detail.data);return _context.abrupt(\"return\",{application:detail.data,authorizationOptions:authorization,clientTypeOptions:clientType});case 10:case\"end\":return _context.stop();}}},_callee);})),[setBreadcrumb,id]),{authorizationOptions:[],clientTypeOptions:[]}),isLoading=_useRequest.isLoading,error=_useRequest.error,_useRequest$result=_useRequest.result,application=_useRequest$result.application,authorizationOptions=_useRequest$result.authorizationOptions,clientTypeOptions=_useRequest$result.clientTypeOptions,fetchApplication=_useRequest.request;useEffect(function(){fetchApplication();},[fetchApplication,pathname]);var tabsArray=[{name:/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(CaretLeftIcon,{}),/*i18n*/i18n._(\"Back to applications\")]}),link:'/applications',id:0,persistentFilterKey:'applications'},{name:/*i18n*/i18n._(\"Details\"),link:\"/applications/\".concat(id,\"/details\"),id:1},{name:/*i18n*/i18n._(\"Tokens\"),link:\"/applications/\".concat(id,\"/tokens\"),id:2}];var cardHeader=/*#__PURE__*/_jsx(RoutedTabs,{tabsArray:tabsArray});if(pathname.endsWith('edit')){cardHeader=null;}if(!isLoading&&error){var _error$response;return/*#__PURE__*/_jsx(PageSection,{children:/*#__PURE__*/_jsx(Card,{children:/*#__PURE__*/_jsx(ContentError,{error:error,children:((_error$response=error.response)===null||_error$response===void 0?void 0:_error$response.status)===404&&/*#__PURE__*/_jsxs(\"span\",{children:[/*i18n*/i18n._(\"Application not found.\"),' ',/*#__PURE__*/_jsx(Link,{to:\"/applications\",children:/*i18n*/i18n._(\"View all applications.\")})]})})})});}return/*#__PURE__*/_jsx(PageSection,{children:/*#__PURE__*/_jsxs(Card,{children:[cardHeader,/*#__PURE__*/_jsxs(Switch,{children:[/*#__PURE__*/_jsx(Redirect,{from:\"/applications/:id\",to:\"/applications/:id/details\",exact:true}),application&&/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(Route,{path:\"/applications/:id/edit\",children:/*#__PURE__*/_jsx(ApplicationEdit,{authorizationOptions:authorizationOptions,clientTypeOptions:clientTypeOptions,application:application})}),/*#__PURE__*/_jsx(Route,{path:\"/applications/:id/details\",children:/*#__PURE__*/_jsx(ApplicationDetails,{application:application,authorizationOptions:authorizationOptions,clientTypeOptions:clientTypeOptions})}),/*#__PURE__*/_jsx(Route,{path:\"/applications/:id/tokens\",children:/*#__PURE__*/_jsx(ApplicationTokens,{application:application})})]})]})]})});}export default Application;","map":{"version":3,"names":["React","useCallback","useEffect","Route","Switch","Redirect","useParams","useLocation","Link","CaretLeftIcon","Card","PageSection","useRequest","ApplicationsAPI","ContentError","RoutedTabs","ApplicationEdit","ApplicationDetails","ApplicationTokens","jsx","_jsx","Fragment","_Fragment","jsxs","_jsxs","Application","_ref","setBreadcrumb","_useParams","id","_useLocation","pathname","_useRequest","_asyncToGenerator","_regeneratorRuntime","mark","_callee","_yield$Promise$all","_yield$Promise$all2","detail","options","authorization","clientType","wrap","_callee$","_context","prev","next","Promise","all","readDetail","readOptions","sent","_slicedToArray","data","actions","GET","authorization_grant_type","choices","map","choice","value","label","key","client_type","abrupt","application","authorizationOptions","clientTypeOptions","stop","isLoading","error","_useRequest$result","result","fetchApplication","request","tabsArray","name","children","i18n","_","link","persistentFilterKey","concat","cardHeader","endsWith","_error$response","response","status","to","from","exact","path"],"sources":["/awx_devel/awx/ui/src/screens/Application/Application/Application.js"],"sourcesContent":["import React, { useCallback, useEffect } from 'react';\nimport {\n  Route,\n  Switch,\n  Redirect,\n  useParams,\n  useLocation,\n  Link,\n} from 'react-router-dom';\nimport { t } from '@lingui/macro';\n\nimport { CaretLeftIcon } from '@patternfly/react-icons';\nimport { Card, PageSection } from '@patternfly/react-core';\n\nimport useRequest from 'hooks/useRequest';\nimport { ApplicationsAPI } from 'api';\nimport ContentError from 'components/ContentError';\nimport RoutedTabs from 'components/RoutedTabs';\nimport ApplicationEdit from '../ApplicationEdit';\nimport ApplicationDetails from '../ApplicationDetails';\nimport ApplicationTokens from '../ApplicationTokens';\n\nfunction Application({ setBreadcrumb }) {\n  const { id } = useParams();\n  const { pathname } = useLocation();\n  const {\n    isLoading,\n    error,\n    result: { application, authorizationOptions, clientTypeOptions },\n    request: fetchApplication,\n  } = useRequest(\n    useCallback(async () => {\n      const [detail, options] = await Promise.all([\n        ApplicationsAPI.readDetail(id),\n        ApplicationsAPI.readOptions(),\n      ]);\n      const authorization =\n        options.data.actions.GET.authorization_grant_type.choices.map(\n          (choice) => ({\n            value: choice[0],\n            label: choice[1],\n            key: choice[0],\n          })\n        );\n      const clientType = options.data.actions.GET.client_type.choices.map(\n        (choice) => ({\n          value: choice[0],\n          label: choice[1],\n          key: choice[0],\n        })\n      );\n      setBreadcrumb(detail.data);\n\n      return {\n        application: detail.data,\n        authorizationOptions: authorization,\n        clientTypeOptions: clientType,\n      };\n    }, [setBreadcrumb, id]),\n    { authorizationOptions: [], clientTypeOptions: [] }\n  );\n\n  useEffect(() => {\n    fetchApplication();\n  }, [fetchApplication, pathname]);\n\n  const tabsArray = [\n    {\n      name: (\n        <>\n          <CaretLeftIcon />\n          {t`Back to applications`}\n        </>\n      ),\n      link: '/applications',\n      id: 0,\n      persistentFilterKey: 'applications',\n    },\n    { name: t`Details`, link: `/applications/${id}/details`, id: 1 },\n    { name: t`Tokens`, link: `/applications/${id}/tokens`, id: 2 },\n  ];\n\n  let cardHeader = <RoutedTabs tabsArray={tabsArray} />;\n  if (pathname.endsWith('edit')) {\n    cardHeader = null;\n  }\n\n  if (!isLoading && error) {\n    return (\n      <PageSection>\n        <Card>\n          <ContentError error={error}>\n            {error.response?.status === 404 && (\n              <span>\n                {t`Application not found.`}{' '}\n                <Link to=\"/applications\">{t`View all applications.`}</Link>\n              </span>\n            )}\n          </ContentError>\n        </Card>\n      </PageSection>\n    );\n  }\n\n  return (\n    <PageSection>\n      <Card>\n        {cardHeader}\n        <Switch>\n          <Redirect\n            from=\"/applications/:id\"\n            to=\"/applications/:id/details\"\n            exact\n          />\n          {application && (\n            <>\n              <Route path=\"/applications/:id/edit\">\n                <ApplicationEdit\n                  authorizationOptions={authorizationOptions}\n                  clientTypeOptions={clientTypeOptions}\n                  application={application}\n                />\n              </Route>\n              <Route path=\"/applications/:id/details\">\n                <ApplicationDetails\n                  application={application}\n                  authorizationOptions={authorizationOptions}\n                  clientTypeOptions={clientTypeOptions}\n                />\n              </Route>\n              <Route path=\"/applications/:id/tokens\">\n                <ApplicationTokens application={application} />\n              </Route>\n            </>\n          )}\n        </Switch>\n      </Card>\n    </PageSection>\n  );\n}\nexport default Application;\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}