{"ast":null,"code":"import _asyncToGenerator from\"/awx_devel/awx/ui/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _regeneratorRuntime from\"/awx_devel/awx/ui/node_modules/@babel/runtime/regenerator/index.js\";import{i18n}from\"@lingui/core\";import React,{useEffect,useCallback}from'react';import{Switch,Route,Link,Redirect,useLocation,useParams}from'react-router-dom';import{CaretLeftIcon}from'@patternfly/react-icons';import{SchedulesAPI}from'api';import useRequest from'hooks/useRequest';import RoutedTabs from'../RoutedTabs';import ContentError from'../ContentError';import ContentLoading from'../ContentLoading';import ScheduleDetail from'./ScheduleDetail';import ScheduleEdit from'./ScheduleEdit';import{jsx as _jsx}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";function Schedule(_ref){var _schedule$summary_fie,_schedule$summary_fie2;var setBreadcrumb=_ref.setBreadcrumb,resource=_ref.resource,launchConfig=_ref.launchConfig,surveyConfig=_ref.surveyConfig,hasDaysToKeepField=_ref.hasDaysToKeepField,resourceDefaultCredentials=_ref.resourceDefaultCredentials;var _useParams=useParams(),scheduleId=_useParams.scheduleId;var _useLocation=useLocation(),pathname=_useLocation.pathname;var pathRoot=pathname.substr(0,pathname.indexOf('schedules'));var _useRequest=useRequest(useCallback(/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var _yield$SchedulesAPI$r,data;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return SchedulesAPI.readDetail(scheduleId);case 2:_yield$SchedulesAPI$r=_context.sent;data=_yield$SchedulesAPI$r.data;return _context.abrupt(\"return\",data);case 5:case\"end\":return _context.stop();}}},_callee);})),[scheduleId]),null),isLoading=_useRequest.isLoading,error=_useRequest.error,loadData=_useRequest.request,schedule=_useRequest.result;useEffect(function(){loadData();},[loadData,pathname]);useEffect(function(){if(schedule){setBreadcrumb(resource,schedule);}// eslint-disable-next-line react-hooks/exhaustive-deps\n},[schedule,resource]);var tabsArray=[{name:/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(CaretLeftIcon,{}),/*i18n*/i18n._(\"Back to Schedules\")]}),link:\"\".concat(pathRoot,\"schedules\"),id:99},{name:/*i18n*/i18n._(\"Details\"),link:\"\".concat(pathRoot,\"schedules/\").concat(schedule&&schedule.id,\"/details\"),id:0}];if(!isLoading&&error){return/*#__PURE__*/_jsx(ContentError,{isNotFound:true,error:error,children:error.response&&error.response.status===404&&/*#__PURE__*/_jsxs(\"span\",{children:[/*i18n*/i18n._(\"Schedule not found.\"),' ',/*#__PURE__*/_jsx(Link,{to:\"\".concat(pathRoot,\"schedules\"),children:/*i18n*/i18n._(\"View Schedules\")})]})});}if(isLoading||!(schedule!==null&&schedule!==void 0&&(_schedule$summary_fie=schedule.summary_fields)!==null&&_schedule$summary_fie!==void 0&&(_schedule$summary_fie2=_schedule$summary_fie.unified_job_template)!==null&&_schedule$summary_fie2!==void 0&&_schedule$summary_fie2.id)){return/*#__PURE__*/_jsx(ContentLoading,{});}if((schedule===null||schedule===void 0?void 0:schedule.summary_fields.unified_job_template.id)!==parseInt(resource.id,10)){return/*#__PURE__*/_jsx(ContentError,{children:schedule&&/*#__PURE__*/_jsx(Link,{to:\"\".concat(pathRoot,\"schedules\"),children:/*i18n*/i18n._(\"View Schedules\")})});}if(error){return/*#__PURE__*/_jsx(ContentError,{error:error});}var showCardHeader=true;if(!pathname.includes('schedules/')||pathname.endsWith('edit')){showCardHeader=false;}return/*#__PURE__*/_jsxs(_Fragment,{children:[showCardHeader&&/*#__PURE__*/_jsx(RoutedTabs,{tabsArray:tabsArray}),/*#__PURE__*/_jsxs(Switch,{children:[/*#__PURE__*/_jsx(Redirect,{from:\"\".concat(pathRoot,\"schedules/:scheduleId\"),to:\"\".concat(pathRoot,\"schedules/:scheduleId/details\"),exact:true}),schedule&&[/*#__PURE__*/_jsx(Route,{path:\"\".concat(pathRoot,\"schedules/:id/edit\"),children:/*#__PURE__*/_jsx(ScheduleEdit,{hasDaysToKeepField:hasDaysToKeepField,schedule:schedule,resource:resource,launchConfig:launchConfig,surveyConfig:surveyConfig,resourceDefaultCredentials:resourceDefaultCredentials})},\"edit\"),/*#__PURE__*/_jsx(Route,{path:\"\".concat(pathRoot,\"schedules/:scheduleId/details\"),children:/*#__PURE__*/_jsx(ScheduleDetail,{hasDaysToKeepField:hasDaysToKeepField,schedule:schedule,surveyConfig:surveyConfig})},\"details\")],/*#__PURE__*/_jsx(Route,{path:\"*\",children:/*#__PURE__*/_jsx(ContentError,{children:resource&&/*#__PURE__*/_jsx(Link,{to:\"\".concat(pathRoot,\"details\"),children:/*i18n*/i18n._(\"View Details\")})})},\"not-found\")]})]});}export{Schedule as _Schedule};export default Schedule;","map":{"version":3,"names":["React","useEffect","useCallback","Switch","Route","Link","Redirect","useLocation","useParams","CaretLeftIcon","SchedulesAPI","useRequest","RoutedTabs","ContentError","ContentLoading","ScheduleDetail","ScheduleEdit","jsx","_jsx","Fragment","_Fragment","jsxs","_jsxs","Schedule","_ref","_schedule$summary_fie","_schedule$summary_fie2","setBreadcrumb","resource","launchConfig","surveyConfig","hasDaysToKeepField","resourceDefaultCredentials","_useParams","scheduleId","_useLocation","pathname","pathRoot","substr","indexOf","_useRequest","_asyncToGenerator","_regeneratorRuntime","mark","_callee","_yield$SchedulesAPI$r","data","wrap","_callee$","_context","prev","next","readDetail","sent","abrupt","stop","isLoading","error","loadData","request","schedule","result","tabsArray","name","children","i18n","_","link","concat","id","isNotFound","response","status","to","summary_fields","unified_job_template","parseInt","showCardHeader","includes","endsWith","from","exact","path","_Schedule"],"sources":["/awx_devel/awx/ui/src/components/Schedule/Schedule.js"],"sourcesContent":["import React, { useEffect, useCallback } from 'react';\nimport { t } from '@lingui/macro';\n\nimport {\n  Switch,\n  Route,\n  Link,\n  Redirect,\n  useLocation,\n  useParams,\n} from 'react-router-dom';\nimport { CaretLeftIcon } from '@patternfly/react-icons';\nimport { SchedulesAPI } from 'api';\nimport useRequest from 'hooks/useRequest';\nimport RoutedTabs from '../RoutedTabs';\nimport ContentError from '../ContentError';\nimport ContentLoading from '../ContentLoading';\nimport ScheduleDetail from './ScheduleDetail';\nimport ScheduleEdit from './ScheduleEdit';\n\nfunction Schedule({\n  setBreadcrumb,\n  resource,\n  launchConfig,\n  surveyConfig,\n  hasDaysToKeepField,\n  resourceDefaultCredentials,\n}) {\n  const { scheduleId } = useParams();\n\n  const { pathname } = useLocation();\n\n  const pathRoot = pathname.substr(0, pathname.indexOf('schedules'));\n\n  const {\n    isLoading,\n    error,\n    request: loadData,\n    result: schedule,\n  } = useRequest(\n    useCallback(async () => {\n      const { data } = await SchedulesAPI.readDetail(scheduleId);\n\n      return data;\n    }, [scheduleId]),\n    null\n  );\n\n  useEffect(() => {\n    loadData();\n  }, [loadData, pathname]);\n\n  useEffect(() => {\n    if (schedule) {\n      setBreadcrumb(resource, schedule);\n    }\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [schedule, resource]);\n  const tabsArray = [\n    {\n      name: (\n        <>\n          <CaretLeftIcon />\n          {t`Back to Schedules`}\n        </>\n      ),\n      link: `${pathRoot}schedules`,\n      id: 99,\n    },\n    {\n      name: t`Details`,\n      link: `${pathRoot}schedules/${schedule && schedule.id}/details`,\n      id: 0,\n    },\n  ];\n\n  if (!isLoading && error) {\n    return (\n      <ContentError isNotFound error={error}>\n        {error.response && error.response.status === 404 && (\n          <span>\n            {t`Schedule not found.`}{' '}\n            <Link to={`${pathRoot}schedules`}>{t`View Schedules`}</Link>\n          </span>\n        )}\n      </ContentError>\n    );\n  }\n\n  if (isLoading || !schedule?.summary_fields?.unified_job_template?.id) {\n    return <ContentLoading />;\n  }\n\n  if (\n    schedule?.summary_fields.unified_job_template.id !==\n    parseInt(resource.id, 10)\n  ) {\n    return (\n      <ContentError>\n        {schedule && (\n          <Link to={`${pathRoot}schedules`}>{t`View Schedules`}</Link>\n        )}\n      </ContentError>\n    );\n  }\n\n  if (error) {\n    return <ContentError error={error} />;\n  }\n\n  let showCardHeader = true;\n\n  if (!pathname.includes('schedules/') || pathname.endsWith('edit')) {\n    showCardHeader = false;\n  }\n\n  return (\n    <>\n      {showCardHeader && <RoutedTabs tabsArray={tabsArray} />}\n      <Switch>\n        <Redirect\n          from={`${pathRoot}schedules/:scheduleId`}\n          to={`${pathRoot}schedules/:scheduleId/details`}\n          exact\n        />\n        {schedule && [\n          <Route key=\"edit\" path={`${pathRoot}schedules/:id/edit`}>\n            <ScheduleEdit\n              hasDaysToKeepField={hasDaysToKeepField}\n              schedule={schedule}\n              resource={resource}\n              launchConfig={launchConfig}\n              surveyConfig={surveyConfig}\n              resourceDefaultCredentials={resourceDefaultCredentials}\n            />\n          </Route>,\n          <Route\n            key=\"details\"\n            path={`${pathRoot}schedules/:scheduleId/details`}\n          >\n            <ScheduleDetail\n              hasDaysToKeepField={hasDaysToKeepField}\n              schedule={schedule}\n              surveyConfig={surveyConfig}\n            />\n          </Route>,\n        ]}\n        <Route key=\"not-found\" path=\"*\">\n          <ContentError>\n            {resource && (\n              <Link to={`${pathRoot}details`}>{t`View Details`}</Link>\n            )}\n          </ContentError>\n        </Route>\n      </Switch>\n    </>\n  );\n}\n\nexport { Schedule as _Schedule };\nexport default Schedule;\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}