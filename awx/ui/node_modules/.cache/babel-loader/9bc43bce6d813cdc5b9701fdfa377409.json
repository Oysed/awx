{"ast":null,"code":"import _objectSpread from\"/awx_devel/awx/ui/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import _asyncToGenerator from\"/awx_devel/awx/ui/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"/awx_devel/awx/ui/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import _regeneratorRuntime from\"/awx_devel/awx/ui/node_modules/@babel/runtime/regenerator/index.js\";import{i18n}from\"@lingui/core\";import React,{useEffect,useCallback,useState,useRef}from'react';import{DateTime}from'luxon';import{Formik}from'formik';import{RRule}from'rrule';import{Button,Form,ActionGroup}from'@patternfly/react-core';import{Config}from'contexts/Config';import{JobTemplatesAPI,SchedulesAPI,WorkflowJobTemplatesAPI}from'api';import{dateToInputDateTime}from'util/dates';import useRequest from'hooks/useRequest';import{parseVariableField}from'util/yaml';import ContentError from'../../ContentError';import ContentLoading from'../../ContentLoading';import{FormSubmitError}from'../../FormField';import{FormColumnLayout,FormFullWidthLayout}from'../../FormLayout';import SchedulePromptableFields from'./SchedulePromptableFields';import ScheduleFormFields from'./ScheduleFormFields';import UnsupportedScheduleForm from'./UnsupportedScheduleForm';import parseRuleObj,{UnsupportedRRuleError}from'./parseRuleObj';import buildRuleObj from'./buildRuleObj';import buildRuleSet from'./buildRuleSet';import mergeArraysByCredentialType from'./mergeArraysByCredentialType';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var NUM_DAYS_PER_FREQUENCY={week:7,month:31,year:365};function ScheduleForm(_ref){var _launchConfig$variabl;var hasDaysToKeepField=_ref.hasDaysToKeepField,handleCancel=_ref.handleCancel,submitSchedule=_ref.handleSubmit,schedule=_ref.schedule,submitError=_ref.submitError,resource=_ref.resource,launchConfig=_ref.launchConfig,surveyConfig=_ref.surveyConfig,resourceDefaultCredentials=_ref.resourceDefaultCredentials;var _useState=useState(false),_useState2=_slicedToArray(_useState,2),isWizardOpen=_useState2[0],setIsWizardOpen=_useState2[1];var _useState3=useState(false),_useState4=_slicedToArray(_useState3,2),isPromptTouched=_useState4[0],setIsPromptTouched=_useState4[1];var _useState5=useState(false),_useState6=_slicedToArray(_useState5,2),isSaveDisabled=_useState6[0],setIsSaveDisabled=_useState6[1];var originalLabels=useRef([]);var originalInstanceGroups=useRef([]);var rruleError;var now=DateTime.now();var closestQuarterHour=DateTime.fromMillis(Math.ceil(now.ts/900000)*900000);var tomorrow=closestQuarterHour.plus({days:1});var isTemplate=resource.type==='workflow_job_template'||resource.type==='job_template';var _useRequest=useRequest(useCallback(/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var _yield$SchedulesAPI$r,data,creds,allLabels,allInstanceGroups,_yield$SchedulesAPI$r2,results,_yield$SchedulesAPI$r3,_results,_yield$SchedulesAPI$r4,_results2,_yield$JobTemplatesAP,_results3,_yield$WorkflowJobTem,_results4,zones;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return SchedulesAPI.readZoneInfo();case 2:_yield$SchedulesAPI$r=_context.sent;data=_yield$SchedulesAPI$r.data;creds=[];allLabels=[];allInstanceGroups=[];if(!schedule.id){_context.next=28;break;}if(!(resource.type==='job_template'&&launchConfig!==null&&launchConfig!==void 0&&launchConfig.ask_credential_on_launch)){_context.next=14;break;}_context.next=11;return SchedulesAPI.readCredentials(schedule.id);case 11:_yield$SchedulesAPI$r2=_context.sent;results=_yield$SchedulesAPI$r2.data.results;creds=results;case 14:if(!(launchConfig!==null&&launchConfig!==void 0&&launchConfig.ask_labels_on_launch)){_context.next=20;break;}_context.next=17;return SchedulesAPI.readAllLabels(schedule.id);case 17:_yield$SchedulesAPI$r3=_context.sent;_results=_yield$SchedulesAPI$r3.data.results;allLabels=_results;case 20:if(!(resource.type==='job_template'&&launchConfig!==null&&launchConfig!==void 0&&launchConfig.ask_instance_groups_on_launch)){_context.next=26;break;}_context.next=23;return SchedulesAPI.readInstanceGroups(schedule.id);case 23:_yield$SchedulesAPI$r4=_context.sent;_results2=_yield$SchedulesAPI$r4.data.results;allInstanceGroups=_results2;case 26:_context.next=41;break;case 28:if(!(resource.type==='job_template')){_context.next=35;break;}if(!(launchConfig!==null&&launchConfig!==void 0&&launchConfig.ask_labels_on_launch)){_context.next=35;break;}_context.next=32;return JobTemplatesAPI.readAllLabels(resource.id);case 32:_yield$JobTemplatesAP=_context.sent;_results3=_yield$JobTemplatesAP.data.results;allLabels=_results3;case 35:if(!(resource.type==='workflow_job_template'&&launchConfig!==null&&launchConfig!==void 0&&launchConfig.ask_labels_on_launch)){_context.next=41;break;}_context.next=38;return WorkflowJobTemplatesAPI.readAllLabels(resource.id);case 38:_yield$WorkflowJobTem=_context.sent;_results4=_yield$WorkflowJobTem.data.results;allLabels=_results4;case 41:zones=(data.zones||[]).map(function(zone){return{value:zone,key:zone,label:zone};});originalLabels.current=allLabels;originalInstanceGroups.current=allInstanceGroups;return _context.abrupt(\"return\",{zoneOptions:zones,zoneLinks:data.links,credentials:creds});case 45:case\"end\":return _context.stop();}}},_callee);})),[schedule,resource.id,resource.type,launchConfig]),{zonesOptions:[],zoneLinks:{},credentials:[],isLoading:true}),loadScheduleData=_useRequest.request,contentError=_useRequest.error,contentLoading=_useRequest.isLoading,_useRequest$result=_useRequest.result,zoneOptions=_useRequest$result.zoneOptions,zoneLinks=_useRequest$result.zoneLinks,credentials=_useRequest$result.credentials;useEffect(function(){loadScheduleData();},[loadScheduleData]);var missingRequiredInventory=useCallback(function(){var _schedule$summary_fie,_schedule$summary_fie2;var missingInventory=false;if(launchConfig!==null&&launchConfig!==void 0&&launchConfig.inventory_needed_to_start&&!(schedule!==null&&schedule!==void 0&&(_schedule$summary_fie=schedule.summary_fields)!==null&&_schedule$summary_fie!==void 0&&(_schedule$summary_fie2=_schedule$summary_fie.inventory)!==null&&_schedule$summary_fie2!==void 0&&_schedule$summary_fie2.id)){missingInventory=true;}return missingInventory;},[launchConfig,schedule]);var hasMissingSurveyValue=useCallback(function(){var missingValues=false;if(launchConfig!==null&&launchConfig!==void 0&&launchConfig.survey_enabled){surveyConfig.spec.forEach(function(question){var hasDefaultValue=Boolean(question.default);var hasSchedule=Object.keys(schedule).length;var isRequired=question.required;if(isRequired&&!hasDefaultValue){if(!hasSchedule){missingValues=true;}else{var hasMatchingKey=Object.keys(schedule===null||schedule===void 0?void 0:schedule.extra_data).includes(question.variable);Object.values(schedule===null||schedule===void 0?void 0:schedule.extra_data).forEach(function(value){if(!value||!hasMatchingKey){missingValues=true;}else{missingValues=false;}});if(!Object.values(schedule.extra_data).length){missingValues=true;}}}});}return missingValues;},[launchConfig,schedule,surveyConfig]);var hasCredentialsThatPrompt=useCallback(function(){if(launchConfig!==null&&launchConfig!==void 0&&launchConfig.ask_credential_on_launch){var _launchConfig$default;if(Object.keys(schedule).length>0){var defaultCredsWithoutOverrides=[];var credentialHasOverride=function credentialHasOverride(templateDefaultCred){var hasOverride=false;credentials.forEach(function(nodeCredential){if(templateDefaultCred.credential_type===nodeCredential.credential_type){if(!templateDefaultCred.vault_id&&!nodeCredential.inputs.vault_id||templateDefaultCred.vault_id&&nodeCredential.inputs.vault_id&&templateDefaultCred.vault_id===nodeCredential.inputs.vault_id){hasOverride=true;}}});return hasOverride;};if(resourceDefaultCredentials){resourceDefaultCredentials.forEach(function(defaultCred){if(!credentialHasOverride(defaultCred)){defaultCredsWithoutOverrides.push(defaultCred);}});}return credentials.concat(defaultCredsWithoutOverrides).filter(function(credential){var credentialRequiresPass=false;Object.entries(credential.inputs).forEach(function(_ref3){var _ref4=_slicedToArray(_ref3,2),key=_ref4[0],value=_ref4[1];if(key!=='vault_id'&&value==='ASK'){credentialRequiresPass=true;}});return credentialRequiresPass;}).length>0;}return launchConfig!==null&&launchConfig!==void 0&&(_launchConfig$default=launchConfig.defaults)!==null&&_launchConfig$default!==void 0&&_launchConfig$default.credentials?launchConfig.defaults.credentials.filter(function(credential){return(credential===null||credential===void 0?void 0:credential.passwords_needed.length)>0;}).length>0:false;}return false;},[launchConfig,schedule,credentials,resourceDefaultCredentials]);useEffect(function(){if(isTemplate&&(missingRequiredInventory()||hasMissingSurveyValue()||hasCredentialsThatPrompt())){setIsSaveDisabled(true);}},[isTemplate,hasMissingSurveyValue,missingRequiredInventory,hasCredentialsThatPrompt]);var showPromptButton=false;if(launchConfig&&(launchConfig.ask_inventory_on_launch||launchConfig.ask_variables_on_launch||launchConfig.ask_job_type_on_launch||launchConfig.ask_limit_on_launch||launchConfig.ask_credential_on_launch||launchConfig.ask_scm_branch_on_launch||launchConfig.ask_tags_on_launch||launchConfig.ask_skip_tags_on_launch||launchConfig.ask_execution_environment_on_launch||launchConfig.ask_labels_on_launch||launchConfig.ask_forks_on_launch||launchConfig.ask_job_slice_count_on_launch||launchConfig.ask_timeout_on_launch||launchConfig.ask_instance_groups_on_launch||launchConfig.survey_enabled||launchConfig.inventory_needed_to_start||((_launchConfig$variabl=launchConfig.variables_needed_to_start)===null||_launchConfig$variabl===void 0?void 0:_launchConfig$variabl.length)>0)){showPromptButton=true;}var _dateToInputDateTime=dateToInputDateTime(closestQuarterHour.toISO()),_dateToInputDateTime2=_slicedToArray(_dateToInputDateTime,2),currentDate=_dateToInputDateTime2[0],time=_dateToInputDateTime2[1];var _dateToInputDateTime3=dateToInputDateTime(tomorrow.toISO()),_dateToInputDateTime4=_slicedToArray(_dateToInputDateTime3,1),tomorrowDate=_dateToInputDateTime4[0];var initialFrequencyOptions={minute:{interval:1,end:'never',occurrences:1,endDate:tomorrowDate,endTime:time},hour:{interval:1,end:'never',occurrences:1,endDate:tomorrowDate,endTime:time},day:{interval:1,end:'never',occurrences:1,endDate:tomorrowDate,endTime:time},week:{interval:1,end:'never',occurrences:1,endDate:tomorrowDate,endTime:time,daysOfWeek:[]},month:{interval:1,end:'never',occurrences:1,endDate:tomorrowDate,endTime:time,runOn:'day',runOnTheOccurrence:1,runOnTheDay:'sunday',runOnDayNumber:1},year:{interval:1,end:'never',occurrences:1,endDate:tomorrowDate,endTime:time,runOn:'day',runOnTheOccurrence:1,runOnTheDay:'sunday',runOnTheMonth:1,runOnDayMonth:1,runOnDayNumber:1}};var initialValues={description:schedule.description||'',frequency:[],exceptionFrequency:[],frequencyOptions:initialFrequencyOptions,exceptionOptions:initialFrequencyOptions,name:schedule.name||'',startDate:currentDate,startTime:time,timezone:schedule.timezone||now.zoneName,credentials:mergeArraysByCredentialType(resourceDefaultCredentials,credentials),labels:originalLabels.current,instance_groups:originalInstanceGroups.current};if(hasDaysToKeepField){var initialDaysToKeep=30;if(schedule!==null&&schedule!==void 0&&schedule.extra_data){if(typeof(schedule===null||schedule===void 0?void 0:schedule.extra_data)==='string'&&(schedule===null||schedule===void 0?void 0:schedule.extra_data)!==''){initialDaysToKeep=parseVariableField(schedule===null||schedule===void 0?void 0:schedule.extra_data).days;}if(typeof(schedule===null||schedule===void 0?void 0:schedule.extra_data)==='object'){var _schedule$extra_data;initialDaysToKeep=schedule===null||schedule===void 0?void 0:(_schedule$extra_data=schedule.extra_data)===null||_schedule$extra_data===void 0?void 0:_schedule$extra_data.days;}}initialValues.daysToKeep=initialDaysToKeep;}var overriddenValues={};if(schedule.rrule){try{overriddenValues=parseRuleObj(schedule);}catch(error){if(error instanceof UnsupportedRRuleError){return/*#__PURE__*/_jsx(UnsupportedScheduleForm,{schedule:schedule,handleCancel:handleCancel});}rruleError=error;}}else if(schedule.id){rruleError=new Error(/*i18n*/i18n._(\"Schedule is missing rrule\"));}if(contentError||rruleError){return/*#__PURE__*/_jsx(ContentError,{error:contentError||rruleError});}if(contentLoading){return/*#__PURE__*/_jsx(ContentLoading,{});}var validate=function validate(values){var errors={};values.frequency.forEach(function(freq){var options=values.frequencyOptions[freq];var freqErrors={};if((freq==='month'||freq==='year')&&options.runOn==='day'&&(options.runOnDayNumber<1||options.runOnDayNumber>31)){freqErrors.runOn=/*i18n*/i18n._(\"Please select a day number between 1 and 31.\");}if(options.end==='after'&&!options.occurrences){freqErrors.occurrences=/*i18n*/i18n._(\"Please enter a number of occurrences.\");}if(options.end==='onDate'){if(DateTime.fromFormat(\"\".concat(values.startDate,\" \").concat(values.startTime),'yyyy-LL-dd h:mm a').toMillis()>=DateTime.fromFormat(\"\".concat(options.endDate,\" \").concat(options.endTime),'yyyy-LL-dd h:mm a').toMillis()){freqErrors.endDate=/*i18n*/i18n._(\"Please select an end date/time that comes after the start date/time.\");}if(DateTime.fromISO(options.endDate).diff(DateTime.fromISO(values.startDate),'days').toObject().days<NUM_DAYS_PER_FREQUENCY[freq]){var rule=new RRule(buildRuleObj(_objectSpread({startDate:values.startDate,startTime:values.startTime,frequency:freq},options)));if(rule.all().length===0){errors.startDate=/*i18n*/i18n._(\"Selected date range must have at least 1 schedule occurrence.\");freqErrors.endDate=/*i18n*/i18n._(\"Selected date range must have at least 1 schedule occurrence.\");}}}if(Object.keys(freqErrors).length>0){if(!errors.frequencyOptions){errors.frequencyOptions={};}errors.frequencyOptions[freq]=freqErrors;}});if(values.exceptionFrequency.length>0&&!scheduleHasInstances(values)){errors.exceptionFrequency=/*i18n*/i18n._(\"This schedule has no occurrences due to the selected exceptions.\");}return errors;};return/*#__PURE__*/_jsx(Config,{children:function children(){return/*#__PURE__*/_jsx(Formik,{initialValues:_objectSpread(_objectSpread(_objectSpread({},initialValues),overriddenValues),{},{frequencyOptions:_objectSpread(_objectSpread({},initialValues.frequencyOptions),overriddenValues.frequencyOptions),exceptionOptions:_objectSpread(_objectSpread({},initialValues.exceptionOptions),overriddenValues.exceptionOptions)}),onSubmit:function onSubmit(values){submitSchedule(values,launchConfig,surveyConfig,originalInstanceGroups.current,originalLabels.current,credentials,isPromptTouched);},validate:validate,children:function children(formik){return/*#__PURE__*/_jsx(Form,{autoComplete:\"off\",onSubmit:formik.handleSubmit,children:/*#__PURE__*/_jsxs(FormColumnLayout,{children:[/*#__PURE__*/_jsx(ScheduleFormFields,{hasDaysToKeepField:hasDaysToKeepField,zoneOptions:zoneOptions,zoneLinks:zoneLinks}),isWizardOpen&&/*#__PURE__*/_jsx(SchedulePromptableFields,{schedule:schedule,credentials:credentials,surveyConfig:surveyConfig,launchConfig:launchConfig,resource:resource,onCloseWizard:function onCloseWizard(){setIsWizardOpen(false);},onSave:function onSave(){setIsWizardOpen(false);setIsSaveDisabled(false);setIsPromptTouched(true);},resourceDefaultCredentials:resourceDefaultCredentials,labels:originalLabels.current,instanceGroups:originalInstanceGroups.current}),/*#__PURE__*/_jsx(FormSubmitError,{error:submitError}),/*#__PURE__*/_jsx(FormFullWidthLayout,{children:/*#__PURE__*/_jsxs(ActionGroup,{children:[/*#__PURE__*/_jsx(Button,{ouiaId:\"schedule-form-save-button\",\"aria-label\":/*i18n*/i18n._(\"Save\"),variant:\"primary\",type:\"button\",onClick:formik.handleSubmit,isDisabled:isSaveDisabled,children:/*i18n*/i18n._(\"Save\")}),isTemplate&&showPromptButton&&/*#__PURE__*/_jsx(Button,{ouiaId:\"schedule-form-prompt-button\",variant:\"secondary\",type:\"button\",\"aria-label\":/*i18n*/i18n._(\"Prompt\"),onClick:function onClick(){return setIsWizardOpen(true);},children:/*i18n*/i18n._(\"Prompt\")}),/*#__PURE__*/_jsx(Button,{ouiaId:\"schedule-form-cancel-button\",\"aria-label\":/*i18n*/i18n._(\"Cancel\"),variant:\"secondary\",type:\"button\",onClick:handleCancel,children:/*i18n*/i18n._(\"Cancel\")})]})})]})});}});}});}ScheduleForm.defaultProps={schedule:{},submitError:null};export default ScheduleForm;function scheduleHasInstances(values){var rangeToCheck=1;values.frequency.forEach(function(freq){if(NUM_DAYS_PER_FREQUENCY[freq]>rangeToCheck){rangeToCheck=NUM_DAYS_PER_FREQUENCY[freq];}});var ruleSet=buildRuleSet(values,true);var startDate=DateTime.fromISO(values.startDate);var endDate=startDate.plus({days:rangeToCheck});var instances=ruleSet.between(startDate.toJSDate(),endDate.toJSDate(),true,function(date,i){return i===0;});return instances.length>0;}","map":{"version":3,"names":["React","useEffect","useCallback","useState","useRef","DateTime","Formik","RRule","Button","Form","ActionGroup","Config","JobTemplatesAPI","SchedulesAPI","WorkflowJobTemplatesAPI","dateToInputDateTime","useRequest","parseVariableField","ContentError","ContentLoading","FormSubmitError","FormColumnLayout","FormFullWidthLayout","SchedulePromptableFields","ScheduleFormFields","UnsupportedScheduleForm","parseRuleObj","UnsupportedRRuleError","buildRuleObj","buildRuleSet","mergeArraysByCredentialType","jsx","_jsx","jsxs","_jsxs","NUM_DAYS_PER_FREQUENCY","week","month","year","ScheduleForm","_ref","_launchConfig$variabl","hasDaysToKeepField","handleCancel","submitSchedule","handleSubmit","schedule","submitError","resource","launchConfig","surveyConfig","resourceDefaultCredentials","_useState","_useState2","_slicedToArray","isWizardOpen","setIsWizardOpen","_useState3","_useState4","isPromptTouched","setIsPromptTouched","_useState5","_useState6","isSaveDisabled","setIsSaveDisabled","originalLabels","originalInstanceGroups","rruleError","now","closestQuarterHour","fromMillis","Math","ceil","ts","tomorrow","plus","days","isTemplate","type","_useRequest","_asyncToGenerator","_regeneratorRuntime","mark","_callee","_yield$SchedulesAPI$r","data","creds","allLabels","allInstanceGroups","_yield$SchedulesAPI$r2","results","_yield$SchedulesAPI$r3","_results","_yield$SchedulesAPI$r4","_results2","_yield$JobTemplatesAP","_results3","_yield$WorkflowJobTem","_results4","zones","wrap","_callee$","_context","prev","next","readZoneInfo","sent","id","ask_credential_on_launch","readCredentials","ask_labels_on_launch","readAllLabels","ask_instance_groups_on_launch","readInstanceGroups","map","zone","value","key","label","current","abrupt","zoneOptions","zoneLinks","links","credentials","stop","zonesOptions","isLoading","loadScheduleData","request","contentError","error","contentLoading","_useRequest$result","result","missingRequiredInventory","_schedule$summary_fie","_schedule$summary_fie2","missingInventory","inventory_needed_to_start","summary_fields","inventory","hasMissingSurveyValue","missingValues","survey_enabled","spec","forEach","question","hasDefaultValue","Boolean","default","hasSchedule","Object","keys","length","isRequired","required","hasMatchingKey","extra_data","includes","variable","values","hasCredentialsThatPrompt","_launchConfig$default","defaultCredsWithoutOverrides","credentialHasOverride","templateDefaultCred","hasOverride","nodeCredential","credential_type","vault_id","inputs","defaultCred","push","concat","filter","credential","credentialRequiresPass","entries","_ref3","_ref4","defaults","passwords_needed","showPromptButton","ask_inventory_on_launch","ask_variables_on_launch","ask_job_type_on_launch","ask_limit_on_launch","ask_scm_branch_on_launch","ask_tags_on_launch","ask_skip_tags_on_launch","ask_execution_environment_on_launch","ask_forks_on_launch","ask_job_slice_count_on_launch","ask_timeout_on_launch","variables_needed_to_start","_dateToInputDateTime","toISO","_dateToInputDateTime2","currentDate","time","_dateToInputDateTime3","_dateToInputDateTime4","tomorrowDate","initialFrequencyOptions","minute","interval","end","occurrences","endDate","endTime","hour","day","daysOfWeek","runOn","runOnTheOccurrence","runOnTheDay","runOnDayNumber","runOnTheMonth","runOnDayMonth","initialValues","description","frequency","exceptionFrequency","frequencyOptions","exceptionOptions","name","startDate","startTime","timezone","zoneName","labels","instance_groups","initialDaysToKeep","_schedule$extra_data","daysToKeep","overriddenValues","rrule","Error","i18n","_","validate","errors","freq","options","freqErrors","fromFormat","toMillis","fromISO","diff","toObject","rule","_objectSpread","all","scheduleHasInstances","children","onSubmit","formik","autoComplete","onCloseWizard","onSave","instanceGroups","ouiaId","variant","onClick","isDisabled","defaultProps","rangeToCheck","ruleSet","instances","between","toJSDate","date","i"],"sources":["/awx_devel/awx/ui/src/components/Schedule/shared/ScheduleForm.js"],"sourcesContent":["import React, { useEffect, useCallback, useState, useRef } from 'react';\nimport { shape, func } from 'prop-types';\nimport { DateTime } from 'luxon';\nimport { t } from '@lingui/macro';\nimport { Formik } from 'formik';\nimport { RRule } from 'rrule';\nimport { Button, Form, ActionGroup } from '@patternfly/react-core';\nimport { Config } from 'contexts/Config';\nimport { JobTemplatesAPI, SchedulesAPI, WorkflowJobTemplatesAPI } from 'api';\nimport { dateToInputDateTime } from 'util/dates';\nimport useRequest from 'hooks/useRequest';\nimport { parseVariableField } from 'util/yaml';\nimport ContentError from '../../ContentError';\nimport ContentLoading from '../../ContentLoading';\nimport { FormSubmitError } from '../../FormField';\nimport { FormColumnLayout, FormFullWidthLayout } from '../../FormLayout';\nimport SchedulePromptableFields from './SchedulePromptableFields';\nimport ScheduleFormFields from './ScheduleFormFields';\nimport UnsupportedScheduleForm from './UnsupportedScheduleForm';\nimport parseRuleObj, { UnsupportedRRuleError } from './parseRuleObj';\nimport buildRuleObj from './buildRuleObj';\nimport buildRuleSet from './buildRuleSet';\nimport mergeArraysByCredentialType from './mergeArraysByCredentialType';\n\nconst NUM_DAYS_PER_FREQUENCY = {\n  week: 7,\n  month: 31,\n  year: 365,\n};\n\nfunction ScheduleForm({\n  hasDaysToKeepField,\n  handleCancel,\n  handleSubmit: submitSchedule,\n  schedule,\n  submitError,\n  resource,\n  launchConfig,\n  surveyConfig,\n  resourceDefaultCredentials,\n}) {\n  const [isWizardOpen, setIsWizardOpen] = useState(false);\n  const [isPromptTouched, setIsPromptTouched] = useState(false);\n  const [isSaveDisabled, setIsSaveDisabled] = useState(false);\n  const originalLabels = useRef([]);\n  const originalInstanceGroups = useRef([]);\n\n  let rruleError;\n  const now = DateTime.now();\n  const closestQuarterHour = DateTime.fromMillis(\n    Math.ceil(now.ts / 900000) * 900000\n  );\n  const tomorrow = closestQuarterHour.plus({ days: 1 });\n  const isTemplate =\n    resource.type === 'workflow_job_template' ||\n    resource.type === 'job_template';\n  const {\n    request: loadScheduleData,\n    error: contentError,\n    isLoading: contentLoading,\n    result: { zoneOptions, zoneLinks, credentials },\n  } = useRequest(\n    useCallback(async () => {\n      const { data } = await SchedulesAPI.readZoneInfo();\n\n      let creds = [];\n      let allLabels = [];\n      let allInstanceGroups = [];\n      if (schedule.id) {\n        if (\n          resource.type === 'job_template' &&\n          launchConfig?.ask_credential_on_launch\n        ) {\n          const {\n            data: { results },\n          } = await SchedulesAPI.readCredentials(schedule.id);\n          creds = results;\n        }\n        if (launchConfig?.ask_labels_on_launch) {\n          const {\n            data: { results },\n          } = await SchedulesAPI.readAllLabels(schedule.id);\n          allLabels = results;\n        }\n        if (\n          resource.type === 'job_template' &&\n          launchConfig?.ask_instance_groups_on_launch\n        ) {\n          const {\n            data: { results },\n          } = await SchedulesAPI.readInstanceGroups(schedule.id);\n          allInstanceGroups = results;\n        }\n      } else {\n        if (resource.type === 'job_template') {\n          if (launchConfig?.ask_labels_on_launch) {\n            const {\n              data: { results },\n            } = await JobTemplatesAPI.readAllLabels(resource.id);\n            allLabels = results;\n          }\n        }\n        if (\n          resource.type === 'workflow_job_template' &&\n          launchConfig?.ask_labels_on_launch\n        ) {\n          const {\n            data: { results },\n          } = await WorkflowJobTemplatesAPI.readAllLabels(resource.id);\n          allLabels = results;\n        }\n      }\n\n      const zones = (data.zones || []).map((zone) => ({\n        value: zone,\n        key: zone,\n        label: zone,\n      }));\n\n      originalLabels.current = allLabels;\n      originalInstanceGroups.current = allInstanceGroups;\n\n      return {\n        zoneOptions: zones,\n        zoneLinks: data.links,\n        credentials: creds,\n      };\n    }, [schedule, resource.id, resource.type, launchConfig]),\n    {\n      zonesOptions: [],\n      zoneLinks: {},\n      credentials: [],\n      isLoading: true,\n    }\n  );\n\n  useEffect(() => {\n    loadScheduleData();\n  }, [loadScheduleData]);\n\n  const missingRequiredInventory = useCallback(() => {\n    let missingInventory = false;\n    if (\n      launchConfig?.inventory_needed_to_start &&\n      !schedule?.summary_fields?.inventory?.id\n    ) {\n      missingInventory = true;\n    }\n    return missingInventory;\n  }, [launchConfig, schedule]);\n\n  const hasMissingSurveyValue = useCallback(() => {\n    let missingValues = false;\n    if (launchConfig?.survey_enabled) {\n      surveyConfig.spec.forEach((question) => {\n        const hasDefaultValue = Boolean(question.default);\n        const hasSchedule = Object.keys(schedule).length;\n        const isRequired = question.required;\n        if (isRequired && !hasDefaultValue) {\n          if (!hasSchedule) {\n            missingValues = true;\n          } else {\n            const hasMatchingKey = Object.keys(schedule?.extra_data).includes(\n              question.variable\n            );\n            Object.values(schedule?.extra_data).forEach((value) => {\n              if (!value || !hasMatchingKey) {\n                missingValues = true;\n              } else {\n                missingValues = false;\n              }\n            });\n            if (!Object.values(schedule.extra_data).length) {\n              missingValues = true;\n            }\n          }\n        }\n      });\n    }\n    return missingValues;\n  }, [launchConfig, schedule, surveyConfig]);\n\n  const hasCredentialsThatPrompt = useCallback(() => {\n    if (launchConfig?.ask_credential_on_launch) {\n      if (Object.keys(schedule).length > 0) {\n        const defaultCredsWithoutOverrides = [];\n\n        const credentialHasOverride = (templateDefaultCred) => {\n          let hasOverride = false;\n          credentials.forEach((nodeCredential) => {\n            if (\n              templateDefaultCred.credential_type ===\n              nodeCredential.credential_type\n            ) {\n              if (\n                (!templateDefaultCred.vault_id &&\n                  !nodeCredential.inputs.vault_id) ||\n                (templateDefaultCred.vault_id &&\n                  nodeCredential.inputs.vault_id &&\n                  templateDefaultCred.vault_id ===\n                    nodeCredential.inputs.vault_id)\n              ) {\n                hasOverride = true;\n              }\n            }\n          });\n\n          return hasOverride;\n        };\n\n        if (resourceDefaultCredentials) {\n          resourceDefaultCredentials.forEach((defaultCred) => {\n            if (!credentialHasOverride(defaultCred)) {\n              defaultCredsWithoutOverrides.push(defaultCred);\n            }\n          });\n        }\n\n        return (\n          credentials\n            .concat(defaultCredsWithoutOverrides)\n            .filter((credential) => {\n              let credentialRequiresPass = false;\n\n              Object.entries(credential.inputs).forEach(([key, value]) => {\n                if (key !== 'vault_id' && value === 'ASK') {\n                  credentialRequiresPass = true;\n                }\n              });\n\n              return credentialRequiresPass;\n            }).length > 0\n        );\n      }\n\n      return launchConfig?.defaults?.credentials\n        ? launchConfig.defaults.credentials.filter(\n            (credential) => credential?.passwords_needed.length > 0\n          ).length > 0\n        : false;\n    }\n\n    return false;\n  }, [launchConfig, schedule, credentials, resourceDefaultCredentials]);\n\n  useEffect(() => {\n    if (\n      isTemplate &&\n      (missingRequiredInventory() ||\n        hasMissingSurveyValue() ||\n        hasCredentialsThatPrompt())\n    ) {\n      setIsSaveDisabled(true);\n    }\n  }, [\n    isTemplate,\n    hasMissingSurveyValue,\n    missingRequiredInventory,\n    hasCredentialsThatPrompt,\n  ]);\n\n  let showPromptButton = false;\n\n  if (\n    launchConfig &&\n    (launchConfig.ask_inventory_on_launch ||\n      launchConfig.ask_variables_on_launch ||\n      launchConfig.ask_job_type_on_launch ||\n      launchConfig.ask_limit_on_launch ||\n      launchConfig.ask_credential_on_launch ||\n      launchConfig.ask_scm_branch_on_launch ||\n      launchConfig.ask_tags_on_launch ||\n      launchConfig.ask_skip_tags_on_launch ||\n      launchConfig.ask_execution_environment_on_launch ||\n      launchConfig.ask_labels_on_launch ||\n      launchConfig.ask_forks_on_launch ||\n      launchConfig.ask_job_slice_count_on_launch ||\n      launchConfig.ask_timeout_on_launch ||\n      launchConfig.ask_instance_groups_on_launch ||\n      launchConfig.survey_enabled ||\n      launchConfig.inventory_needed_to_start ||\n      launchConfig.variables_needed_to_start?.length > 0)\n  ) {\n    showPromptButton = true;\n  }\n  const [currentDate, time] = dateToInputDateTime(closestQuarterHour.toISO());\n\n  const [tomorrowDate] = dateToInputDateTime(tomorrow.toISO());\n  const initialFrequencyOptions = {\n    minute: {\n      interval: 1,\n      end: 'never',\n      occurrences: 1,\n      endDate: tomorrowDate,\n      endTime: time,\n    },\n    hour: {\n      interval: 1,\n      end: 'never',\n      occurrences: 1,\n      endDate: tomorrowDate,\n      endTime: time,\n    },\n    day: {\n      interval: 1,\n      end: 'never',\n      occurrences: 1,\n      endDate: tomorrowDate,\n      endTime: time,\n    },\n    week: {\n      interval: 1,\n      end: 'never',\n      occurrences: 1,\n      endDate: tomorrowDate,\n      endTime: time,\n      daysOfWeek: [],\n    },\n    month: {\n      interval: 1,\n      end: 'never',\n      occurrences: 1,\n      endDate: tomorrowDate,\n      endTime: time,\n      runOn: 'day',\n      runOnTheOccurrence: 1,\n      runOnTheDay: 'sunday',\n      runOnDayNumber: 1,\n    },\n    year: {\n      interval: 1,\n      end: 'never',\n      occurrences: 1,\n      endDate: tomorrowDate,\n      endTime: time,\n      runOn: 'day',\n      runOnTheOccurrence: 1,\n      runOnTheDay: 'sunday',\n      runOnTheMonth: 1,\n      runOnDayMonth: 1,\n      runOnDayNumber: 1,\n    },\n  };\n\n  const initialValues = {\n    description: schedule.description || '',\n    frequency: [],\n    exceptionFrequency: [],\n    frequencyOptions: initialFrequencyOptions,\n    exceptionOptions: initialFrequencyOptions,\n    name: schedule.name || '',\n    startDate: currentDate,\n    startTime: time,\n    timezone: schedule.timezone || now.zoneName,\n    credentials: mergeArraysByCredentialType(\n      resourceDefaultCredentials,\n      credentials\n    ),\n    labels: originalLabels.current,\n    instance_groups: originalInstanceGroups.current,\n  };\n\n  if (hasDaysToKeepField) {\n    let initialDaysToKeep = 30;\n    if (schedule?.extra_data) {\n      if (\n        typeof schedule?.extra_data === 'string' &&\n        schedule?.extra_data !== ''\n      ) {\n        initialDaysToKeep = parseVariableField(schedule?.extra_data).days;\n      }\n      if (typeof schedule?.extra_data === 'object') {\n        initialDaysToKeep = schedule?.extra_data?.days;\n      }\n    }\n    initialValues.daysToKeep = initialDaysToKeep;\n  }\n\n  let overriddenValues = {};\n  if (schedule.rrule) {\n    try {\n      overriddenValues = parseRuleObj(schedule);\n    } catch (error) {\n      if (error instanceof UnsupportedRRuleError) {\n        return (\n          <UnsupportedScheduleForm\n            schedule={schedule}\n            handleCancel={handleCancel}\n          />\n        );\n      }\n      rruleError = error;\n    }\n  } else if (schedule.id) {\n    rruleError = new Error(t`Schedule is missing rrule`);\n  }\n\n  if (contentError || rruleError) {\n    return <ContentError error={contentError || rruleError} />;\n  }\n\n  if (contentLoading) {\n    return <ContentLoading />;\n  }\n\n  const validate = (values) => {\n    const errors = {};\n\n    values.frequency.forEach((freq) => {\n      const options = values.frequencyOptions[freq];\n      const freqErrors = {};\n\n      if (\n        (freq === 'month' || freq === 'year') &&\n        options.runOn === 'day' &&\n        (options.runOnDayNumber < 1 || options.runOnDayNumber > 31)\n      ) {\n        freqErrors.runOn = t`Please select a day number between 1 and 31.`;\n      }\n\n      if (options.end === 'after' && !options.occurrences) {\n        freqErrors.occurrences = t`Please enter a number of occurrences.`;\n      }\n\n      if (options.end === 'onDate') {\n        if (\n          DateTime.fromFormat(\n            `${values.startDate} ${values.startTime}`,\n            'yyyy-LL-dd h:mm a'\n          ).toMillis() >=\n          DateTime.fromFormat(\n            `${options.endDate} ${options.endTime}`,\n            'yyyy-LL-dd h:mm a'\n          ).toMillis()\n        ) {\n          freqErrors.endDate = t`Please select an end date/time that comes after the start date/time.`;\n        }\n\n        if (\n          DateTime.fromISO(options.endDate)\n            .diff(DateTime.fromISO(values.startDate), 'days')\n            .toObject().days < NUM_DAYS_PER_FREQUENCY[freq]\n        ) {\n          const rule = new RRule(\n            buildRuleObj({\n              startDate: values.startDate,\n              startTime: values.startTime,\n              frequency: freq,\n              ...options,\n            })\n          );\n          if (rule.all().length === 0) {\n            errors.startDate = t`Selected date range must have at least 1 schedule occurrence.`;\n            freqErrors.endDate = t`Selected date range must have at least 1 schedule occurrence.`;\n          }\n        }\n      }\n      if (Object.keys(freqErrors).length > 0) {\n        if (!errors.frequencyOptions) {\n          errors.frequencyOptions = {};\n        }\n        errors.frequencyOptions[freq] = freqErrors;\n      }\n    });\n\n    if (values.exceptionFrequency.length > 0 && !scheduleHasInstances(values)) {\n      errors.exceptionFrequency = t`This schedule has no occurrences due to the selected exceptions.`;\n    }\n\n    return errors;\n  };\n\n  return (\n    <Config>\n      {() => (\n        <Formik\n          initialValues={{\n            ...initialValues,\n            ...overriddenValues,\n            frequencyOptions: {\n              ...initialValues.frequencyOptions,\n              ...overriddenValues.frequencyOptions,\n            },\n            exceptionOptions: {\n              ...initialValues.exceptionOptions,\n              ...overriddenValues.exceptionOptions,\n            },\n          }}\n          onSubmit={(values) => {\n            submitSchedule(\n              values,\n              launchConfig,\n              surveyConfig,\n              originalInstanceGroups.current,\n              originalLabels.current,\n              credentials,\n              isPromptTouched\n            );\n          }}\n          validate={validate}\n        >\n          {(formik) => (\n            <Form autoComplete=\"off\" onSubmit={formik.handleSubmit}>\n              <FormColumnLayout>\n                <ScheduleFormFields\n                  hasDaysToKeepField={hasDaysToKeepField}\n                  zoneOptions={zoneOptions}\n                  zoneLinks={zoneLinks}\n                />\n                {isWizardOpen && (\n                  <SchedulePromptableFields\n                    schedule={schedule}\n                    credentials={credentials}\n                    surveyConfig={surveyConfig}\n                    launchConfig={launchConfig}\n                    resource={resource}\n                    onCloseWizard={() => {\n                      setIsWizardOpen(false);\n                    }}\n                    onSave={() => {\n                      setIsWizardOpen(false);\n                      setIsSaveDisabled(false);\n                      setIsPromptTouched(true);\n                    }}\n                    resourceDefaultCredentials={resourceDefaultCredentials}\n                    labels={originalLabels.current}\n                    instanceGroups={originalInstanceGroups.current}\n                  />\n                )}\n                <FormSubmitError error={submitError} />\n                <FormFullWidthLayout>\n                  <ActionGroup>\n                    <Button\n                      ouiaId=\"schedule-form-save-button\"\n                      aria-label={t`Save`}\n                      variant=\"primary\"\n                      type=\"button\"\n                      onClick={formik.handleSubmit}\n                      isDisabled={isSaveDisabled}\n                    >\n                      {t`Save`}\n                    </Button>\n\n                    {isTemplate && showPromptButton && (\n                      <Button\n                        ouiaId=\"schedule-form-prompt-button\"\n                        variant=\"secondary\"\n                        type=\"button\"\n                        aria-label={t`Prompt`}\n                        onClick={() => setIsWizardOpen(true)}\n                      >\n                        {t`Prompt`}\n                      </Button>\n                    )}\n                    <Button\n                      ouiaId=\"schedule-form-cancel-button\"\n                      aria-label={t`Cancel`}\n                      variant=\"secondary\"\n                      type=\"button\"\n                      onClick={handleCancel}\n                    >\n                      {t`Cancel`}\n                    </Button>\n                  </ActionGroup>\n                </FormFullWidthLayout>\n              </FormColumnLayout>\n            </Form>\n          )}\n        </Formik>\n      )}\n    </Config>\n  );\n}\n\nScheduleForm.propTypes = {\n  handleCancel: func.isRequired,\n  handleSubmit: func.isRequired,\n  schedule: shape({}),\n  submitError: shape(),\n};\n\nScheduleForm.defaultProps = {\n  schedule: {},\n  submitError: null,\n};\n\nexport default ScheduleForm;\n\nfunction scheduleHasInstances(values) {\n  let rangeToCheck = 1;\n  values.frequency.forEach((freq) => {\n    if (NUM_DAYS_PER_FREQUENCY[freq] > rangeToCheck) {\n      rangeToCheck = NUM_DAYS_PER_FREQUENCY[freq];\n    }\n  });\n\n  const ruleSet = buildRuleSet(values, true);\n  const startDate = DateTime.fromISO(values.startDate);\n  const endDate = startDate.plus({ days: rangeToCheck });\n  const instances = ruleSet.between(\n    startDate.toJSDate(),\n    endDate.toJSDate(),\n    true,\n    (date, i) => i === 0\n  );\n\n  return instances.length > 0;\n}\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}