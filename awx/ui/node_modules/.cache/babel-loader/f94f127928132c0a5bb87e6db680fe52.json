{"ast":null,"code":"import*as d3 from'd3';import{getWidth,getHeight}from'./helpers';/**\n * useZoom provides a collection of zoom behaviors/functions for D3 graphs\n * Params: string value of parent and child classnames\n * The following hierarchy should be followed:\n * <div id=\"chart\">\n *  <svg><-- parent -->\n *    <g><-- child -->\n *  </svg>\n * </div>\n * Returns: {\n *  zoom: d3 zoom behavior/object/function to apply on selected elements\n *  zoomIn: function that zooms in\n *  zoomOut: function that zooms out\n *  zoomFit: function that scales child element to fit within parent element\n *  resetZoom: function resets the zoom level to its initial value\n * }\n */export default function useZoom(parentSelector,childSelector){if(typeof parentSelector!=='string'&&typeof childSelector!=='string'){return false;}var zoom=d3.zoom().on('zoom',function(_ref){var transform=_ref.transform;d3.select(childSelector).attr('transform',transform);});var zoomIn=function zoomIn(){d3.select(parentSelector).transition().call(zoom.scaleBy,2);};var zoomOut=function zoomOut(){d3.select(parentSelector).transition().call(zoom.scaleBy,0.5);};var resetZoom=function resetZoom(){var parent=d3.select(parentSelector).node();var width=parent.clientWidth;var height=parent.clientHeight;d3.select(parentSelector).transition().duration(750).call(zoom.transform,d3.zoomIdentity,d3.zoomTransform(d3.select(parentSelector).node()).invert([width/2,height/2]));};var zoomFit=function zoomFit(){var bounds=d3.select(childSelector).node().getBBox();var fullWidth=getWidth(parentSelector);var fullHeight=getHeight(parentSelector);var width=bounds.width,height=bounds.height;var midX=bounds.x+width/2;var midY=bounds.y+height/2;if(width===0||height===0)return;// nothing to fit\nvar scale=0.8/Math.max(width/fullWidth,height/fullHeight);var translate=[fullWidth/2-scale*midX,fullHeight/2-scale*midY];var x=translate[0],y=translate[1];d3.select(parentSelector).transition().duration(750).call(zoom.transform,d3.zoomIdentity.translate(x,y).scale(scale));};return{zoom:zoom,zoomIn:zoomIn,zoomOut:zoomOut,zoomFit:zoomFit,resetZoom:resetZoom};}","map":{"version":3,"names":["d3","getWidth","getHeight","useZoom","parentSelector","childSelector","zoom","on","_ref","transform","select","attr","zoomIn","transition","call","scaleBy","zoomOut","resetZoom","parent","node","width","clientWidth","height","clientHeight","duration","zoomIdentity","zoomTransform","invert","zoomFit","bounds","getBBox","fullWidth","fullHeight","midX","x","midY","y","scale","Math","max","translate"],"sources":["/awx_devel/awx/ui/src/screens/TopologyView/utils/useZoom.js"],"sourcesContent":["import * as d3 from 'd3';\nimport { getWidth, getHeight } from './helpers';\n\n/**\n * useZoom provides a collection of zoom behaviors/functions for D3 graphs\n * Params: string value of parent and child classnames\n * The following hierarchy should be followed:\n * <div id=\"chart\">\n *  <svg><-- parent -->\n *    <g><-- child -->\n *  </svg>\n * </div>\n * Returns: {\n *  zoom: d3 zoom behavior/object/function to apply on selected elements\n *  zoomIn: function that zooms in\n *  zoomOut: function that zooms out\n *  zoomFit: function that scales child element to fit within parent element\n *  resetZoom: function resets the zoom level to its initial value\n * }\n */\n\nexport default function useZoom(parentSelector, childSelector) {\n  if (typeof parentSelector !== 'string' && typeof childSelector !== 'string') {\n    return false;\n  }\n  const zoom = d3.zoom().on('zoom', ({ transform }) => {\n    d3.select(childSelector).attr('transform', transform);\n  });\n  const zoomIn = () => {\n    d3.select(parentSelector).transition().call(zoom.scaleBy, 2);\n  };\n  const zoomOut = () => {\n    d3.select(parentSelector).transition().call(zoom.scaleBy, 0.5);\n  };\n  const resetZoom = () => {\n    const parent = d3.select(parentSelector).node();\n    const width = parent.clientWidth;\n    const height = parent.clientHeight;\n    d3.select(parentSelector)\n      .transition()\n      .duration(750)\n      .call(\n        zoom.transform,\n        d3.zoomIdentity,\n        d3\n          .zoomTransform(d3.select(parentSelector).node())\n          .invert([width / 2, height / 2])\n      );\n  };\n  const zoomFit = () => {\n    const bounds = d3.select(childSelector).node().getBBox();\n    const fullWidth = getWidth(parentSelector);\n    const fullHeight = getHeight(parentSelector);\n    const { width, height } = bounds;\n    const midX = bounds.x + width / 2;\n    const midY = bounds.y + height / 2;\n    if (width === 0 || height === 0) return; // nothing to fit\n    const scale = 0.8 / Math.max(width / fullWidth, height / fullHeight);\n    const translate = [\n      fullWidth / 2 - scale * midX,\n      fullHeight / 2 - scale * midY,\n    ];\n    const [x, y] = translate;\n    d3.select(parentSelector)\n      .transition()\n      .duration(750)\n      .call(zoom.transform, d3.zoomIdentity.translate(x, y).scale(scale));\n  };\n\n  return {\n    zoom,\n    zoomIn,\n    zoomOut,\n    zoomFit,\n    resetZoom,\n  };\n}\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}