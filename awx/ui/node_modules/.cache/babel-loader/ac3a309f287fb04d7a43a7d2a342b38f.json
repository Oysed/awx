{"ast":null,"code":"import _defineProperty from\"/awx_devel/awx/ui/node_modules/@babel/runtime/helpers/esm/defineProperty.js\";import _slicedToArray from\"/awx_devel/awx/ui/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import _objectSpread from\"/awx_devel/awx/ui/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import{i18n}from\"@lingui/core\";import{useContext,useState,useEffect}from'react';import{useFormikContext}from'formik';import useInventoryStep from'components/LaunchPrompt/steps/useInventoryStep';import useCredentialsStep from'components/LaunchPrompt/steps/useCredentialsStep';import useExecutionEnvironmentStep from'components/LaunchPrompt/steps/useExecutionEnvironmentStep';import useOtherPromptsStep from'components/LaunchPrompt/steps/useOtherPromptsStep';import useSurveyStep from'components/LaunchPrompt/steps/useSurveyStep';import usePreviewStep from'components/LaunchPrompt/steps/usePreviewStep';import useInstanceGroupsStep from'components/LaunchPrompt/steps/useInstanceGroupsStep';import{WorkflowStateContext}from'contexts/Workflow';import{jsonToYaml}from'util/yaml';import{stringIsUUID}from'util/strings';import useNodeTypeStep from'./NodeTypeStep/useNodeTypeStep';import useDaysToKeepStep from'./useDaysToKeepStep';import useRunTypeStep from'./useRunTypeStep';function showPreviewStep(nodeType,launchConfig){if(!['workflow_job_template','job_template'].includes(nodeType)||Object.keys(launchConfig).length===0){return false;}return!launchConfig.can_start_without_user_input||launchConfig.ask_inventory_on_launch||launchConfig.ask_variables_on_launch||launchConfig.ask_limit_on_launch||launchConfig.ask_scm_branch_on_launch||launchConfig.ask_execution_environment_on_launch||launchConfig.ask_labels_on_launch||launchConfig.ask_forks_on_launch||launchConfig.ask_job_slice_count_on_launch||launchConfig.ask_timeout_on_launch||launchConfig.ask_instance_groups_on_launch||launchConfig.survey_enabled||launchConfig.variables_needed_to_start&&launchConfig.variables_needed_to_start.length>0;}var getNodeToEditDefaultValues=function getNodeToEditDefaultValues(launchConfig,surveyConfig,nodeToEdit,resourceDefaultCredentials){var _nodeToEdit$originalN,_nodeToEdit$fullUnifi,_nodeToEdit$fullUnifi2,_nodeToEdit$fullUnifi3;var identifier='';if(Object.prototype.hasOwnProperty.call(nodeToEdit,'identifier')&&nodeToEdit.identifier!==null){identifier=nodeToEdit.identifier;}else if(Object.prototype.hasOwnProperty.call(nodeToEdit===null||nodeToEdit===void 0?void 0:nodeToEdit.originalNodeObject,'identifier')&&!stringIsUUID(nodeToEdit===null||nodeToEdit===void 0?void 0:(_nodeToEdit$originalN=nodeToEdit.originalNodeObject)===null||_nodeToEdit$originalN===void 0?void 0:_nodeToEdit$originalN.identifier)){var _nodeToEdit$originalN2;identifier=nodeToEdit===null||nodeToEdit===void 0?void 0:(_nodeToEdit$originalN2=nodeToEdit.originalNodeObject)===null||_nodeToEdit$originalN2===void 0?void 0:_nodeToEdit$originalN2.identifier;}var getConvergence=function getConvergence(){var _nodeToEdit$originalN3;// There is a case where the nodeToEdit convergence value will not align with the\n// original node object value.  This allows the nodeToEdit value to take precedence over the\n// original node object.\nif(nodeToEdit&&Object.prototype.hasOwnProperty.call(nodeToEdit,'all_parents_must_converge')){return nodeToEdit.all_parents_must_converge?'all':'any';}return nodeToEdit!==null&&nodeToEdit!==void 0&&(_nodeToEdit$originalN3=nodeToEdit.originalNodeObject)!==null&&_nodeToEdit$originalN3!==void 0&&_nodeToEdit$originalN3.all_parents_must_converge?'all':'any';};var initialValues={nodeResource:(nodeToEdit===null||nodeToEdit===void 0?void 0:nodeToEdit.fullUnifiedJobTemplate)||null,nodeType:(nodeToEdit===null||nodeToEdit===void 0?void 0:(_nodeToEdit$fullUnifi=nodeToEdit.fullUnifiedJobTemplate)===null||_nodeToEdit$fullUnifi===void 0?void 0:_nodeToEdit$fullUnifi.type)||'job_template',convergence:getConvergence(),identifier:identifier};if((nodeToEdit===null||nodeToEdit===void 0?void 0:(_nodeToEdit$fullUnifi2=nodeToEdit.fullUnifiedJobTemplate)===null||_nodeToEdit$fullUnifi2===void 0?void 0:_nodeToEdit$fullUnifi2.type)==='workflow_approval_template'){var timeout=nodeToEdit.fullUnifiedJobTemplate.timeout||0;initialValues.approvalName=nodeToEdit.fullUnifiedJobTemplate.name||'';initialValues.approvalDescription=nodeToEdit.fullUnifiedJobTemplate.description||'';initialValues.timeoutMinutes=Math.floor(timeout/60);initialValues.timeoutSeconds=timeout-Math.floor(timeout/60)*60;return initialValues;}if((nodeToEdit===null||nodeToEdit===void 0?void 0:(_nodeToEdit$fullUnifi3=nodeToEdit.fullUnifiedJobTemplate)===null||_nodeToEdit$fullUnifi3===void 0?void 0:_nodeToEdit$fullUnifi3.type)==='system_job_template'){var _nodeToEdit$promptVal,_nodeToEdit$originalN4;if(nodeToEdit!==null&&nodeToEdit!==void 0&&(_nodeToEdit$promptVal=nodeToEdit.promptValues)!==null&&_nodeToEdit$promptVal!==void 0&&_nodeToEdit$promptVal.extra_data&&Object.prototype.hasOwnProperty.call(nodeToEdit.promptValues.extra_data,'days')){initialValues.daysToKeep=parseInt(nodeToEdit.promptValues.extra_data.days,10);}else if(nodeToEdit!==null&&nodeToEdit!==void 0&&(_nodeToEdit$originalN4=nodeToEdit.originalNodeObject)!==null&&_nodeToEdit$originalN4!==void 0&&_nodeToEdit$originalN4.extra_data&&Object.prototype.hasOwnProperty.call(nodeToEdit.originalNodeObject.extra_data,'days')){initialValues.daysToKeep=parseInt(nodeToEdit.originalNodeObject.extra_data.days,10);}return initialValues;}if(!launchConfig||launchConfig==={}){return initialValues;}if(launchConfig.ask_inventory_on_launch){var _nodeToEdit$originalN5,_nodeToEdit$originalN6;// We also need to handle the case where the UJT has been deleted.\nif(nodeToEdit!==null&&nodeToEdit!==void 0&&nodeToEdit.promptValues){var _nodeToEdit$promptVal2;initialValues.inventory=nodeToEdit===null||nodeToEdit===void 0?void 0:(_nodeToEdit$promptVal2=nodeToEdit.promptValues)===null||_nodeToEdit$promptVal2===void 0?void 0:_nodeToEdit$promptVal2.inventory;}else if(nodeToEdit!==null&&nodeToEdit!==void 0&&(_nodeToEdit$originalN5=nodeToEdit.originalNodeObject)!==null&&_nodeToEdit$originalN5!==void 0&&(_nodeToEdit$originalN6=_nodeToEdit$originalN5.summary_fields)!==null&&_nodeToEdit$originalN6!==void 0&&_nodeToEdit$originalN6.inventory){var _nodeToEdit$originalN7,_nodeToEdit$originalN8;initialValues.inventory=nodeToEdit===null||nodeToEdit===void 0?void 0:(_nodeToEdit$originalN7=nodeToEdit.originalNodeObject)===null||_nodeToEdit$originalN7===void 0?void 0:(_nodeToEdit$originalN8=_nodeToEdit$originalN7.summary_fields)===null||_nodeToEdit$originalN8===void 0?void 0:_nodeToEdit$originalN8.inventory;}else{initialValues.inventory=null;}}if(launchConfig.ask_execution_environment_on_launch){var _nodeToEdit$originalN9,_nodeToEdit$originalN10;if(nodeToEdit!==null&&nodeToEdit!==void 0&&nodeToEdit.promptValues){var _nodeToEdit$promptVal3;initialValues.execution_environment=nodeToEdit===null||nodeToEdit===void 0?void 0:(_nodeToEdit$promptVal3=nodeToEdit.promptValues)===null||_nodeToEdit$promptVal3===void 0?void 0:_nodeToEdit$promptVal3.execution_environment;}else if(nodeToEdit!==null&&nodeToEdit!==void 0&&(_nodeToEdit$originalN9=nodeToEdit.originalNodeObject)!==null&&_nodeToEdit$originalN9!==void 0&&(_nodeToEdit$originalN10=_nodeToEdit$originalN9.summary_fields)!==null&&_nodeToEdit$originalN10!==void 0&&_nodeToEdit$originalN10.execution_environment){var _nodeToEdit$originalN11,_nodeToEdit$originalN12;initialValues.execution_environment=nodeToEdit===null||nodeToEdit===void 0?void 0:(_nodeToEdit$originalN11=nodeToEdit.originalNodeObject)===null||_nodeToEdit$originalN11===void 0?void 0:(_nodeToEdit$originalN12=_nodeToEdit$originalN11.summary_fields)===null||_nodeToEdit$originalN12===void 0?void 0:_nodeToEdit$originalN12.execution_environment;}else{initialValues.execution_environment=null;}}if(launchConfig.ask_credential_on_launch){var _nodeToEdit$promptVal4;if(nodeToEdit!==null&&nodeToEdit!==void 0&&(_nodeToEdit$promptVal4=nodeToEdit.promptValues)!==null&&_nodeToEdit$promptVal4!==void 0&&_nodeToEdit$promptVal4.credentials){var _nodeToEdit$promptVal5;initialValues.credentials=nodeToEdit===null||nodeToEdit===void 0?void 0:(_nodeToEdit$promptVal5=nodeToEdit.promptValues)===null||_nodeToEdit$promptVal5===void 0?void 0:_nodeToEdit$promptVal5.credentials;}else if(nodeToEdit!==null&&nodeToEdit!==void 0&&nodeToEdit.originalNodeCredentials){var defaultCredsWithoutOverrides=[];var credentialHasOverride=function credentialHasOverride(templateDefaultCred){var hasOverride=false;nodeToEdit.originalNodeCredentials.forEach(function(nodeCredential){if(templateDefaultCred.credential_type===nodeCredential.credential_type){if(!templateDefaultCred.vault_id&&!nodeCredential.inputs.vault_id||templateDefaultCred.vault_id&&nodeCredential.inputs.vault_id&&templateDefaultCred.vault_id===nodeCredential.inputs.vault_id){hasOverride=true;}}});return hasOverride;};if(resourceDefaultCredentials){resourceDefaultCredentials.forEach(function(defaultCred){if(!credentialHasOverride(defaultCred)){defaultCredsWithoutOverrides.push(defaultCred);}});}initialValues.credentials=nodeToEdit.originalNodeCredentials.concat(defaultCredsWithoutOverrides);}else{initialValues.credentials=[];}}var sourceOfValues=(nodeToEdit===null||nodeToEdit===void 0?void 0:nodeToEdit.promptValues)||nodeToEdit.originalNodeObject;if(launchConfig.ask_job_type_on_launch){initialValues.job_type=(sourceOfValues===null||sourceOfValues===void 0?void 0:sourceOfValues.job_type)||'';}if(launchConfig.ask_limit_on_launch){initialValues.limit=(sourceOfValues===null||sourceOfValues===void 0?void 0:sourceOfValues.limit)||'';}if(launchConfig.ask_verbosity_on_launch){initialValues.verbosity=(sourceOfValues===null||sourceOfValues===void 0?void 0:sourceOfValues.verbosity)||0;}if(launchConfig.ask_tags_on_launch){initialValues.job_tags=(sourceOfValues===null||sourceOfValues===void 0?void 0:sourceOfValues.job_tags)||'';}if(launchConfig.ask_skip_tags_on_launch){initialValues.skip_tags=(sourceOfValues===null||sourceOfValues===void 0?void 0:sourceOfValues.skip_tags)||'';}if(launchConfig.ask_scm_branch_on_launch){initialValues.scm_branch=(sourceOfValues===null||sourceOfValues===void 0?void 0:sourceOfValues.scm_branch)||'';}if(launchConfig.ask_diff_mode_on_launch){initialValues.diff_mode=(sourceOfValues===null||sourceOfValues===void 0?void 0:sourceOfValues.diff_mode)||false;}if(launchConfig.ask_forks_on_launch){initialValues.forks=(sourceOfValues===null||sourceOfValues===void 0?void 0:sourceOfValues.forks)||0;}if(launchConfig.ask_job_slice_count_on_launch){initialValues.job_slice_count=(sourceOfValues===null||sourceOfValues===void 0?void 0:sourceOfValues.job_slice_count)||1;}if(launchConfig.ask_timeout_on_launch){initialValues.timeout=(sourceOfValues===null||sourceOfValues===void 0?void 0:sourceOfValues.timeout)||0;}if(launchConfig.ask_labels_on_launch){initialValues.labels=(sourceOfValues===null||sourceOfValues===void 0?void 0:sourceOfValues.labels)||[];}if(launchConfig.ask_instance_groups_on_launch){initialValues.instance_groups=(sourceOfValues===null||sourceOfValues===void 0?void 0:sourceOfValues.instance_groups)||[];}if(launchConfig.ask_variables_on_launch){var newExtraData=_objectSpread({},sourceOfValues.extra_data);if(launchConfig.survey_enabled&&surveyConfig.spec){surveyConfig.spec.forEach(function(question){if(Object.prototype.hasOwnProperty.call(newExtraData,question.variable)){delete newExtraData[question.variable];}});}initialValues.extra_vars=jsonToYaml(JSON.stringify(newExtraData));}if(surveyConfig!==null&&surveyConfig!==void 0&&surveyConfig.spec){surveyConfig.spec.forEach(function(question){if(question.type==='multiselect'){initialValues[\"survey_\".concat(question.variable)]=question.default.split('\\n');}else{initialValues[\"survey_\".concat(question.variable)]=question.default;}if(sourceOfValues!==null&&sourceOfValues!==void 0&&sourceOfValues.extra_data){Object.entries(sourceOfValues===null||sourceOfValues===void 0?void 0:sourceOfValues.extra_data).forEach(function(_ref){var _ref2=_slicedToArray(_ref,2),key=_ref2[0],value=_ref2[1];if(key===question.variable){if(question.type==='multiselect'){initialValues[\"survey_\".concat(question.variable)]=value;}else{initialValues[\"survey_\".concat(question.variable)]=value;}}});}});}return initialValues;};export default function useWorkflowNodeSteps(launchConfig,surveyConfig,resource,askLinkType,resourceDefaultCredentials,labels,instanceGroups){var _useContext=useContext(WorkflowStateContext),nodeToEdit=_useContext.nodeToEdit;var _useFormikContext=useFormikContext(),resetForm=_useFormikContext.resetForm,formikValues=_useFormikContext.values,formikErrors=_useFormikContext.errors;var _useState=useState({}),_useState2=_slicedToArray(_useState,2),visited=_useState2[0],setVisited=_useState2[1];var steps=[useRunTypeStep(askLinkType),useNodeTypeStep(launchConfig),useDaysToKeepStep(),useInventoryStep(launchConfig,resource,visited),useCredentialsStep(launchConfig,resource,resourceDefaultCredentials),useExecutionEnvironmentStep(launchConfig,resource),useInstanceGroupsStep(launchConfig,resource,instanceGroups),useOtherPromptsStep(launchConfig,resource,labels),useSurveyStep(launchConfig,surveyConfig,resource,visited)];var hasErrors=steps.some(function(step){return step.hasError;});steps.push(usePreviewStep(launchConfig,resource,surveyConfig,hasErrors,showPreviewStep(formikValues.nodeType,launchConfig)));var pfSteps=steps.map(function(s){return s.step;}).filter(function(s){return s!=null;});var isReady=!steps.some(function(s){return!s.isReady;});useEffect(function(){if(launchConfig&&surveyConfig&&isReady){var _nodeToEdit$fullUnifi4,_formikValues$nodeRes,_launchConfig$passwor,_initialValues,_initialValues$verbos;var initialValues={};if(nodeToEdit&&nodeToEdit!==null&&nodeToEdit!==void 0&&nodeToEdit.fullUnifiedJobTemplate&&(nodeToEdit===null||nodeToEdit===void 0?void 0:(_nodeToEdit$fullUnifi4=nodeToEdit.fullUnifiedJobTemplate)===null||_nodeToEdit$fullUnifi4===void 0?void 0:_nodeToEdit$fullUnifi4.id)===((_formikValues$nodeRes=formikValues.nodeResource)===null||_formikValues$nodeRes===void 0?void 0:_formikValues$nodeRes.id)){initialValues=getNodeToEditDefaultValues(launchConfig,surveyConfig,nodeToEdit,resourceDefaultCredentials);}else{initialValues=steps.reduce(function(acc,cur){return _objectSpread(_objectSpread({},acc),cur.initialValues);},{});initialValues.identifier=formikValues.identifier;initialValues.convergence=formikValues.convergence;}var errors=formikErrors.nodeResource?{nodeResource:formikErrors.nodeResource}:{};if(!(launchConfig!==null&&launchConfig!==void 0&&launchConfig.ask_credential_on_launch)&&(launchConfig===null||launchConfig===void 0?void 0:(_launchConfig$passwor=launchConfig.passwords_needed_to_start)===null||_launchConfig$passwor===void 0?void 0:_launchConfig$passwor.length)>0){errors.nodeResource=/*i18n*/i18n._(\"Job Templates with credentials that prompt for passwords cannot be selected when creating or editing nodes\");}resetForm({errors:errors,values:_objectSpread(_objectSpread({},initialValues),{},{nodeResource:formikValues.nodeResource,nodeType:formikValues.nodeType,linkType:formikValues.linkType,verbosity:(_initialValues=initialValues)===null||_initialValues===void 0?void 0:(_initialValues$verbos=_initialValues.verbosity)===null||_initialValues$verbos===void 0?void 0:_initialValues$verbos.toString()})});}// eslint-disable-next-line react-hooks/exhaustive-deps\n},[launchConfig,surveyConfig,isReady]);var stepWithError=steps.find(function(s){return s.contentError;});var contentError=stepWithError?stepWithError.contentError:null;return{steps:pfSteps,validateStep:function validateStep(stepId){steps.find(function(s){var _s$step;return(s===null||s===void 0?void 0:(_s$step=s.step)===null||_s$step===void 0?void 0:_s$step.id)===stepId;}).validate();},visitStep:function visitStep(prevStepId,setFieldTouched){setVisited(_objectSpread(_objectSpread({},visited),{},_defineProperty({},prevStepId,true)));steps.find(function(s){var _s$step2;return(s===null||s===void 0?void 0:(_s$step2=s.step)===null||_s$step2===void 0?void 0:_s$step2.id)===prevStepId;}).setTouched(setFieldTouched);},visitAllSteps:function visitAllSteps(setFieldTouched){setVisited({inventory:true,credentials:true,executionEnvironment:true,instanceGroups:true,other:true,survey:true,preview:true});steps.forEach(function(s){return s.setTouched(setFieldTouched);});},contentError:contentError};}","map":{"version":3,"names":["useContext","useState","useEffect","useFormikContext","useInventoryStep","useCredentialsStep","useExecutionEnvironmentStep","useOtherPromptsStep","useSurveyStep","usePreviewStep","useInstanceGroupsStep","WorkflowStateContext","jsonToYaml","stringIsUUID","useNodeTypeStep","useDaysToKeepStep","useRunTypeStep","showPreviewStep","nodeType","launchConfig","includes","Object","keys","length","can_start_without_user_input","ask_inventory_on_launch","ask_variables_on_launch","ask_limit_on_launch","ask_scm_branch_on_launch","ask_execution_environment_on_launch","ask_labels_on_launch","ask_forks_on_launch","ask_job_slice_count_on_launch","ask_timeout_on_launch","ask_instance_groups_on_launch","survey_enabled","variables_needed_to_start","getNodeToEditDefaultValues","surveyConfig","nodeToEdit","resourceDefaultCredentials","_nodeToEdit$originalN","_nodeToEdit$fullUnifi","_nodeToEdit$fullUnifi2","_nodeToEdit$fullUnifi3","identifier","prototype","hasOwnProperty","call","originalNodeObject","_nodeToEdit$originalN2","getConvergence","_nodeToEdit$originalN3","all_parents_must_converge","initialValues","nodeResource","fullUnifiedJobTemplate","type","convergence","timeout","approvalName","name","approvalDescription","description","timeoutMinutes","Math","floor","timeoutSeconds","_nodeToEdit$promptVal","_nodeToEdit$originalN4","promptValues","extra_data","daysToKeep","parseInt","days","_nodeToEdit$originalN5","_nodeToEdit$originalN6","_nodeToEdit$promptVal2","inventory","summary_fields","_nodeToEdit$originalN7","_nodeToEdit$originalN8","_nodeToEdit$originalN9","_nodeToEdit$originalN10","_nodeToEdit$promptVal3","execution_environment","_nodeToEdit$originalN11","_nodeToEdit$originalN12","ask_credential_on_launch","_nodeToEdit$promptVal4","credentials","_nodeToEdit$promptVal5","originalNodeCredentials","defaultCredsWithoutOverrides","credentialHasOverride","templateDefaultCred","hasOverride","forEach","nodeCredential","credential_type","vault_id","inputs","defaultCred","push","concat","sourceOfValues","ask_job_type_on_launch","job_type","limit","ask_verbosity_on_launch","verbosity","ask_tags_on_launch","job_tags","ask_skip_tags_on_launch","skip_tags","scm_branch","ask_diff_mode_on_launch","diff_mode","forks","job_slice_count","labels","instance_groups","newExtraData","_objectSpread","spec","question","variable","extra_vars","JSON","stringify","default","split","entries","_ref","_ref2","_slicedToArray","key","value","useWorkflowNodeSteps","resource","askLinkType","instanceGroups","_useContext","_useFormikContext","resetForm","formikValues","values","formikErrors","errors","_useState","_useState2","visited","setVisited","steps","hasErrors","some","step","hasError","pfSteps","map","s","filter","isReady","_nodeToEdit$fullUnifi4","_formikValues$nodeRes","_launchConfig$passwor","_initialValues","_initialValues$verbos","id","reduce","acc","cur","passwords_needed_to_start","i18n","_","linkType","toString","stepWithError","find","contentError","validateStep","stepId","_s$step","validate","visitStep","prevStepId","setFieldTouched","_defineProperty","_s$step2","setTouched","visitAllSteps","executionEnvironment","other","survey","preview"],"sources":["/awx_devel/awx/ui/src/screens/Template/WorkflowJobTemplateVisualizer/Modals/NodeModals/useWorkflowNodeSteps.js"],"sourcesContent":["import { useContext, useState, useEffect } from 'react';\nimport { useFormikContext } from 'formik';\nimport { t } from '@lingui/macro';\nimport useInventoryStep from 'components/LaunchPrompt/steps/useInventoryStep';\nimport useCredentialsStep from 'components/LaunchPrompt/steps/useCredentialsStep';\nimport useExecutionEnvironmentStep from 'components/LaunchPrompt/steps/useExecutionEnvironmentStep';\nimport useOtherPromptsStep from 'components/LaunchPrompt/steps/useOtherPromptsStep';\nimport useSurveyStep from 'components/LaunchPrompt/steps/useSurveyStep';\nimport usePreviewStep from 'components/LaunchPrompt/steps/usePreviewStep';\nimport useInstanceGroupsStep from 'components/LaunchPrompt/steps/useInstanceGroupsStep';\nimport { WorkflowStateContext } from 'contexts/Workflow';\nimport { jsonToYaml } from 'util/yaml';\nimport { stringIsUUID } from 'util/strings';\nimport useNodeTypeStep from './NodeTypeStep/useNodeTypeStep';\nimport useDaysToKeepStep from './useDaysToKeepStep';\nimport useRunTypeStep from './useRunTypeStep';\n\nfunction showPreviewStep(nodeType, launchConfig) {\n  if (\n    !['workflow_job_template', 'job_template'].includes(nodeType) ||\n    Object.keys(launchConfig).length === 0\n  ) {\n    return false;\n  }\n  return (\n    !launchConfig.can_start_without_user_input ||\n    launchConfig.ask_inventory_on_launch ||\n    launchConfig.ask_variables_on_launch ||\n    launchConfig.ask_limit_on_launch ||\n    launchConfig.ask_scm_branch_on_launch ||\n    launchConfig.ask_execution_environment_on_launch ||\n    launchConfig.ask_labels_on_launch ||\n    launchConfig.ask_forks_on_launch ||\n    launchConfig.ask_job_slice_count_on_launch ||\n    launchConfig.ask_timeout_on_launch ||\n    launchConfig.ask_instance_groups_on_launch ||\n    launchConfig.survey_enabled ||\n    (launchConfig.variables_needed_to_start &&\n      launchConfig.variables_needed_to_start.length > 0)\n  );\n}\n\nconst getNodeToEditDefaultValues = (\n  launchConfig,\n  surveyConfig,\n  nodeToEdit,\n  resourceDefaultCredentials\n) => {\n  let identifier = '';\n  if (\n    Object.prototype.hasOwnProperty.call(nodeToEdit, 'identifier') &&\n    nodeToEdit.identifier !== null\n  ) {\n    ({ identifier } = nodeToEdit);\n  } else if (\n    Object.prototype.hasOwnProperty.call(\n      nodeToEdit?.originalNodeObject,\n      'identifier'\n    ) &&\n    !stringIsUUID(nodeToEdit?.originalNodeObject?.identifier)\n  ) {\n    identifier = nodeToEdit?.originalNodeObject?.identifier;\n  }\n\n  const getConvergence = () => {\n    // There is a case where the nodeToEdit convergence value will not align with the\n    // original node object value.  This allows the nodeToEdit value to take precedence over the\n    // original node object.\n    if (\n      nodeToEdit &&\n      Object.prototype.hasOwnProperty.call(\n        nodeToEdit,\n        'all_parents_must_converge'\n      )\n    ) {\n      return nodeToEdit.all_parents_must_converge ? 'all' : 'any';\n    }\n    return nodeToEdit?.originalNodeObject?.all_parents_must_converge\n      ? 'all'\n      : 'any';\n  };\n  const initialValues = {\n    nodeResource: nodeToEdit?.fullUnifiedJobTemplate || null,\n    nodeType: nodeToEdit?.fullUnifiedJobTemplate?.type || 'job_template',\n    convergence: getConvergence(),\n    identifier,\n  };\n\n  if (\n    nodeToEdit?.fullUnifiedJobTemplate?.type === 'workflow_approval_template'\n  ) {\n    const timeout = nodeToEdit.fullUnifiedJobTemplate.timeout || 0;\n    initialValues.approvalName = nodeToEdit.fullUnifiedJobTemplate.name || '';\n    initialValues.approvalDescription =\n      nodeToEdit.fullUnifiedJobTemplate.description || '';\n    initialValues.timeoutMinutes = Math.floor(timeout / 60);\n    initialValues.timeoutSeconds = timeout - Math.floor(timeout / 60) * 60;\n\n    return initialValues;\n  }\n\n  if (nodeToEdit?.fullUnifiedJobTemplate?.type === 'system_job_template') {\n    if (\n      nodeToEdit?.promptValues?.extra_data &&\n      Object.prototype.hasOwnProperty.call(\n        nodeToEdit.promptValues.extra_data,\n        'days'\n      )\n    ) {\n      initialValues.daysToKeep = parseInt(\n        nodeToEdit.promptValues.extra_data.days,\n        10\n      );\n    } else if (\n      nodeToEdit?.originalNodeObject?.extra_data &&\n      Object.prototype.hasOwnProperty.call(\n        nodeToEdit.originalNodeObject.extra_data,\n        'days'\n      )\n    ) {\n      initialValues.daysToKeep = parseInt(\n        nodeToEdit.originalNodeObject.extra_data.days,\n        10\n      );\n    }\n\n    return initialValues;\n  }\n\n  if (!launchConfig || launchConfig === {}) {\n    return initialValues;\n  }\n\n  if (launchConfig.ask_inventory_on_launch) {\n    // We also need to handle the case where the UJT has been deleted.\n    if (nodeToEdit?.promptValues) {\n      initialValues.inventory = nodeToEdit?.promptValues?.inventory;\n    } else if (nodeToEdit?.originalNodeObject?.summary_fields?.inventory) {\n      initialValues.inventory =\n        nodeToEdit?.originalNodeObject?.summary_fields?.inventory;\n    } else {\n      initialValues.inventory = null;\n    }\n  }\n\n  if (launchConfig.ask_execution_environment_on_launch) {\n    if (nodeToEdit?.promptValues) {\n      initialValues.execution_environment =\n        nodeToEdit?.promptValues?.execution_environment;\n    } else if (\n      nodeToEdit?.originalNodeObject?.summary_fields?.execution_environment\n    ) {\n      initialValues.execution_environment =\n        nodeToEdit?.originalNodeObject?.summary_fields?.execution_environment;\n    } else {\n      initialValues.execution_environment = null;\n    }\n  }\n\n  if (launchConfig.ask_credential_on_launch) {\n    if (nodeToEdit?.promptValues?.credentials) {\n      initialValues.credentials = nodeToEdit?.promptValues?.credentials;\n    } else if (nodeToEdit?.originalNodeCredentials) {\n      const defaultCredsWithoutOverrides = [];\n\n      const credentialHasOverride = (templateDefaultCred) => {\n        let hasOverride = false;\n        nodeToEdit.originalNodeCredentials.forEach((nodeCredential) => {\n          if (\n            templateDefaultCred.credential_type ===\n            nodeCredential.credential_type\n          ) {\n            if (\n              (!templateDefaultCred.vault_id &&\n                !nodeCredential.inputs.vault_id) ||\n              (templateDefaultCred.vault_id &&\n                nodeCredential.inputs.vault_id &&\n                templateDefaultCred.vault_id === nodeCredential.inputs.vault_id)\n            ) {\n              hasOverride = true;\n            }\n          }\n        });\n\n        return hasOverride;\n      };\n\n      if (resourceDefaultCredentials) {\n        resourceDefaultCredentials.forEach((defaultCred) => {\n          if (!credentialHasOverride(defaultCred)) {\n            defaultCredsWithoutOverrides.push(defaultCred);\n          }\n        });\n      }\n\n      initialValues.credentials = nodeToEdit.originalNodeCredentials.concat(\n        defaultCredsWithoutOverrides\n      );\n    } else {\n      initialValues.credentials = [];\n    }\n  }\n\n  const sourceOfValues =\n    nodeToEdit?.promptValues || nodeToEdit.originalNodeObject;\n\n  if (launchConfig.ask_job_type_on_launch) {\n    initialValues.job_type = sourceOfValues?.job_type || '';\n  }\n  if (launchConfig.ask_limit_on_launch) {\n    initialValues.limit = sourceOfValues?.limit || '';\n  }\n  if (launchConfig.ask_verbosity_on_launch) {\n    initialValues.verbosity = sourceOfValues?.verbosity || 0;\n  }\n  if (launchConfig.ask_tags_on_launch) {\n    initialValues.job_tags = sourceOfValues?.job_tags || '';\n  }\n  if (launchConfig.ask_skip_tags_on_launch) {\n    initialValues.skip_tags = sourceOfValues?.skip_tags || '';\n  }\n  if (launchConfig.ask_scm_branch_on_launch) {\n    initialValues.scm_branch = sourceOfValues?.scm_branch || '';\n  }\n  if (launchConfig.ask_diff_mode_on_launch) {\n    initialValues.diff_mode = sourceOfValues?.diff_mode || false;\n  }\n  if (launchConfig.ask_forks_on_launch) {\n    initialValues.forks = sourceOfValues?.forks || 0;\n  }\n  if (launchConfig.ask_job_slice_count_on_launch) {\n    initialValues.job_slice_count = sourceOfValues?.job_slice_count || 1;\n  }\n  if (launchConfig.ask_timeout_on_launch) {\n    initialValues.timeout = sourceOfValues?.timeout || 0;\n  }\n  if (launchConfig.ask_labels_on_launch) {\n    initialValues.labels = sourceOfValues?.labels || [];\n  }\n  if (launchConfig.ask_instance_groups_on_launch) {\n    initialValues.instance_groups = sourceOfValues?.instance_groups || [];\n  }\n\n  if (launchConfig.ask_variables_on_launch) {\n    const newExtraData = { ...sourceOfValues.extra_data };\n    if (launchConfig.survey_enabled && surveyConfig.spec) {\n      surveyConfig.spec.forEach((question) => {\n        if (\n          Object.prototype.hasOwnProperty.call(newExtraData, question.variable)\n        ) {\n          delete newExtraData[question.variable];\n        }\n      });\n    }\n    initialValues.extra_vars = jsonToYaml(JSON.stringify(newExtraData));\n  }\n\n  if (surveyConfig?.spec) {\n    surveyConfig.spec.forEach((question) => {\n      if (question.type === 'multiselect') {\n        initialValues[`survey_${question.variable}`] =\n          question.default.split('\\n');\n      } else {\n        initialValues[`survey_${question.variable}`] = question.default;\n      }\n      if (sourceOfValues?.extra_data) {\n        Object.entries(sourceOfValues?.extra_data).forEach(([key, value]) => {\n          if (key === question.variable) {\n            if (question.type === 'multiselect') {\n              initialValues[`survey_${question.variable}`] = value;\n            } else {\n              initialValues[`survey_${question.variable}`] = value;\n            }\n          }\n        });\n      }\n    });\n  }\n\n  return initialValues;\n};\n\nexport default function useWorkflowNodeSteps(\n  launchConfig,\n  surveyConfig,\n  resource,\n  askLinkType,\n  resourceDefaultCredentials,\n  labels,\n  instanceGroups\n) {\n  const { nodeToEdit } = useContext(WorkflowStateContext);\n  const {\n    resetForm,\n    values: formikValues,\n    errors: formikErrors,\n  } = useFormikContext();\n  const [visited, setVisited] = useState({});\n\n  const steps = [\n    useRunTypeStep(askLinkType),\n    useNodeTypeStep(launchConfig),\n    useDaysToKeepStep(),\n    useInventoryStep(launchConfig, resource, visited),\n    useCredentialsStep(launchConfig, resource, resourceDefaultCredentials),\n    useExecutionEnvironmentStep(launchConfig, resource),\n    useInstanceGroupsStep(launchConfig, resource, instanceGroups),\n    useOtherPromptsStep(launchConfig, resource, labels),\n    useSurveyStep(launchConfig, surveyConfig, resource, visited),\n  ];\n\n  const hasErrors = steps.some((step) => step.hasError);\n\n  steps.push(\n    usePreviewStep(\n      launchConfig,\n      resource,\n      surveyConfig,\n      hasErrors,\n      showPreviewStep(formikValues.nodeType, launchConfig)\n    )\n  );\n\n  const pfSteps = steps.map((s) => s.step).filter((s) => s != null);\n  const isReady = !steps.some((s) => !s.isReady);\n\n  useEffect(() => {\n    if (launchConfig && surveyConfig && isReady) {\n      let initialValues = {};\n      if (\n        nodeToEdit &&\n        nodeToEdit?.fullUnifiedJobTemplate &&\n        nodeToEdit?.fullUnifiedJobTemplate?.id === formikValues.nodeResource?.id\n      ) {\n        initialValues = getNodeToEditDefaultValues(\n          launchConfig,\n          surveyConfig,\n          nodeToEdit,\n          resourceDefaultCredentials\n        );\n      } else {\n        initialValues = steps.reduce(\n          (acc, cur) => ({\n            ...acc,\n            ...cur.initialValues,\n          }),\n          {}\n        );\n        initialValues.identifier = formikValues.identifier;\n        initialValues.convergence = formikValues.convergence;\n      }\n\n      const errors = formikErrors.nodeResource\n        ? {\n            nodeResource: formikErrors.nodeResource,\n          }\n        : {};\n\n      if (\n        !launchConfig?.ask_credential_on_launch &&\n        launchConfig?.passwords_needed_to_start?.length > 0\n      ) {\n        errors.nodeResource = t`Job Templates with credentials that prompt for passwords cannot be selected when creating or editing nodes`;\n      }\n\n      resetForm({\n        errors,\n        values: {\n          ...initialValues,\n          nodeResource: formikValues.nodeResource,\n          nodeType: formikValues.nodeType,\n          linkType: formikValues.linkType,\n          verbosity: initialValues?.verbosity?.toString(),\n        },\n      });\n    }\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [launchConfig, surveyConfig, isReady]);\n  const stepWithError = steps.find((s) => s.contentError);\n  const contentError = stepWithError ? stepWithError.contentError : null;\n\n  return {\n    steps: pfSteps,\n    validateStep: (stepId) => {\n      steps.find((s) => s?.step?.id === stepId).validate();\n    },\n    visitStep: (prevStepId, setFieldTouched) => {\n      setVisited({\n        ...visited,\n        [prevStepId]: true,\n      });\n      steps.find((s) => s?.step?.id === prevStepId).setTouched(setFieldTouched);\n    },\n    visitAllSteps: (setFieldTouched) => {\n      setVisited({\n        inventory: true,\n        credentials: true,\n        executionEnvironment: true,\n        instanceGroups: true,\n        other: true,\n        survey: true,\n        preview: true,\n      });\n      steps.forEach((s) => s.setTouched(setFieldTouched));\n    },\n    contentError,\n  };\n}\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}