{"ast":null,"code":"import _asyncToGenerator from\"/awx_devel/awx/ui/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _regeneratorRuntime from\"/awx_devel/awx/ui/node_modules/@babel/runtime/regenerator/index.js\";import{i18n}from\"@lingui/core\";import React,{useCallback,useEffect}from'react';import{Switch,Route,Redirect,Link,useRouteMatch}from'react-router-dom';import{CaretLeftIcon}from'@patternfly/react-icons';import{Card,PageSection}from'@patternfly/react-core';import{useConfig}from'contexts/Config';import ContentError from'components/ContentError';import RoutedTabs from'components/RoutedTabs';import useRequest from'hooks/useRequest';import{SettingsAPI}from'api';import ContentLoading from'components/ContentLoading';import InstanceDetail from'./InstanceDetail';import InstancePeerList from'./InstancePeers';import InstanceListenerAddressList from'./InstanceListenerAddressList';import{jsx as _jsx}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";function Instance(_ref){var setBreadcrumb=_ref.setBreadcrumb;var _useConfig=useConfig(),me=_useConfig.me;var canReadSettings=me.is_superuser||me.is_system_auditor;var match=useRouteMatch();var tabsArray=[{name:/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(CaretLeftIcon,{}),/*i18n*/i18n._(\"Back to Instances\")]}),link:\"/instances\",id:99,persistentFilterKey:'instances'},{name:/*i18n*/i18n._(\"Details\"),link:\"\".concat(match.url,\"/details\"),id:0}];var _useRequest=useRequest(useCallback(/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var _data$IS_K8S;var _yield$SettingsAPI$re,data;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:if(canReadSettings){_context.next=2;break;}return _context.abrupt(\"return\",false);case 2:_context.next=4;return SettingsAPI.readCategory('system');case 4:_yield$SettingsAPI$re=_context.sent;data=_yield$SettingsAPI$re.data;return _context.abrupt(\"return\",(_data$IS_K8S=data===null||data===void 0?void 0:data.IS_K8S)!==null&&_data$IS_K8S!==void 0?_data$IS_K8S:false);case 7:case\"end\":return _context.stop();}}},_callee);})),[canReadSettings]),{isK8s:false,isLoading:true}),isK8s=_useRequest.result,error=_useRequest.error,isLoading=_useRequest.isLoading,request=_useRequest.request;useEffect(function(){request();},[request]);if(isK8s){tabsArray.push({name:/*i18n*/i18n._(\"Listener Addresses\"),link:\"\".concat(match.url,\"/listener_addresses\"),id:1});tabsArray.push({name:/*i18n*/i18n._(\"Peers\"),link:\"\".concat(match.url,\"/peers\"),id:2});}if(isLoading){return/*#__PURE__*/_jsx(ContentLoading,{});}if(error){return/*#__PURE__*/_jsx(ContentError,{});}return/*#__PURE__*/_jsx(PageSection,{children:/*#__PURE__*/_jsxs(Card,{children:[/*#__PURE__*/_jsx(RoutedTabs,{tabsArray:tabsArray}),/*#__PURE__*/_jsxs(Switch,{children:[/*#__PURE__*/_jsx(Redirect,{from:\"/instances/:id\",to:\"/instances/:id/details\",exact:true}),/*#__PURE__*/_jsx(Route,{path:\"/instances/:id/details\",children:/*#__PURE__*/_jsx(InstanceDetail,{isK8s:isK8s,setBreadcrumb:setBreadcrumb})},\"details\"),isK8s&&/*#__PURE__*/_jsx(Route,{path:\"/instances/:id/listener_addresses\",children:/*#__PURE__*/_jsx(InstanceListenerAddressList,{setBreadcrumb:setBreadcrumb})},\"listener_addresses\"),isK8s&&/*#__PURE__*/_jsx(Route,{path:\"/instances/:id/peers\",children:/*#__PURE__*/_jsx(InstancePeerList,{setBreadcrumb:setBreadcrumb})},\"peers\"),/*#__PURE__*/_jsx(Route,{path:\"*\",children:/*#__PURE__*/_jsx(ContentError,{isNotFound:true,children:match.params.id&&/*#__PURE__*/_jsx(Link,{to:\"/instances/\".concat(match.params.id,\"/details\"),children:/*i18n*/i18n._(\"View Instance Details\")})})},\"not-found\")]})]})});}export default Instance;","map":{"version":3,"names":["React","useCallback","useEffect","Switch","Route","Redirect","Link","useRouteMatch","CaretLeftIcon","Card","PageSection","useConfig","ContentError","RoutedTabs","useRequest","SettingsAPI","ContentLoading","InstanceDetail","InstancePeerList","InstanceListenerAddressList","jsx","_jsx","Fragment","_Fragment","jsxs","_jsxs","Instance","_ref","setBreadcrumb","_useConfig","me","canReadSettings","is_superuser","is_system_auditor","match","tabsArray","name","children","i18n","_","link","id","persistentFilterKey","concat","url","_useRequest","_asyncToGenerator","_regeneratorRuntime","mark","_callee","_data$IS_K8S","_yield$SettingsAPI$re","data","wrap","_callee$","_context","prev","next","abrupt","readCategory","sent","IS_K8S","stop","isK8s","isLoading","result","error","request","push","from","to","exact","path","isNotFound","params"],"sources":["/awx_devel/awx/ui/src/screens/Instances/Instance.js"],"sourcesContent":["import React, { useCallback, useEffect } from 'react';\nimport { t } from '@lingui/macro';\n\nimport { Switch, Route, Redirect, Link, useRouteMatch } from 'react-router-dom';\nimport { CaretLeftIcon } from '@patternfly/react-icons';\nimport { Card, PageSection } from '@patternfly/react-core';\nimport { useConfig } from 'contexts/Config';\nimport ContentError from 'components/ContentError';\nimport RoutedTabs from 'components/RoutedTabs';\nimport useRequest from 'hooks/useRequest';\nimport { SettingsAPI } from 'api';\nimport ContentLoading from 'components/ContentLoading';\nimport InstanceDetail from './InstanceDetail';\nimport InstancePeerList from './InstancePeers';\nimport InstanceListenerAddressList from './InstanceListenerAddressList';\n\nfunction Instance({ setBreadcrumb }) {\n  const { me } = useConfig();\n  const canReadSettings = me.is_superuser || me.is_system_auditor;\n\n  const match = useRouteMatch();\n  const tabsArray = [\n    {\n      name: (\n        <>\n          <CaretLeftIcon />\n          {t`Back to Instances`}\n        </>\n      ),\n      link: `/instances`,\n      id: 99,\n      persistentFilterKey: 'instances',\n    },\n    { name: t`Details`, link: `${match.url}/details`, id: 0 },\n  ];\n\n  const {\n    result: isK8s,\n    error,\n    isLoading,\n    request,\n  } = useRequest(\n    useCallback(async () => {\n      if (!canReadSettings) {\n        return false;\n      }\n      const { data } = await SettingsAPI.readCategory('system');\n      return data?.IS_K8S ?? false;\n    }, [canReadSettings]),\n    { isK8s: false, isLoading: true }\n  );\n\n  useEffect(() => {\n    request();\n  }, [request]);\n\n  if (isK8s) {\n    tabsArray.push({\n      name: t`Listener Addresses`,\n      link: `${match.url}/listener_addresses`,\n      id: 1,\n    });\n    tabsArray.push({ name: t`Peers`, link: `${match.url}/peers`, id: 2 });\n  }\n  if (isLoading) {\n    return <ContentLoading />;\n  }\n\n  if (error) {\n    return <ContentError />;\n  }\n  return (\n    <PageSection>\n      <Card>\n        <RoutedTabs tabsArray={tabsArray} />\n        <Switch>\n          <Redirect from=\"/instances/:id\" to=\"/instances/:id/details\" exact />\n          <Route path=\"/instances/:id/details\" key=\"details\">\n            <InstanceDetail isK8s={isK8s} setBreadcrumb={setBreadcrumb} />\n          </Route>\n          {isK8s && (\n            <Route\n              path=\"/instances/:id/listener_addresses\"\n              key=\"listener_addresses\"\n            >\n              <InstanceListenerAddressList setBreadcrumb={setBreadcrumb} />\n            </Route>\n          )}\n          {isK8s && (\n            <Route path=\"/instances/:id/peers\" key=\"peers\">\n              <InstancePeerList setBreadcrumb={setBreadcrumb} />\n            </Route>\n          )}\n          <Route path=\"*\" key=\"not-found\">\n            <ContentError isNotFound>\n              {match.params.id && (\n                <Link to={`/instances/${match.params.id}/details`}>\n                  {t`View Instance Details`}\n                </Link>\n              )}\n            </ContentError>\n          </Route>\n        </Switch>\n      </Card>\n    </PageSection>\n  );\n}\n\nexport default Instance;\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}