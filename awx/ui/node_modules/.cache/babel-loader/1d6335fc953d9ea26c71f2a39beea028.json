{"ast":null,"code":"import _asyncToGenerator from\"/awx_devel/awx/ui/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _taggedTemplateLiteral from\"/awx_devel/awx/ui/node_modules/@babel/runtime/helpers/esm/taggedTemplateLiteral.js\";var _templateObject;import _regeneratorRuntime from\"/awx_devel/awx/ui/node_modules/@babel/runtime/regenerator/index.js\";import{i18n}from\"@lingui/core\";import React,{useCallback}from'react';import{Link,useHistory}from'react-router-dom';import styled from'styled-components';import{Button}from'@patternfly/react-core';import AlertModal from'components/AlertModal';import{CardBody,CardActionsRow}from'components/Card';import ErrorDetail from'components/ErrorDetail';import DeleteButton from'components/DeleteButton';import{Detail,DetailList,UserDateDetail,DetailBadge}from'components/DetailList';import useRequest,{useDismissableError}from'hooks/useRequest';import{InstanceGroupsAPI}from'api';import{relatedResourceDeleteRequests}from'util/getRelatedResourceDeleteDetails';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var Unavailable=styled.span(_templateObject||(_templateObject=_taggedTemplateLiteral([\"\\n  color: var(--pf-global--danger-color--200);\\n\"])));function InstanceGroupDetails(_ref){var instanceGroup=_ref.instanceGroup;var id=instanceGroup.id,name=instanceGroup.name;var history=useHistory();var _useRequest=useRequest(useCallback(/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return InstanceGroupsAPI.destroy(id);case 2:history.push(\"/instance_groups\");case 3:case\"end\":return _context.stop();}}},_callee);})),[id,history])),deleteInstanceGroup=_useRequest.request,isLoading=_useRequest.isLoading,deleteError=_useRequest.error;var _useDismissableError=useDismissableError(deleteError),error=_useDismissableError.error,dismissError=_useDismissableError.dismissError;var deleteDetailsRequests=relatedResourceDeleteRequests.instanceGroup(instanceGroup);return/*#__PURE__*/_jsxs(CardBody,{children:[/*#__PURE__*/_jsxs(DetailList,{children:[/*#__PURE__*/_jsx(Detail,{label:/*i18n*/i18n._(\"Name\"),value:instanceGroup.name,dataCy:\"instance-group-detail-name\"}),/*#__PURE__*/_jsx(Detail,{label:/*i18n*/i18n._(\"Type\"),value:instanceGroup.is_container_group?/*i18n*/i18n._(\"Container group\"):/*i18n*/i18n._(\"Instance group\"),dataCy:\"instance-group-type\"}),/*#__PURE__*/_jsx(DetailBadge,{label:/*i18n*/i18n._(\"Policy instance minimum\"),dataCy:\"instance-group-policy-instance-minimum\",helpText:/*i18n*/i18n._(\"Minimum number of instances that will be automatically\\nassigned to this group when new instances come online.\"),content:instanceGroup.policy_instance_minimum}),/*#__PURE__*/_jsx(DetailBadge,{label:/*i18n*/i18n._(\"Policy instance percentage\"),helpText:/*i18n*/i18n._(\"Minimum percentage of all instances that will be automatically\\nassigned to this group when new instances come online.\"),dataCy:\"instance-group-policy-instance-percentage\",content:\"\".concat(instanceGroup.policy_instance_percentage,\" %\")}),/*#__PURE__*/_jsx(DetailBadge,{label:/*i18n*/i18n._(\"Max concurrent jobs\"),dataCy:\"instance-group-max-concurrent-jobs\",helpText:/*i18n*/i18n._(\"Maximum number of jobs to run concurrently on this group.\\nZero means no limit will be enforced.\"),content:instanceGroup.max_concurrent_jobs}),/*#__PURE__*/_jsx(DetailBadge,{label:/*i18n*/i18n._(\"Max forks\"),dataCy:\"instance-group-max-forks\",helpText:/*i18n*/i18n._(\"Maximum number of forks to allow across all jobs running concurrently on this group.\\nZero means no limit will be enforced.\"),content:instanceGroup.max_forks}),instanceGroup.capacity?/*#__PURE__*/_jsx(DetailBadge,{label:/*i18n*/i18n._(\"Used capacity\"),content:\"\".concat(Math.round(100-instanceGroup.percent_capacity_remaining),\" %\"),dataCy:\"instance-group-used-capacity\"}):/*#__PURE__*/_jsx(Detail,{label:/*i18n*/i18n._(\"Used capacity\"),value:/*#__PURE__*/_jsx(Unavailable,{children:/*i18n*/i18n._(\"Unavailable\")}),dataCy:\"instance-group-used-capacity\"}),/*#__PURE__*/_jsx(UserDateDetail,{label:/*i18n*/i18n._(\"Created\"),date:instanceGroup.created,user:instanceGroup.summary_fields.created_by}),/*#__PURE__*/_jsx(UserDateDetail,{label:/*i18n*/i18n._(\"Last Modified\"),date:instanceGroup.modified,user:instanceGroup.summary_fields.modified_by})]}),/*#__PURE__*/_jsxs(CardActionsRow,{children:[instanceGroup.summary_fields.user_capabilities&&instanceGroup.summary_fields.user_capabilities.edit&&/*#__PURE__*/_jsx(Button,{ouiaId:\"instance-group-detail-edit-button\",\"aria-label\":/*i18n*/i18n._(\"edit\"),component:Link,to:\"/instance_groups/\".concat(id,\"/edit\"),children:/*i18n*/i18n._(\"Edit\")}),instanceGroup.summary_fields.user_capabilities&&instanceGroup.summary_fields.user_capabilities.delete&&/*#__PURE__*/_jsx(DeleteButton,{ouiaId:\"instance-group-detail-delete-button\",name:name,modalTitle:/*i18n*/i18n._(\"Delete instance group\"),onConfirm:deleteInstanceGroup,isDisabled:isLoading,deleteDetailsRequests:deleteDetailsRequests,deleteMessage:/*i18n*/i18n._(\"This instance group is currently being by other resources. Are you sure you want to delete it?\"),children:/*i18n*/i18n._(\"Delete\")})]}),error&&/*#__PURE__*/_jsx(AlertModal,{isOpen:error,onClose:dismissError,title:/*i18n*/i18n._(\"Error\"),variant:\"error\",children:/*#__PURE__*/_jsx(ErrorDetail,{error:error})})]});}export default InstanceGroupDetails;","map":{"version":3,"names":["React","useCallback","Link","useHistory","styled","Button","AlertModal","CardBody","CardActionsRow","ErrorDetail","DeleteButton","Detail","DetailList","UserDateDetail","DetailBadge","useRequest","useDismissableError","InstanceGroupsAPI","relatedResourceDeleteRequests","jsx","_jsx","jsxs","_jsxs","Unavailable","span","_templateObject","_taggedTemplateLiteral","InstanceGroupDetails","_ref","instanceGroup","id","name","history","_useRequest","_asyncToGenerator","_regeneratorRuntime","mark","_callee","wrap","_callee$","_context","prev","next","destroy","push","stop","deleteInstanceGroup","request","isLoading","deleteError","error","_useDismissableError","dismissError","deleteDetailsRequests","children","label","i18n","_","value","dataCy","is_container_group","helpText","content","policy_instance_minimum","concat","policy_instance_percentage","max_concurrent_jobs","max_forks","capacity","Math","round","percent_capacity_remaining","date","created","user","summary_fields","created_by","modified","modified_by","user_capabilities","edit","ouiaId","component","to","delete","modalTitle","onConfirm","isDisabled","deleteMessage","isOpen","onClose","title","variant"],"sources":["/awx_devel/awx/ui/src/screens/InstanceGroup/InstanceGroupDetails/InstanceGroupDetails.js"],"sourcesContent":["import React, { useCallback } from 'react';\n\nimport { t } from '@lingui/macro';\nimport { Link, useHistory } from 'react-router-dom';\nimport styled from 'styled-components';\nimport { Button } from '@patternfly/react-core';\n\nimport AlertModal from 'components/AlertModal';\nimport { CardBody, CardActionsRow } from 'components/Card';\nimport ErrorDetail from 'components/ErrorDetail';\nimport DeleteButton from 'components/DeleteButton';\nimport {\n  Detail,\n  DetailList,\n  UserDateDetail,\n  DetailBadge,\n} from 'components/DetailList';\nimport useRequest, { useDismissableError } from 'hooks/useRequest';\nimport { InstanceGroupsAPI } from 'api';\nimport { relatedResourceDeleteRequests } from 'util/getRelatedResourceDeleteDetails';\n\nconst Unavailable = styled.span`\n  color: var(--pf-global--danger-color--200);\n`;\n\nfunction InstanceGroupDetails({ instanceGroup }) {\n  const { id, name } = instanceGroup;\n\n  const history = useHistory();\n\n  const {\n    request: deleteInstanceGroup,\n    isLoading,\n    error: deleteError,\n  } = useRequest(\n    useCallback(async () => {\n      await InstanceGroupsAPI.destroy(id);\n      history.push(`/instance_groups`);\n    }, [id, history])\n  );\n\n  const { error, dismissError } = useDismissableError(deleteError);\n  const deleteDetailsRequests =\n    relatedResourceDeleteRequests.instanceGroup(instanceGroup);\n  return (\n    <CardBody>\n      <DetailList>\n        <Detail\n          label={t`Name`}\n          value={instanceGroup.name}\n          dataCy=\"instance-group-detail-name\"\n        />\n        <Detail\n          label={t`Type`}\n          value={\n            instanceGroup.is_container_group\n              ? t`Container group`\n              : t`Instance group`\n          }\n          dataCy=\"instance-group-type\"\n        />\n        <DetailBadge\n          label={t`Policy instance minimum`}\n          dataCy=\"instance-group-policy-instance-minimum\"\n          helpText={t`Minimum number of instances that will be automatically\n          assigned to this group when new instances come online.`}\n          content={instanceGroup.policy_instance_minimum}\n        />\n        <DetailBadge\n          label={t`Policy instance percentage`}\n          helpText={t`Minimum percentage of all instances that will be automatically\n          assigned to this group when new instances come online.`}\n          dataCy=\"instance-group-policy-instance-percentage\"\n          content={`${instanceGroup.policy_instance_percentage} %`}\n        />\n        <DetailBadge\n          label={t`Max concurrent jobs`}\n          dataCy=\"instance-group-max-concurrent-jobs\"\n          helpText={t`Maximum number of jobs to run concurrently on this group.\n          Zero means no limit will be enforced.`}\n          content={instanceGroup.max_concurrent_jobs}\n        />\n        <DetailBadge\n          label={t`Max forks`}\n          dataCy=\"instance-group-max-forks\"\n          helpText={t`Maximum number of forks to allow across all jobs running concurrently on this group.\n          Zero means no limit will be enforced.`}\n          content={instanceGroup.max_forks}\n        />\n        {instanceGroup.capacity ? (\n          <DetailBadge\n            label={t`Used capacity`}\n            content={`${Math.round(\n              100 - instanceGroup.percent_capacity_remaining\n            )} %`}\n            dataCy=\"instance-group-used-capacity\"\n          />\n        ) : (\n          <Detail\n            label={t`Used capacity`}\n            value={<Unavailable>{t`Unavailable`}</Unavailable>}\n            dataCy=\"instance-group-used-capacity\"\n          />\n        )}\n\n        <UserDateDetail\n          label={t`Created`}\n          date={instanceGroup.created}\n          user={instanceGroup.summary_fields.created_by}\n        />\n        <UserDateDetail\n          label={t`Last Modified`}\n          date={instanceGroup.modified}\n          user={instanceGroup.summary_fields.modified_by}\n        />\n      </DetailList>\n\n      <CardActionsRow>\n        {instanceGroup.summary_fields.user_capabilities &&\n          instanceGroup.summary_fields.user_capabilities.edit && (\n            <Button\n              ouiaId=\"instance-group-detail-edit-button\"\n              aria-label={t`edit`}\n              component={Link}\n              to={`/instance_groups/${id}/edit`}\n            >\n              {t`Edit`}\n            </Button>\n          )}\n        {instanceGroup.summary_fields.user_capabilities &&\n          instanceGroup.summary_fields.user_capabilities.delete && (\n            <DeleteButton\n              ouiaId=\"instance-group-detail-delete-button\"\n              name={name}\n              modalTitle={t`Delete instance group`}\n              onConfirm={deleteInstanceGroup}\n              isDisabled={isLoading}\n              deleteDetailsRequests={deleteDetailsRequests}\n              deleteMessage={t`This instance group is currently being by other resources. Are you sure you want to delete it?`}\n            >\n              {t`Delete`}\n            </DeleteButton>\n          )}\n      </CardActionsRow>\n      {error && (\n        <AlertModal\n          isOpen={error}\n          onClose={dismissError}\n          title={t`Error`}\n          variant=\"error\"\n        >\n          <ErrorDetail error={error} />\n        </AlertModal>\n      )}\n    </CardBody>\n  );\n}\n\nexport default InstanceGroupDetails;\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}