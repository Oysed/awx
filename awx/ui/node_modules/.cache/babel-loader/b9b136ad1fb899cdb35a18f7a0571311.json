{"ast":null,"code":"import _objectSpread from\"/awx_devel/awx/ui/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import _asyncToGenerator from\"/awx_devel/awx/ui/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"/awx_devel/awx/ui/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import _regeneratorRuntime from\"/awx_devel/awx/ui/node_modules/@babel/runtime/regenerator/index.js\";import React,{useState}from'react';import{Card,PageSection}from'@patternfly/react-core';import{useHistory}from'react-router-dom';import{ExecutionEnvironmentsAPI}from'api';import{Config}from'contexts/Config';import{CardBody}from'components/Card';import ExecutionEnvironmentForm from'../shared/ExecutionEnvironmentForm';import{jsx as _jsx}from\"react/jsx-runtime\";function ExecutionEnvironmentAdd(){var history=useHistory();var _useState=useState(null),_useState2=_slicedToArray(_useState,2),submitError=_useState2[0],setSubmitError=_useState2[1];var handleSubmit=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(values){var _values$credential,_values$organization,_yield$ExecutionEnvir,response;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.prev=0;_context.next=3;return ExecutionEnvironmentsAPI.create(_objectSpread(_objectSpread({},values),{},{credential:(_values$credential=values.credential)===null||_values$credential===void 0?void 0:_values$credential.id,organization:(_values$organization=values.organization)===null||_values$organization===void 0?void 0:_values$organization.id}));case 3:_yield$ExecutionEnvir=_context.sent;response=_yield$ExecutionEnvir.data;history.push(\"/execution_environments/\".concat(response.id,\"/details\"));_context.next=11;break;case 8:_context.prev=8;_context.t0=_context[\"catch\"](0);setSubmitError(_context.t0);case 11:case\"end\":return _context.stop();}}},_callee,null,[[0,8]]);}));return function handleSubmit(_x){return _ref.apply(this,arguments);};}();var handleCancel=function handleCancel(){history.push(\"/execution_environments\");};var hubParams={description:'',image:'',name:''};history.location.search.replace(/^\\?/,'').split('&').map(function(s){return s.split('=');}).forEach(function(_ref2){var _ref3=_slicedToArray(_ref2,2),key=_ref3[0],val=_ref3[1];if(!(key in hubParams)){return;}hubParams[key]=decodeURIComponent(val);});return/*#__PURE__*/_jsx(PageSection,{children:/*#__PURE__*/_jsx(Card,{children:/*#__PURE__*/_jsx(CardBody,{children:/*#__PURE__*/_jsx(Config,{children:function children(_ref4){var me=_ref4.me;return/*#__PURE__*/_jsx(ExecutionEnvironmentForm,{onSubmit:handleSubmit,submitError:submitError,onCancel:handleCancel,me:me||{},executionEnvironment:hubParams});}})})})});}export default ExecutionEnvironmentAdd;","map":{"version":3,"names":["React","useState","Card","PageSection","useHistory","ExecutionEnvironmentsAPI","Config","CardBody","ExecutionEnvironmentForm","jsx","_jsx","ExecutionEnvironmentAdd","history","_useState","_useState2","_slicedToArray","submitError","setSubmitError","handleSubmit","_ref","_asyncToGenerator","_regeneratorRuntime","mark","_callee","values","_values$credential","_values$organization","_yield$ExecutionEnvir","response","wrap","_callee$","_context","prev","next","create","_objectSpread","credential","id","organization","sent","data","push","concat","t0","stop","_x","apply","arguments","handleCancel","hubParams","description","image","name","location","search","replace","split","map","s","forEach","_ref2","_ref3","key","val","decodeURIComponent","children","_ref4","me","onSubmit","onCancel","executionEnvironment"],"sources":["/awx_devel/awx/ui/src/screens/ExecutionEnvironment/ExecutionEnvironmentAdd/ExecutionEnvironmentAdd.js"],"sourcesContent":["import React, { useState } from 'react';\nimport { Card, PageSection } from '@patternfly/react-core';\nimport { useHistory } from 'react-router-dom';\n\nimport { ExecutionEnvironmentsAPI } from 'api';\nimport { Config } from 'contexts/Config';\nimport { CardBody } from 'components/Card';\nimport ExecutionEnvironmentForm from '../shared/ExecutionEnvironmentForm';\n\nfunction ExecutionEnvironmentAdd() {\n  const history = useHistory();\n  const [submitError, setSubmitError] = useState(null);\n\n  const handleSubmit = async (values) => {\n    try {\n      const { data: response } = await ExecutionEnvironmentsAPI.create({\n        ...values,\n        credential: values.credential?.id,\n        organization: values.organization?.id,\n      });\n      history.push(`/execution_environments/${response.id}/details`);\n    } catch (error) {\n      setSubmitError(error);\n    }\n  };\n\n  const handleCancel = () => {\n    history.push(`/execution_environments`);\n  };\n\n  const hubParams = {\n    description: '',\n    image: '',\n    name: '',\n  };\n\n  history.location.search\n    .replace(/^\\?/, '')\n    .split('&')\n    .map((s) => s.split('='))\n    .forEach(([key, val]) => {\n      if (!(key in hubParams)) {\n        return;\n      }\n      hubParams[key] = decodeURIComponent(val);\n    });\n\n  return (\n    <PageSection>\n      <Card>\n        <CardBody>\n          <Config>\n            {({ me }) => (\n              <ExecutionEnvironmentForm\n                onSubmit={handleSubmit}\n                submitError={submitError}\n                onCancel={handleCancel}\n                me={me || {}}\n                executionEnvironment={hubParams}\n              />\n            )}\n          </Config>\n        </CardBody>\n      </Card>\n    </PageSection>\n  );\n}\n\nexport default ExecutionEnvironmentAdd;\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}