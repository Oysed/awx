{"ast":null,"code":"import _asyncToGenerator from\"/awx_devel/awx/ui/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _regeneratorRuntime from\"/awx_devel/awx/ui/node_modules/@babel/runtime/regenerator/index.js\";import{i18n}from\"@lingui/core\";import React,{useCallback}from'react';import{Button}from'@patternfly/react-core';import{OutlinedThumbsDownIcon}from'@patternfly/react-icons';import{WorkflowApprovalsAPI}from'api';import useRequest,{useDismissableError}from'hooks/useRequest';import AlertModal from'components/AlertModal';import ErrorDetail from'components/ErrorDetail';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";function WorkflowDenyButton(_ref){var isDetailView=_ref.isDetailView,workflowApproval=_ref.workflowApproval,onHandleToast=_ref.onHandleToast;var hasBeenActedOn=Object.keys(workflowApproval.summary_fields.approved_or_denied_by||{}).length>0||workflowApproval.status==='canceled';var id=workflowApproval.id;var _useRequest=useRequest(useCallback(/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:return _context.abrupt(\"return\",WorkflowApprovalsAPI.deny(id));case 1:case\"end\":return _context.stop();}}},_callee);})),[id]),{}),denyApprovalError=_useRequest.error,denyWorkflowApprovals=_useRequest.request;var handleDeny=/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(){return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.next=2;return denyWorkflowApprovals();case 2:onHandleToast(workflowApproval.id,/*i18n*/i18n._(\"Successfully Denied\"));case 3:case\"end\":return _context2.stop();}}},_callee2);}));return function handleDeny(){return _ref3.apply(this,arguments);};}();var _useDismissableError=useDismissableError(denyApprovalError),denyError=_useDismissableError.error,dismissDenyError=_useDismissableError.dismissError;return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(Button,{\"aria-label\":hasBeenActedOn?/*i18n*/i18n._(\"This workflow has already been acted on\"):/*i18n*/i18n._(\"Deny\"),ouiaId:\"workflow-deny-button\",isDisabled:hasBeenActedOn,variant:isDetailView?'secondary':'plain',onClick:function onClick(){return handleDeny();},children:isDetailView?/*i18n*/i18n._(\"Deny\"):/*#__PURE__*/_jsx(OutlinedThumbsDownIcon,{})}),denyError&&/*#__PURE__*/_jsxs(AlertModal,{isOpen:denyError,variant:\"error\",title:/*i18n*/i18n._(\"Error!\"),onClose:dismissDenyError,children:[/*i18n*/i18n._(\"Failed to deny {0}.\",{0:workflowApproval.name}),/*#__PURE__*/_jsx(ErrorDetail,{error:denyError})]})]});}export default WorkflowDenyButton;","map":{"version":3,"names":["React","useCallback","Button","OutlinedThumbsDownIcon","WorkflowApprovalsAPI","useRequest","useDismissableError","AlertModal","ErrorDetail","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","WorkflowDenyButton","_ref","isDetailView","workflowApproval","onHandleToast","hasBeenActedOn","Object","keys","summary_fields","approved_or_denied_by","length","status","id","_useRequest","_asyncToGenerator","_regeneratorRuntime","mark","_callee","wrap","_callee$","_context","prev","next","abrupt","deny","stop","denyApprovalError","error","denyWorkflowApprovals","request","handleDeny","_ref3","_callee2","_callee2$","_context2","i18n","_","apply","arguments","_useDismissableError","denyError","dismissDenyError","dismissError","children","ouiaId","isDisabled","variant","onClick","isOpen","title","onClose","0","name"],"sources":["/awx_devel/awx/ui/src/screens/WorkflowApproval/shared/WorkflowDenyButton.js"],"sourcesContent":["import React, { useCallback } from 'react';\nimport { t } from '@lingui/macro';\nimport { Button } from '@patternfly/react-core';\nimport { OutlinedThumbsDownIcon } from '@patternfly/react-icons';\nimport { WorkflowApprovalsAPI } from 'api';\nimport useRequest, { useDismissableError } from 'hooks/useRequest';\n\nimport AlertModal from 'components/AlertModal';\nimport ErrorDetail from 'components/ErrorDetail';\n\nfunction WorkflowDenyButton({ isDetailView, workflowApproval, onHandleToast }) {\n  const hasBeenActedOn =\n    Object.keys(workflowApproval.summary_fields.approved_or_denied_by || {})\n      .length > 0 || workflowApproval.status === 'canceled';\n\n  const { id } = workflowApproval;\n  const { error: denyApprovalError, request: denyWorkflowApprovals } =\n    useRequest(\n      useCallback(async () => WorkflowApprovalsAPI.deny(id), [id]),\n      {}\n    );\n\n  const handleDeny = async () => {\n    await denyWorkflowApprovals();\n    onHandleToast(workflowApproval.id, t`Successfully Denied`);\n  };\n\n  const { error: denyError, dismissError: dismissDenyError } =\n    useDismissableError(denyApprovalError);\n\n  return (\n    <>\n      <Button\n        aria-label={\n          hasBeenActedOn ? t`This workflow has already been acted on` : t`Deny`\n        }\n        ouiaId=\"workflow-deny-button\"\n        isDisabled={hasBeenActedOn}\n        variant={isDetailView ? 'secondary' : 'plain'}\n        onClick={() => handleDeny()}\n      >\n        {isDetailView ? t`Deny` : <OutlinedThumbsDownIcon />}\n      </Button>\n      {denyError && (\n        <AlertModal\n          isOpen={denyError}\n          variant=\"error\"\n          title={t`Error!`}\n          onClose={dismissDenyError}\n        >\n          {t`Failed to deny ${workflowApproval.name}.`}\n          <ErrorDetail error={denyError} />\n        </AlertModal>\n      )}\n    </>\n  );\n}\nexport default WorkflowDenyButton;\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}