{"ast":null,"code":"import _slicedToArray from\"/awx_devel/awx/ui/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import _asyncToGenerator from\"/awx_devel/awx/ui/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _regeneratorRuntime from\"/awx_devel/awx/ui/node_modules/@babel/runtime/regenerator/index.js\";import{i18n}from\"@lingui/core\";import React,{useEffect,useCallback}from'react';import{Link}from'react-router-dom';import{Button}from'@patternfly/react-core';import{CaretLeftIcon}from'@patternfly/react-icons';import{CardBody,CardActionsRow}from'components/Card';import CodeDetail from'components/DetailList/CodeDetail';import ContentError from'components/ContentError';import ContentLoading from'components/ContentLoading';import{DetailList}from'components/DetailList';import RoutedTabs from'components/RoutedTabs';import{SettingsAPI,ExecutionEnvironmentsAPI}from'api';import useRequest from'hooks/useRequest';import{useConfig}from'contexts/Config';import{useSettings}from'contexts/Settings';import{SettingDetail}from'../../shared';import{formatJson,pluck,sortNestedDetails}from'../../shared/settingUtils';import{jsx as _jsx}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";function MiscSystemDetail(){var _useConfig=useConfig(),me=_useConfig.me;var _useSettings=useSettings(),options=_useSettings.GET;var _useRequest=useRequest(useCallback(/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var _yield$SettingsAPI$re,data,_yield$ExecutionEnvir,name,systemData,mergedData;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return SettingsAPI.readCategory('system');case 2:_yield$SettingsAPI$re=_context.sent;data=_yield$SettingsAPI$re.data;if(!data.DEFAULT_EXECUTION_ENVIRONMENT){_context.next=10;break;}_context.next=7;return ExecutionEnvironmentsAPI.readDetail(data.DEFAULT_EXECUTION_ENVIRONMENT);case 7:_yield$ExecutionEnvir=_context.sent;name=_yield$ExecutionEnvir.data.name;data.DEFAULT_EXECUTION_ENVIRONMENT=name;case 10:systemData=pluck(data,'ACTIVITY_STREAM_ENABLED','ACTIVITY_STREAM_ENABLED_FOR_INVENTORY_SYNC','AUTOMATION_ANALYTICS_GATHER_INTERVAL','AUTOMATION_ANALYTICS_URL','INSIGHTS_TRACKING_STATE','MANAGE_ORGANIZATION_AUTH','ORG_ADMINS_CAN_SEE_ALL_USERS','REDHAT_USERNAME','REDHAT_PASSWORD','SUBSCRIPTIONS_USERNAME','SUBSCRIPTIONS_PASSWORD','INSTALL_UUID','REMOTE_HOST_HEADERS','TOWER_URL_BASE','DEFAULT_EXECUTION_ENVIRONMENT','PROXY_IP_ALLOWED_LIST','CSRF_TRUSTED_ORIGINS','AUTOMATION_ANALYTICS_LAST_GATHER','AUTOMATION_ANALYTICS_LAST_ENTRIES','UI_NEXT');mergedData={};Object.keys(systemData).forEach(function(key){mergedData[key]=options[key];if(key==='AUTOMATION_ANALYTICS_LAST_ENTRIES'){var _formatJson;mergedData[key].value=(_formatJson=formatJson(systemData[key]))!==null&&_formatJson!==void 0?_formatJson:'';}else{mergedData[key].value=systemData[key];}});return _context.abrupt(\"return\",sortNestedDetails(mergedData));case 14:case\"end\":return _context.stop();}}},_callee);})),[options]),null),isLoading=_useRequest.isLoading,error=_useRequest.error,request=_useRequest.request,system=_useRequest.result;useEffect(function(){request();},[request]);var tabsArray=[{name:/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(CaretLeftIcon,{}),/*i18n*/i18n._(\"Back to Settings\")]}),link:\"/settings\",id:99},{name:/*i18n*/i18n._(\"Details\"),link:\"/settings/miscellaneous_system/details\",id:0}];// Display this detail in a code editor for readability\nif(options!==null&&options!==void 0&&options.AUTOMATION_ANALYTICS_LAST_ENTRIES){options.AUTOMATION_ANALYTICS_LAST_ENTRIES.type='nested object';}return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(RoutedTabs,{tabsArray:tabsArray}),/*#__PURE__*/_jsxs(CardBody,{children:[isLoading&&/*#__PURE__*/_jsx(ContentLoading,{}),!isLoading&&error&&/*#__PURE__*/_jsx(ContentError,{error:error}),!isLoading&&system&&/*#__PURE__*/_jsx(DetailList,{children:system.map(function(_ref2){var _ref3=_slicedToArray(_ref2,2),key=_ref3[0],detail=_ref3[1];if(key==='AUTOMATION_ANALYTICS_LAST_ENTRIES'){return/*#__PURE__*/_jsx(CodeDetail,{dataCy:key,helpText:detail===null||detail===void 0?void 0:detail.help_text,label:detail===null||detail===void 0?void 0:detail.label,mode:\"javascript\",rows:4,value:detail!==null&&detail!==void 0&&detail.value?JSON.stringify(detail.value,undefined,2):''},key);}return/*#__PURE__*/_jsx(SettingDetail,{id:key,helpText:detail===null||detail===void 0?void 0:detail.help_text,label:detail===null||detail===void 0?void 0:detail.label,type:detail===null||detail===void 0?void 0:detail.type,unit:detail===null||detail===void 0?void 0:detail.unit,value:detail===null||detail===void 0?void 0:detail.value},key);})}),(me===null||me===void 0?void 0:me.is_superuser)&&/*#__PURE__*/_jsx(CardActionsRow,{children:/*#__PURE__*/_jsx(Button,{ouiaId:\"system-detail-edit-button\",\"aria-label\":/*i18n*/i18n._(\"Edit\"),component:Link,to:\"/settings/miscellaneous_system/edit\",children:/*i18n*/i18n._(\"Edit\")})})]})]});}export default MiscSystemDetail;","map":{"version":3,"names":["React","useEffect","useCallback","Link","Button","CaretLeftIcon","CardBody","CardActionsRow","CodeDetail","ContentError","ContentLoading","DetailList","RoutedTabs","SettingsAPI","ExecutionEnvironmentsAPI","useRequest","useConfig","useSettings","SettingDetail","formatJson","pluck","sortNestedDetails","jsx","_jsx","Fragment","_Fragment","jsxs","_jsxs","MiscSystemDetail","_useConfig","me","_useSettings","options","GET","_useRequest","_asyncToGenerator","_regeneratorRuntime","mark","_callee","_yield$SettingsAPI$re","data","_yield$ExecutionEnvir","name","systemData","mergedData","wrap","_callee$","_context","prev","next","readCategory","sent","DEFAULT_EXECUTION_ENVIRONMENT","readDetail","Object","keys","forEach","key","_formatJson","value","abrupt","stop","isLoading","error","request","system","result","tabsArray","children","i18n","_","link","id","AUTOMATION_ANALYTICS_LAST_ENTRIES","type","map","_ref2","_ref3","_slicedToArray","detail","dataCy","helpText","help_text","label","mode","rows","JSON","stringify","undefined","unit","is_superuser","ouiaId","component","to"],"sources":["/awx_devel/awx/ui/src/screens/Setting/MiscSystem/MiscSystemDetail/MiscSystemDetail.js"],"sourcesContent":["import React, { useEffect, useCallback } from 'react';\nimport { Link } from 'react-router-dom';\n\nimport { t } from '@lingui/macro';\nimport { Button } from '@patternfly/react-core';\nimport { CaretLeftIcon } from '@patternfly/react-icons';\nimport { CardBody, CardActionsRow } from 'components/Card';\nimport CodeDetail from 'components/DetailList/CodeDetail';\nimport ContentError from 'components/ContentError';\nimport ContentLoading from 'components/ContentLoading';\nimport { DetailList } from 'components/DetailList';\nimport RoutedTabs from 'components/RoutedTabs';\nimport { SettingsAPI, ExecutionEnvironmentsAPI } from 'api';\nimport useRequest from 'hooks/useRequest';\nimport { useConfig } from 'contexts/Config';\nimport { useSettings } from 'contexts/Settings';\nimport { SettingDetail } from '../../shared';\nimport {\n  formatJson,\n  pluck,\n  sortNestedDetails,\n} from '../../shared/settingUtils';\n\nfunction MiscSystemDetail() {\n  const { me } = useConfig();\n  const { GET: options } = useSettings();\n\n  const {\n    isLoading,\n    error,\n    request,\n    result: system,\n  } = useRequest(\n    useCallback(async () => {\n      const { data } = await SettingsAPI.readCategory('system');\n      if (data.DEFAULT_EXECUTION_ENVIRONMENT) {\n        const {\n          data: { name },\n        } = await ExecutionEnvironmentsAPI.readDetail(\n          data.DEFAULT_EXECUTION_ENVIRONMENT\n        );\n        data.DEFAULT_EXECUTION_ENVIRONMENT = name;\n      }\n      const systemData = pluck(\n        data,\n        'ACTIVITY_STREAM_ENABLED',\n        'ACTIVITY_STREAM_ENABLED_FOR_INVENTORY_SYNC',\n        'AUTOMATION_ANALYTICS_GATHER_INTERVAL',\n        'AUTOMATION_ANALYTICS_URL',\n        'INSIGHTS_TRACKING_STATE',\n        'MANAGE_ORGANIZATION_AUTH',\n        'ORG_ADMINS_CAN_SEE_ALL_USERS',\n        'REDHAT_USERNAME',\n        'REDHAT_PASSWORD',\n        'SUBSCRIPTIONS_USERNAME',\n        'SUBSCRIPTIONS_PASSWORD',\n        'INSTALL_UUID',\n        'REMOTE_HOST_HEADERS',\n        'TOWER_URL_BASE',\n        'DEFAULT_EXECUTION_ENVIRONMENT',\n        'PROXY_IP_ALLOWED_LIST',\n        'CSRF_TRUSTED_ORIGINS',\n        'AUTOMATION_ANALYTICS_LAST_GATHER',\n        'AUTOMATION_ANALYTICS_LAST_ENTRIES',\n        'UI_NEXT'\n      );\n\n      const mergedData = {};\n      Object.keys(systemData).forEach((key) => {\n        mergedData[key] = options[key];\n\n        if (key === 'AUTOMATION_ANALYTICS_LAST_ENTRIES') {\n          mergedData[key].value = formatJson(systemData[key]) ?? '';\n        } else {\n          mergedData[key].value = systemData[key];\n        }\n      });\n      return sortNestedDetails(mergedData);\n    }, [options]),\n    null\n  );\n\n  useEffect(() => {\n    request();\n  }, [request]);\n\n  const tabsArray = [\n    {\n      name: (\n        <>\n          <CaretLeftIcon />\n          {t`Back to Settings`}\n        </>\n      ),\n      link: `/settings`,\n      id: 99,\n    },\n    {\n      name: t`Details`,\n      link: `/settings/miscellaneous_system/details`,\n      id: 0,\n    },\n  ];\n\n  // Display this detail in a code editor for readability\n  if (options?.AUTOMATION_ANALYTICS_LAST_ENTRIES) {\n    options.AUTOMATION_ANALYTICS_LAST_ENTRIES.type = 'nested object';\n  }\n\n  return (\n    <>\n      <RoutedTabs tabsArray={tabsArray} />\n      <CardBody>\n        {isLoading && <ContentLoading />}\n        {!isLoading && error && <ContentError error={error} />}\n        {!isLoading && system && (\n          <DetailList>\n            {system.map(([key, detail]) => {\n              if (key === 'AUTOMATION_ANALYTICS_LAST_ENTRIES') {\n                return (\n                  <CodeDetail\n                    key={key}\n                    dataCy={key}\n                    helpText={detail?.help_text}\n                    label={detail?.label}\n                    mode=\"javascript\"\n                    rows={4}\n                    value={\n                      detail?.value\n                        ? JSON.stringify(detail.value, undefined, 2)\n                        : ''\n                    }\n                  />\n                );\n              }\n              return (\n                <SettingDetail\n                  key={key}\n                  id={key}\n                  helpText={detail?.help_text}\n                  label={detail?.label}\n                  type={detail?.type}\n                  unit={detail?.unit}\n                  value={detail?.value}\n                />\n              );\n            })}\n          </DetailList>\n        )}\n        {me?.is_superuser && (\n          <CardActionsRow>\n            <Button\n              ouiaId=\"system-detail-edit-button\"\n              aria-label={t`Edit`}\n              component={Link}\n              to=\"/settings/miscellaneous_system/edit\"\n            >\n              {t`Edit`}\n            </Button>\n          </CardActionsRow>\n        )}\n      </CardBody>\n    </>\n  );\n}\n\nexport default MiscSystemDetail;\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}