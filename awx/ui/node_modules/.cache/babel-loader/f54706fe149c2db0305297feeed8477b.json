{"ast":null,"code":"import _taggedTemplateLiteral from\"/awx_devel/awx/ui/node_modules/@babel/runtime/helpers/esm/taggedTemplateLiteral.js\";var _templateObject;import{i18n}from\"@lingui/core\";import React from'react';import{Link}from'react-router-dom';import{Button,Tooltip}from'@patternfly/react-core';import{Tr,Td}from'@patternfly/react-table';import{ExclamationTriangleIcon as PFExclamationTriangleIcon,PencilAltIcon}from'@patternfly/react-icons';import styled from'styled-components';import{ActionsTd,ActionItem,TdBreakWord}from'components/PaginatedTable';import StatusLabel from'components/StatusLabel';import JobCancelButton from'components/JobCancelButton';import{formatDateString}from'util/dates';import{isJobRunning}from'util/jobs';import InventorySourceSyncButton from'../shared/InventorySourceSyncButton';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";var ExclamationTriangleIcon=styled(PFExclamationTriangleIcon)(_templateObject||(_templateObject=_taggedTemplateLiteral([\"\\n  color: var(--pf-global--warning-color--100);\\n  margin-left: 18px;\\n\"])));function InventorySourceListItem(_ref){var _source$summary_field,_source$summary_field2,_job,_source$summary_field3,_source$summary_field4,_source$summary_field5,_source$summary_field6;var source=_ref.source,isSelected=_ref.isSelected,onSelect=_ref.onSelect,detailUrl=_ref.detailUrl,label=_ref.label,rowIndex=_ref.rowIndex;var generateLastJobTooltip=function generateLastJobTooltip(job){return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"div\",{children:/*i18n*/i18n._(\"MOST RECENT SYNC\")}),/*#__PURE__*/_jsxs(\"div\",{children:[/*i18n*/i18n._(\"JOB ID:\"),\" \",job.id]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*i18n*/i18n._(\"STATUS:\"),\" \",job.status.toUpperCase()]}),job.finished&&/*#__PURE__*/_jsxs(\"div\",{children:[/*i18n*/i18n._(\"FINISHED:\"),\" \",formatDateString(job.finished)]})]});};var missingExecutionEnvironment=source.custom_virtualenv&&!source.execution_environment;var job=null;if((_source$summary_field=source.summary_fields)!==null&&_source$summary_field!==void 0&&_source$summary_field.current_job){job=source.summary_fields.current_job;}else if((_source$summary_field2=source.summary_fields)!==null&&_source$summary_field2!==void 0&&_source$summary_field2.last_job){job=source.summary_fields.last_job;}return/*#__PURE__*/_jsxs(Tr,{id:\"source-row-\".concat(source.id),ouiaId:\"source-row-\".concat(source.id),children:[/*#__PURE__*/_jsx(Td,{\"data-cy\":\"check-action-\".concat(source.id),select:{rowIndex:rowIndex,isSelected:isSelected,onSelect:onSelect,disable:isJobRunning(source.status)}}),/*#__PURE__*/_jsxs(TdBreakWord,{dataLabel:/*i18n*/i18n._(\"Name\"),children:[/*#__PURE__*/_jsx(Link,{to:\"\".concat(detailUrl,\"/details\"),children:/*#__PURE__*/_jsx(\"b\",{children:source.name})}),missingExecutionEnvironment&&/*#__PURE__*/_jsx(\"span\",{children:/*#__PURE__*/_jsx(Tooltip,{className:\"missing-execution-environment\",content:/*i18n*/i18n._(\"Custom virtual environment {0} must be replaced by an execution environment.\",{0:source.custom_virtualenv}),position:\"right\",children:/*#__PURE__*/_jsx(ExclamationTriangleIcon,{})})})]}),/*#__PURE__*/_jsx(Td,{dataLabel:/*i18n*/i18n._(\"Status\"),children:job&&/*#__PURE__*/_jsx(Tooltip,{position:\"top\",content:generateLastJobTooltip(job),children:/*#__PURE__*/_jsx(Link,{to:\"/jobs/inventory/\".concat(job.id),children:/*#__PURE__*/_jsx(StatusLabel,{status:job.status})})},job.id)}),/*#__PURE__*/_jsx(Td,{dataLabel:/*i18n*/i18n._(\"Type\"),children:label}),/*#__PURE__*/_jsxs(ActionsTd,{dataLabel:/*i18n*/i18n._(\"Actions\"),children:[['running','pending','waiting'].includes((_job=job)===null||_job===void 0?void 0:_job.status)?/*#__PURE__*/_jsx(ActionItem,{visible:source.summary_fields.user_capabilities.start,children:((_source$summary_field3=source.summary_fields)===null||_source$summary_field3===void 0?void 0:(_source$summary_field4=_source$summary_field3.current_job)===null||_source$summary_field4===void 0?void 0:_source$summary_field4.id)&&/*#__PURE__*/_jsx(JobCancelButton,{job:{type:'inventory_update',id:source===null||source===void 0?void 0:(_source$summary_field5=source.summary_fields)===null||_source$summary_field5===void 0?void 0:(_source$summary_field6=_source$summary_field5.current_job)===null||_source$summary_field6===void 0?void 0:_source$summary_field6.id},errorTitle:/*i18n*/i18n._(\"Inventory Source Sync Error\"),errorMessage:/*i18n*/i18n._(\"Failed to cancel Inventory Source Sync\"),title:/*i18n*/i18n._(\"Cancel Inventory Source Sync\"),showIconButton:true})}):/*#__PURE__*/_jsx(ActionItem,{visible:source.summary_fields.user_capabilities.start,tooltip:/*i18n*/i18n._(\"Sync\"),children:/*#__PURE__*/_jsx(InventorySourceSyncButton,{source:source})}),/*#__PURE__*/_jsx(ActionItem,{visible:source.summary_fields.user_capabilities.edit,tooltip:/*i18n*/i18n._(\"Edit\"),children:/*#__PURE__*/_jsx(Button,{ouiaId:\"\".concat(source.id,\"-edit-button\"),\"aria-label\":/*i18n*/i18n._(\"Edit Source\"),variant:\"plain\",component:Link,to:\"\".concat(detailUrl,\"/edit\"),children:/*#__PURE__*/_jsx(PencilAltIcon,{})})})]})]});}export default InventorySourceListItem;","map":{"version":3,"names":["React","Link","Button","Tooltip","Tr","Td","ExclamationTriangleIcon","PFExclamationTriangleIcon","PencilAltIcon","styled","ActionsTd","ActionItem","TdBreakWord","StatusLabel","JobCancelButton","formatDateString","isJobRunning","InventorySourceSyncButton","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","_templateObject","_taggedTemplateLiteral","InventorySourceListItem","_ref","_source$summary_field","_source$summary_field2","_job","_source$summary_field3","_source$summary_field4","_source$summary_field5","_source$summary_field6","source","isSelected","onSelect","detailUrl","label","rowIndex","generateLastJobTooltip","job","children","i18n","_","id","status","toUpperCase","finished","missingExecutionEnvironment","custom_virtualenv","execution_environment","summary_fields","current_job","last_job","concat","ouiaId","select","disable","dataLabel","to","name","className","content","0","position","includes","visible","user_capabilities","start","type","errorTitle","errorMessage","title","showIconButton","tooltip","edit","variant","component"],"sources":["/awx_devel/awx/ui/src/screens/Inventory/InventorySources/InventorySourceListItem.js"],"sourcesContent":["import React from 'react';\nimport { Link } from 'react-router-dom';\nimport { t } from '@lingui/macro';\nimport { Button, Tooltip } from '@patternfly/react-core';\nimport { Tr, Td } from '@patternfly/react-table';\nimport {\n  ExclamationTriangleIcon as PFExclamationTriangleIcon,\n  PencilAltIcon,\n} from '@patternfly/react-icons';\nimport styled from 'styled-components';\n\nimport { ActionsTd, ActionItem, TdBreakWord } from 'components/PaginatedTable';\nimport StatusLabel from 'components/StatusLabel';\nimport JobCancelButton from 'components/JobCancelButton';\nimport { formatDateString } from 'util/dates';\nimport { isJobRunning } from 'util/jobs';\nimport InventorySourceSyncButton from '../shared/InventorySourceSyncButton';\n\nconst ExclamationTriangleIcon = styled(PFExclamationTriangleIcon)`\n  color: var(--pf-global--warning-color--100);\n  margin-left: 18px;\n`;\n\nfunction InventorySourceListItem({\n  source,\n  isSelected,\n  onSelect,\n  detailUrl,\n  label,\n  rowIndex,\n}) {\n  const generateLastJobTooltip = (job) => (\n    <>\n      <div>{t`MOST RECENT SYNC`}</div>\n      <div>\n        {t`JOB ID:`} {job.id}\n      </div>\n      <div>\n        {t`STATUS:`} {job.status.toUpperCase()}\n      </div>\n      {job.finished && (\n        <div>\n          {t`FINISHED:`} {formatDateString(job.finished)}\n        </div>\n      )}\n    </>\n  );\n\n  const missingExecutionEnvironment =\n    source.custom_virtualenv && !source.execution_environment;\n\n  let job = null;\n\n  if (source.summary_fields?.current_job) {\n    job = source.summary_fields.current_job;\n  } else if (source.summary_fields?.last_job) {\n    job = source.summary_fields.last_job;\n  }\n\n  return (\n    <Tr id={`source-row-${source.id}`} ouiaId={`source-row-${source.id}`}>\n      <Td\n        data-cy={`check-action-${source.id}`}\n        select={{\n          rowIndex,\n          isSelected,\n          onSelect,\n          disable: isJobRunning(source.status),\n        }}\n      />\n      <TdBreakWord dataLabel={t`Name`}>\n        <Link to={`${detailUrl}/details`}>\n          <b>{source.name}</b>\n        </Link>\n        {missingExecutionEnvironment && (\n          <span>\n            <Tooltip\n              className=\"missing-execution-environment\"\n              content={t`Custom virtual environment ${source.custom_virtualenv} must be replaced by an execution environment.`}\n              position=\"right\"\n            >\n              <ExclamationTriangleIcon />\n            </Tooltip>\n          </span>\n        )}\n      </TdBreakWord>\n      <Td dataLabel={t`Status`}>\n        {job && (\n          <Tooltip\n            position=\"top\"\n            content={generateLastJobTooltip(job)}\n            key={job.id}\n          >\n            <Link to={`/jobs/inventory/${job.id}`}>\n              <StatusLabel status={job.status} />\n            </Link>\n          </Tooltip>\n        )}\n      </Td>\n      <Td dataLabel={t`Type`}>{label}</Td>\n      <ActionsTd dataLabel={t`Actions`}>\n        {['running', 'pending', 'waiting'].includes(job?.status) ? (\n          <ActionItem visible={source.summary_fields.user_capabilities.start}>\n            {source.summary_fields?.current_job?.id && (\n              <JobCancelButton\n                job={{\n                  type: 'inventory_update',\n                  id: source?.summary_fields?.current_job?.id,\n                }}\n                errorTitle={t`Inventory Source Sync Error`}\n                errorMessage={t`Failed to cancel Inventory Source Sync`}\n                title={t`Cancel Inventory Source Sync`}\n                showIconButton\n              />\n            )}\n          </ActionItem>\n        ) : (\n          <ActionItem\n            visible={source.summary_fields.user_capabilities.start}\n            tooltip={t`Sync`}\n          >\n            <InventorySourceSyncButton source={source} />\n          </ActionItem>\n        )}\n        <ActionItem\n          visible={source.summary_fields.user_capabilities.edit}\n          tooltip={t`Edit`}\n        >\n          <Button\n            ouiaId={`${source.id}-edit-button`}\n            aria-label={t`Edit Source`}\n            variant=\"plain\"\n            component={Link}\n            to={`${detailUrl}/edit`}\n          >\n            <PencilAltIcon />\n          </Button>\n        </ActionItem>\n      </ActionsTd>\n    </Tr>\n  );\n}\nexport default InventorySourceListItem;\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}