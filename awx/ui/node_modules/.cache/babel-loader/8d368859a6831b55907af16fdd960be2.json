{"ast":null,"code":"import _asyncToGenerator from\"/awx_devel/awx/ui/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"/awx_devel/awx/ui/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import _regeneratorRuntime from\"/awx_devel/awx/ui/node_modules/@babel/runtime/regenerator/index.js\";import{i18n}from\"@lingui/core\";import React,{useState,useCallback,useEffect}from'react';import{useHistory,useParams,Link}from'react-router-dom';import{Card,PageSection}from'@patternfly/react-core';import useRequest from'hooks/useRequest';import ContentError from'components/ContentError';import ContentLoading from'components/ContentLoading';import{CardBody}from'components/Card';import{InstancesAPI}from'api';import InstanceForm from'../Shared/InstanceForm';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";function InstanceEdit(_ref){var setBreadcrumb=_ref.setBreadcrumb;var history=useHistory();var _useParams=useParams(),id=_useParams.id;var _useState=useState(),_useState2=_slicedToArray(_useState,2),formError=_useState2[0],setFormError=_useState2[1];var detailsUrl=\"/instances/\".concat(id,\"/details\");var handleSubmit=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(values){return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.prev=0;_context.next=3;return InstancesAPI.update(id,values);case 3:history.push(detailsUrl);_context.next=9;break;case 6:_context.prev=6;_context.t0=_context[\"catch\"](0);setFormError(_context.t0);case 9:case\"end\":return _context.stop();}}},_callee,null,[[0,6]]);}));return function handleSubmit(_x){return _ref2.apply(this,arguments);};}();var handleCancel=function handleCancel(){history.push(detailsUrl);};var _useRequest=useRequest(useCallback(/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(){var _yield$Promise$all,_yield$Promise$all2,instance_detail,peers_detail;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.next=2;return Promise.all([InstancesAPI.readDetail(id),InstancesAPI.readPeers(id)]);case 2:_yield$Promise$all=_context2.sent;_yield$Promise$all2=_slicedToArray(_yield$Promise$all,2);instance_detail=_yield$Promise$all2[0].data;peers_detail=_yield$Promise$all2[1].data;return _context2.abrupt(\"return\",{instance:instance_detail,peers:peers_detail.results});case 7:case\"end\":return _context2.stop();}}},_callee2);})),[id]),{instance:{},peers:[]}),isLoading=_useRequest.isLoading,error=_useRequest.error,fetchDetail=_useRequest.request,_useRequest$result=_useRequest.result,instance=_useRequest$result.instance,peers=_useRequest$result.peers;useEffect(function(){fetchDetail();},[fetchDetail]);useEffect(function(){if(instance){setBreadcrumb(instance);}},[instance,setBreadcrumb]);if(isLoading){return/*#__PURE__*/_jsx(CardBody,{children:/*#__PURE__*/_jsx(ContentLoading,{})});}if(error){var _error$response;return/*#__PURE__*/_jsx(CardBody,{children:/*#__PURE__*/_jsx(ContentError,{error:error,children:(error===null||error===void 0?void 0:(_error$response=error.response)===null||_error$response===void 0?void 0:_error$response.status)===404&&/*#__PURE__*/_jsxs(\"span\",{children:[/*i18n*/i18n._(\"Instance not found.\"),' ',/*#__PURE__*/_jsx(Link,{to:\"/instances\",children:/*i18n*/i18n._(\"View all Instances.\")})]})})});}return/*#__PURE__*/_jsx(PageSection,{children:/*#__PURE__*/_jsx(Card,{children:/*#__PURE__*/_jsx(InstanceForm,{instance:instance,instance_peers:peers,isEdit:true,submitError:formError,handleSubmit:handleSubmit,handleCancel:handleCancel})})});}export default InstanceEdit;","map":{"version":3,"names":["React","useState","useCallback","useEffect","useHistory","useParams","Link","Card","PageSection","useRequest","ContentError","ContentLoading","CardBody","InstancesAPI","InstanceForm","jsx","_jsx","jsxs","_jsxs","InstanceEdit","_ref","setBreadcrumb","history","_useParams","id","_useState","_useState2","_slicedToArray","formError","setFormError","detailsUrl","concat","handleSubmit","_ref2","_asyncToGenerator","_regeneratorRuntime","mark","_callee","values","wrap","_callee$","_context","prev","next","update","push","t0","stop","_x","apply","arguments","handleCancel","_useRequest","_callee2","_yield$Promise$all","_yield$Promise$all2","instance_detail","peers_detail","_callee2$","_context2","Promise","all","readDetail","readPeers","sent","data","abrupt","instance","peers","results","isLoading","error","fetchDetail","request","_useRequest$result","result","children","_error$response","response","status","i18n","_","to","instance_peers","isEdit","submitError"],"sources":["/awx_devel/awx/ui/src/screens/Instances/InstanceEdit/InstanceEdit.js"],"sourcesContent":["import React, { useState, useCallback, useEffect } from 'react';\n\nimport { t } from '@lingui/macro';\nimport { useHistory, useParams, Link } from 'react-router-dom';\nimport { Card, PageSection } from '@patternfly/react-core';\nimport useRequest from 'hooks/useRequest';\nimport ContentError from 'components/ContentError';\nimport ContentLoading from 'components/ContentLoading';\nimport { CardBody } from 'components/Card';\nimport { InstancesAPI } from 'api';\nimport InstanceForm from '../Shared/InstanceForm';\n\nfunction InstanceEdit({ setBreadcrumb }) {\n  const history = useHistory();\n  const { id } = useParams();\n  const [formError, setFormError] = useState();\n\n  const detailsUrl = `/instances/${id}/details`;\n\n  const handleSubmit = async (values) => {\n    try {\n      await InstancesAPI.update(id, values);\n      history.push(detailsUrl);\n    } catch (err) {\n      setFormError(err);\n    }\n  };\n\n  const handleCancel = () => {\n    history.push(detailsUrl);\n  };\n\n  const {\n    isLoading,\n    error,\n    request: fetchDetail,\n    result: { instance, peers },\n  } = useRequest(\n    useCallback(async () => {\n      const [{ data: instance_detail }, { data: peers_detail }] =\n        await Promise.all([\n          InstancesAPI.readDetail(id),\n          InstancesAPI.readPeers(id),\n        ]);\n      return {\n        instance: instance_detail,\n        peers: peers_detail.results,\n      };\n    }, [id]),\n    {\n      instance: {},\n      peers: [],\n    }\n  );\n\n  useEffect(() => {\n    fetchDetail();\n  }, [fetchDetail]);\n\n  useEffect(() => {\n    if (instance) {\n      setBreadcrumb(instance);\n    }\n  }, [instance, setBreadcrumb]);\n\n  if (isLoading) {\n    return (\n      <CardBody>\n        <ContentLoading />\n      </CardBody>\n    );\n  }\n\n  if (error) {\n    return (\n      <CardBody>\n        <ContentError error={error}>\n          {error?.response?.status === 404 && (\n            <span>\n              {t`Instance not found.`}{' '}\n              <Link to=\"/instances\">{t`View all Instances.`}</Link>\n            </span>\n          )}\n        </ContentError>\n      </CardBody>\n    );\n  }\n\n  return (\n    <PageSection>\n      <Card>\n        <InstanceForm\n          instance={instance}\n          instance_peers={peers}\n          isEdit\n          submitError={formError}\n          handleSubmit={handleSubmit}\n          handleCancel={handleCancel}\n        />\n      </Card>\n    </PageSection>\n  );\n}\n\nexport default InstanceEdit;\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}