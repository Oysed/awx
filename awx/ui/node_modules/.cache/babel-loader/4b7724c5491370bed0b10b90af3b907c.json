{"ast":null,"code":"import _objectSpread from\"/awx_devel/awx/ui/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import _asyncToGenerator from\"/awx_devel/awx/ui/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"/awx_devel/awx/ui/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import _taggedTemplateLiteral from\"/awx_devel/awx/ui/node_modules/@babel/runtime/helpers/esm/taggedTemplateLiteral.js\";var _templateObject;import _regeneratorRuntime from\"/awx_devel/awx/ui/node_modules/@babel/runtime/regenerator/index.js\";import{i18n}from\"@lingui/core\";import React,{useEffect,useState,useCallback}from'react';import{useHistory}from'react-router-dom';import styled from'styled-components';import debounce from'util/debounce';import*as d3 from'd3';import{InstancesAPI}from'api';import useRequest,{useDismissableError}from'hooks/useRequest';import AlertModal from'components/AlertModal';import ErrorDetail from'components/ErrorDetail';import Legend from'./Legend';import Tooltip from'./Tooltip';import ContentLoading from'./ContentLoading';import{renderStateColor,renderLinkStatusColor,renderLabelText,renderNodeType,renderNodeIcon,renderLinkState,renderLabelIcons,renderIconPosition,redirectToDetailsPage as _redirectToDetailsPage,getHeight,getWidth}from'./utils/helpers';import webWorker from'../../util/webWorker';import{DEFAULT_RADIUS,DEFAULT_NODE_COLOR,DEFAULT_NODE_HIGHLIGHT_COLOR,DEFAULT_NODE_SYMBOL_TEXT_COLOR,DEFAULT_NODE_STROKE_COLOR,DEFAULT_FONT_SIZE,SELECTOR}from'./constants';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var Loader=styled(ContentLoading)(_templateObject||(_templateObject=_taggedTemplateLiteral([\"\\n  height: 100%;\\n  position: absolute;\\n  width: 100%;\\n  background: white;\\n\"])));function MeshGraph(_ref){var data=_ref.data,showLegend=_ref.showLegend,zoom=_ref.zoom,setShowZoomControls=_ref.setShowZoomControls,storedNodes=_ref.storedNodes;var _useState=useState(false),_useState2=_slicedToArray(_useState,2),isNodeSelected=_useState2[0],setIsNodeSelected=_useState2[1];var _useState3=useState(null),_useState4=_slicedToArray(_useState3,2),selectedNode=_useState4[0],setSelectedNode=_useState4[1];var _useState5=useState(null),_useState6=_slicedToArray(_useState5,2),simulationProgress=_useState6[0],setSimulationProgress=_useState6[1];var history=useHistory();var _useRequest=useRequest(useCallback(/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var _yield$InstancesAPI$r,instanceData,_yield$InstancesAPI$r2,instanceGroupsData;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return InstancesAPI.readDetail(selectedNode.id);case 2:_yield$InstancesAPI$r=_context.sent;instanceData=_yield$InstancesAPI$r.data;_context.next=6;return InstancesAPI.readInstanceGroup(selectedNode.id);case 6:_yield$InstancesAPI$r2=_context.sent;instanceGroupsData=_yield$InstancesAPI$r2.data;return _context.abrupt(\"return\",{instance:instanceData,instanceGroups:instanceGroupsData});case 9:case\"end\":return _context.stop();}}},_callee);})),[selectedNode]),{result:{}}),_useRequest$result=_useRequest.result,_useRequest$result$in=_useRequest$result.instance,instance=_useRequest$result$in===void 0?{}:_useRequest$result$in,instanceGroups=_useRequest$result.instanceGroups,fetchError=_useRequest.error,isLoading=_useRequest.isLoading,fetchDetails=_useRequest.request;var _useDismissableError=useDismissableError(fetchError),fetchInstanceError=_useDismissableError.error,dismissError=_useDismissableError.dismissError;useEffect(function(){if(selectedNode){fetchDetails();}},[selectedNode,fetchDetails]);function updateNodeSVG(nodes){if(nodes){d3.selectAll('[class*=\"id-\"]').data(nodes).attr('stroke-dasharray',function(d){return d.enabled?\"1 0\":\"5\";});}}useEffect(function(){function handleResize(){d3.select('.simulation-loader').style('visibility','visible');setSelectedNode(null);setIsNodeSelected(false);draw();}window.addEventListener('resize',debounce(handleResize,500));handleResize();return function(){return window.removeEventListener('resize',handleResize);};},[]);// eslint-disable-line react-hooks/exhaustive-deps\n// update mesh when user toggles enabled/disabled slider\nuseEffect(function(){if(instance!==null&&instance!==void 0&&instance.id){var updatedNodes=storedNodes.current.map(function(n){return n.id===instance.id?_objectSpread(_objectSpread({},n),{},{enabled:instance.enabled}):n;});storedNodes.current=updatedNodes;updateNodeSVG(storedNodes.current);}},[instance]);// eslint-disable-line react-hooks/exhaustive-deps\nvar draw=function draw(){var width;var height;setShowZoomControls(false);try{width=getWidth(SELECTOR);height=getHeight(SELECTOR);}catch(error){width=700;height=600;}/* Add SVG */d3.selectAll(\"#chart > svg\").remove();var svg=d3.select('#chart').append('svg').attr('aria-label','mesh-svg').attr('class','mesh-svg').attr('width',\"\".concat(width,\"px\")).attr('height',\"100%\");var mesh=svg.append('g').attr('class','mesh');var graph=data;if(storedNodes!==null&&storedNodes!==void 0&&storedNodes.current){graph.nodes=storedNodes.current;}/* WEB WORKER */var worker=webWorker();worker.postMessage({nodes:graph.nodes,links:graph.links});worker.onmessage=function handleWorkerEvent(event){switch(event.data.type){case'tick':return ticked(event.data);case'end':return ended(event.data);default:return false;}};function ticked(_ref3){var progress=_ref3.progress;var calculatedPercent=Math.round(progress*100);setSimulationProgress(calculatedPercent);}function ended(_ref4){var nodes=_ref4.nodes,links=_ref4.links;// Remove loading screen\nd3.select('.simulation-loader').style('visibility','hidden');setShowZoomControls(true);// Center the mesh\nvar simulation=d3.forceSimulation(nodes).force('center',d3.forceCenter(width/2,height/2));simulation.tick();// build the arrow.\nmesh.append('defs').selectAll('marker').data(['end','end-active','end-adding','end-removing']).join('marker').attr('id',String).attr('viewBox','0 -5 10 10').attr('refY',0).attr('markerWidth',6).attr('markerHeight',6).attr('orient','auto').append('path').attr('d','M0,-5L10,0L0,5');mesh.select('#end').attr('refX',23).attr('fill','#6A6E73');mesh.select('#end-removing').attr('refX',23).attr('fill','#C9190B');mesh.select('#end-adding').attr('refX',23).attr('fill','#3E8635');mesh.select('#end-active').attr('refX',18).attr('fill','#0066CC');// Add links\nmesh.append('g').attr('class',\"links\").attr('data-cy','links').selectAll('line').data(links).enter().append('line').attr('x1',function(d){return d.source.x;}).attr('y1',function(d){return d.source.y;}).attr('x2',function(d){return d.target.x;}).attr('y2',function(d){return d.target.y;}).attr('marker-end',function(d){if(d.link_state==='adding'){return'url(#end-adding)';}if(d.link_state==='removing'){return'url(#end-removing)';}return'url(#end)';}).attr('class',function(_,i){return\"link-\".concat(i);}).attr('data-cy',function(d){return\"\".concat(d.source.hostname,\"-\").concat(d.target.hostname);}).style('fill','none').style('stroke',function(d){return renderLinkStatusColor(d.link_state);}).style('stroke-width','2px').style('stroke-dasharray',function(d){return renderLinkState(d.link_state);}).attr('pointer-events','none').on('mouseover',function showPointer(){d3.select(this).style('cursor','pointer');});// add nodes\nvar node=mesh.append('g').attr('class','nodes').attr('data-cy','nodes').selectAll('g').data(nodes).enter().append('g').attr('data-cy',function(d){return\"node-\".concat(d.id);}).on('mouseenter',function handleNodeHover(_,d){d3.select(this).style('cursor','pointer');highlightSiblings(d);}).on('mouseleave',function(_,d){deselectSiblings(d);}).on('click',function(_,d){highlightSelected(d);});// node circles\nvar nodeCircles=node.append('g');nodeCircles.append('circle').attr('r',DEFAULT_RADIUS).attr('cx',function(d){return d.x;}).attr('cy',function(d){return d.y;}).attr('class',function(d){return d.node_type;}).attr('class',function(d){return\"id-\".concat(d.id);}).attr('fill',DEFAULT_NODE_COLOR).attr('stroke-dasharray',function(d){return d.enabled?\"1 0\":\"5\";}).attr('stroke',function(d){return renderStateColor(d.node_state);});// node type labels\nnode.append('text').text(function(d){return renderNodeType(d.node_type);}).attr('x',function(d){return d.x;}).attr('y',function(d){return d.y;}).attr('text-anchor','middle').attr('dominant-baseline','central').attr('fill',DEFAULT_NODE_SYMBOL_TEXT_COLOR);// node hostname labels\nvar hostNames=node.append('g').attr('class','node-state-label');hostNames.append('text').attr('x',function(d){return d.x;}).attr('y',function(d){return d.y+40;}).text(function(d){return renderLabelText(d.node_state,d.hostname);}).attr('class','placeholder').attr('fill','white').attr('text-anchor','middle').each(function calculateLabelWidth(){// eslint-disable-next-line react/no-this-in-sfc\nvar bbox=this.getBBox();var padding=10;// eslint-disable-next-line react/no-this-in-sfc\nd3.select(this.parentNode).append('rect').attr('x',bbox.x-padding/2).attr('y',bbox.y).attr('width',bbox.width+padding).attr('height',bbox.height).style('stroke-width',1).attr('rx',4).attr('ry',4).attr('fill','white').style('stroke',DEFAULT_NODE_STROKE_COLOR);});svg.selectAll('text.placeholder').remove();hostNames.append('text').attr('x',function(d){return d.x;}).attr('y',function(d){return d.y+38;}).text(function(d){return renderLabelText(d.node_state,d.hostname);}).attr('font-size',DEFAULT_FONT_SIZE).attr('fill','black').attr('text-anchor','middle');// add badge icons\nvar badges=nodeCircles.append('g').attr('class','node-state-badge');badges.each(function drawStateBadge(){// eslint-disable-next-line react/no-this-in-sfc\nvar bbox=this.parentNode.getBBox();// eslint-disable-next-line react/no-this-in-sfc\nd3.select(this).append('circle').attr('r',9).attr('cx',bbox.x).attr('cy',bbox.y).attr('fill',function(d){return renderStateColor(d.node_state);});d3.select(this).append('path').attr('class',function(d){return\"icon-\".concat(d.node_state);}).attr('d',function(d){return renderLabelIcons(d.node_state);}).attr('transform',function(d){return renderIconPosition(d.node_state,bbox);}).attr('fill','white');});svg.call(zoom);function highlightSiblings(n){svg.select(\"circle.id-\".concat(n.id)).attr('fill',DEFAULT_NODE_HIGHLIGHT_COLOR);var immediate=links.filter(function(l){return n.hostname===l.source.hostname||n.hostname===l.target.hostname;});immediate.forEach(function(s){svg.selectAll(\".link-\".concat(s.index)).style('stroke','#0066CC').style('stroke-width','3px').attr('marker-end','url(#end-active)');});}function deselectSiblings(n){svg.select(\"circle.id-\".concat(n.id)).attr('fill',DEFAULT_NODE_COLOR);var immediate=links.filter(function(l){return n.hostname===l.source.hostname||n.hostname===l.target.hostname;});immediate.forEach(function(s){svg.selectAll(\".link-\".concat(s.index)).style('stroke',function(d){return renderLinkStatusColor(d.link_state);}).style('stroke-width','2px').attr('marker-end',function(d){if(d.link_state==='adding'){return'url(#end-adding)';}if(d.link_state==='removing'){return'url(#end-removing)';}return'url(#end)';});});}function highlightSelected(n){if(svg.select(\"circle.id-\".concat(n.id)).attr('stroke-width')!==null){// toggle rings\nsvg.select(\"circle.id-\".concat(n.id)).attr('stroke',function(d){return renderStateColor(d.node_state);}).attr('stroke-width',null);// show default empty state of tooltip\nsetIsNodeSelected(false);setSelectedNode(null);return;}svg.selectAll('circle').attr('stroke',function(d){return renderStateColor(d.node_state);}).attr('stroke-width',null);svg.select(\"circle.id-\".concat(n.id)).attr('stroke-width','5px').attr('stroke','#0066CC');setIsNodeSelected(true);setSelectedNode(n);}}};return/*#__PURE__*/_jsxs(\"div\",{id:\"chart\",style:{position:'relative',height:'100%'},children:[showLegend&&/*#__PURE__*/_jsx(Legend,{}),instance&&/*#__PURE__*/_jsx(Tooltip,{isNodeSelected:isNodeSelected,renderNodeIcon:renderNodeIcon(selectedNode),selectedNode:selectedNode,fetchInstance:fetchDetails,instanceGroups:instanceGroups,instanceDetail:instance,isLoading:isLoading,redirectToDetailsPage:function redirectToDetailsPage(){return _redirectToDetailsPage(selectedNode,history);}}),/*#__PURE__*/_jsx(Loader,{className:\"simulation-loader\",progress:simulationProgress}),fetchInstanceError&&/*#__PURE__*/_jsxs(AlertModal,{variant:\"error\",title:/*i18n*/i18n._(\"Error!\"),isOpen:true,onClose:dismissError,children:[/*i18n*/i18n._(\"Failed to get instance.\"),/*#__PURE__*/_jsx(ErrorDetail,{error:fetchInstanceError})]})]});}export default MeshGraph;","map":{"version":3,"names":["React","useEffect","useState","useCallback","useHistory","styled","debounce","d3","InstancesAPI","useRequest","useDismissableError","AlertModal","ErrorDetail","Legend","Tooltip","ContentLoading","renderStateColor","renderLinkStatusColor","renderLabelText","renderNodeType","renderNodeIcon","renderLinkState","renderLabelIcons","renderIconPosition","redirectToDetailsPage","getHeight","getWidth","webWorker","DEFAULT_RADIUS","DEFAULT_NODE_COLOR","DEFAULT_NODE_HIGHLIGHT_COLOR","DEFAULT_NODE_SYMBOL_TEXT_COLOR","DEFAULT_NODE_STROKE_COLOR","DEFAULT_FONT_SIZE","SELECTOR","jsx","_jsx","jsxs","_jsxs","Loader","_templateObject","_taggedTemplateLiteral","MeshGraph","_ref","data","showLegend","zoom","setShowZoomControls","storedNodes","_useState","_useState2","_slicedToArray","isNodeSelected","setIsNodeSelected","_useState3","_useState4","selectedNode","setSelectedNode","_useState5","_useState6","simulationProgress","setSimulationProgress","history","_useRequest","_asyncToGenerator","_regeneratorRuntime","mark","_callee","_yield$InstancesAPI$r","instanceData","_yield$InstancesAPI$r2","instanceGroupsData","wrap","_callee$","_context","prev","next","readDetail","id","sent","readInstanceGroup","abrupt","instance","instanceGroups","stop","result","_useRequest$result","_useRequest$result$in","fetchError","error","isLoading","fetchDetails","request","_useDismissableError","fetchInstanceError","dismissError","updateNodeSVG","nodes","selectAll","attr","d","enabled","handleResize","select","style","draw","window","addEventListener","removeEventListener","updatedNodes","current","map","n","_objectSpread","width","height","remove","svg","append","concat","mesh","graph","worker","postMessage","links","onmessage","handleWorkerEvent","event","type","ticked","ended","_ref3","progress","calculatedPercent","Math","round","_ref4","simulation","forceSimulation","force","forceCenter","tick","join","String","enter","source","x","y","target","link_state","_","i","hostname","on","showPointer","node","handleNodeHover","highlightSiblings","deselectSiblings","highlightSelected","nodeCircles","node_type","node_state","text","hostNames","each","calculateLabelWidth","bbox","getBBox","padding","parentNode","badges","drawStateBadge","call","immediate","filter","l","forEach","s","index","position","children","fetchInstance","instanceDetail","className","variant","title","i18n","isOpen","onClose"],"sources":["/awx_devel/awx/ui/src/screens/TopologyView/MeshGraph.js"],"sourcesContent":["import React, { useEffect, useState, useCallback } from 'react';\nimport { useHistory } from 'react-router-dom';\nimport { t } from '@lingui/macro';\nimport styled from 'styled-components';\nimport debounce from 'util/debounce';\nimport * as d3 from 'd3';\nimport { InstancesAPI } from 'api';\nimport useRequest, { useDismissableError } from 'hooks/useRequest';\nimport AlertModal from 'components/AlertModal';\nimport ErrorDetail from 'components/ErrorDetail';\nimport Legend from './Legend';\nimport Tooltip from './Tooltip';\nimport ContentLoading from './ContentLoading';\nimport {\n  renderStateColor,\n  renderLinkStatusColor,\n  renderLabelText,\n  renderNodeType,\n  renderNodeIcon,\n  renderLinkState,\n  renderLabelIcons,\n  renderIconPosition,\n  redirectToDetailsPage,\n  getHeight,\n  getWidth,\n} from './utils/helpers';\nimport webWorker from '../../util/webWorker';\nimport {\n  DEFAULT_RADIUS,\n  DEFAULT_NODE_COLOR,\n  DEFAULT_NODE_HIGHLIGHT_COLOR,\n  DEFAULT_NODE_SYMBOL_TEXT_COLOR,\n  DEFAULT_NODE_STROKE_COLOR,\n  DEFAULT_FONT_SIZE,\n  SELECTOR,\n} from './constants';\n\nconst Loader = styled(ContentLoading)`\n  height: 100%;\n  position: absolute;\n  width: 100%;\n  background: white;\n`;\nfunction MeshGraph({\n  data,\n  showLegend,\n  zoom,\n  setShowZoomControls,\n  storedNodes,\n}) {\n  const [isNodeSelected, setIsNodeSelected] = useState(false);\n  const [selectedNode, setSelectedNode] = useState(null);\n  const [simulationProgress, setSimulationProgress] = useState(null);\n  const history = useHistory();\n  const {\n    result: { instance = {}, instanceGroups },\n    error: fetchError,\n    isLoading,\n    request: fetchDetails,\n  } = useRequest(\n    useCallback(async () => {\n      const { data: instanceData } = await InstancesAPI.readDetail(\n        selectedNode.id\n      );\n      const { data: instanceGroupsData } = await InstancesAPI.readInstanceGroup(\n        selectedNode.id\n      );\n      return {\n        instance: instanceData,\n        instanceGroups: instanceGroupsData,\n      };\n    }, [selectedNode]),\n    {\n      result: {},\n    }\n  );\n  const { error: fetchInstanceError, dismissError } =\n    useDismissableError(fetchError);\n\n  useEffect(() => {\n    if (selectedNode) {\n      fetchDetails();\n    }\n  }, [selectedNode, fetchDetails]);\n\n  function updateNodeSVG(nodes) {\n    if (nodes) {\n      d3.selectAll('[class*=\"id-\"]')\n        .data(nodes)\n        .attr('stroke-dasharray', (d) => (d.enabled ? `1 0` : `5`));\n    }\n  }\n\n  useEffect(() => {\n    function handleResize() {\n      d3.select('.simulation-loader').style('visibility', 'visible');\n      setSelectedNode(null);\n      setIsNodeSelected(false);\n      draw();\n    }\n    window.addEventListener('resize', debounce(handleResize, 500));\n    handleResize();\n    return () => window.removeEventListener('resize', handleResize);\n  }, []); // eslint-disable-line react-hooks/exhaustive-deps\n\n  // update mesh when user toggles enabled/disabled slider\n  useEffect(() => {\n    if (instance?.id) {\n      const updatedNodes = storedNodes.current.map((n) =>\n        n.id === instance.id ? { ...n, enabled: instance.enabled } : n\n      );\n      storedNodes.current = updatedNodes;\n      updateNodeSVG(storedNodes.current);\n    }\n  }, [instance]); // eslint-disable-line react-hooks/exhaustive-deps\n\n  const draw = () => {\n    let width;\n    let height;\n    setShowZoomControls(false);\n    try {\n      width = getWidth(SELECTOR);\n      height = getHeight(SELECTOR);\n    } catch (error) {\n      width = 700;\n      height = 600;\n    }\n\n    /* Add SVG */\n    d3.selectAll(`#chart > svg`).remove();\n    const svg = d3\n      .select('#chart')\n      .append('svg')\n      .attr('aria-label', 'mesh-svg')\n      .attr('class', 'mesh-svg')\n      .attr('width', `${width}px`)\n      .attr('height', `100%`);\n    const mesh = svg.append('g').attr('class', 'mesh');\n\n    const graph = data;\n    if (storedNodes?.current) {\n      graph.nodes = storedNodes.current;\n    }\n\n    /* WEB WORKER */\n    const worker = webWorker();\n    worker.postMessage({\n      nodes: graph.nodes,\n      links: graph.links,\n    });\n\n    worker.onmessage = function handleWorkerEvent(event) {\n      switch (event.data.type) {\n        case 'tick':\n          return ticked(event.data);\n        case 'end':\n          return ended(event.data);\n        default:\n          return false;\n      }\n    };\n\n    function ticked({ progress }) {\n      const calculatedPercent = Math.round(progress * 100);\n      setSimulationProgress(calculatedPercent);\n    }\n\n    function ended({ nodes, links }) {\n      // Remove loading screen\n      d3.select('.simulation-loader').style('visibility', 'hidden');\n      setShowZoomControls(true);\n      // Center the mesh\n      const simulation = d3\n        .forceSimulation(nodes)\n        .force('center', d3.forceCenter(width / 2, height / 2));\n      simulation.tick();\n      // build the arrow.\n      mesh\n        .append('defs')\n        .selectAll('marker')\n        .data(['end', 'end-active', 'end-adding', 'end-removing'])\n        .join('marker')\n        .attr('id', String)\n        .attr('viewBox', '0 -5 10 10')\n        .attr('refY', 0)\n        .attr('markerWidth', 6)\n        .attr('markerHeight', 6)\n        .attr('orient', 'auto')\n        .append('path')\n        .attr('d', 'M0,-5L10,0L0,5');\n      mesh.select('#end').attr('refX', 23).attr('fill', '#6A6E73');\n      mesh.select('#end-removing').attr('refX', 23).attr('fill', '#C9190B');\n      mesh.select('#end-adding').attr('refX', 23).attr('fill', '#3E8635');\n      mesh.select('#end-active').attr('refX', 18).attr('fill', '#0066CC');\n\n      // Add links\n      mesh\n        .append('g')\n        .attr('class', `links`)\n        .attr('data-cy', 'links')\n        .selectAll('line')\n        .data(links)\n        .enter()\n        .append('line')\n        .attr('x1', (d) => d.source.x)\n        .attr('y1', (d) => d.source.y)\n        .attr('x2', (d) => d.target.x)\n        .attr('y2', (d) => d.target.y)\n        .attr('marker-end', (d) => {\n          if (d.link_state === 'adding') {\n            return 'url(#end-adding)';\n          }\n          if (d.link_state === 'removing') {\n            return 'url(#end-removing)';\n          }\n          return 'url(#end)';\n        })\n        .attr('class', (_, i) => `link-${i}`)\n        .attr('data-cy', (d) => `${d.source.hostname}-${d.target.hostname}`)\n        .style('fill', 'none')\n        .style('stroke', (d) => renderLinkStatusColor(d.link_state))\n        .style('stroke-width', '2px')\n        .style('stroke-dasharray', (d) => renderLinkState(d.link_state))\n        .attr('pointer-events', 'none')\n        .on('mouseover', function showPointer() {\n          d3.select(this).style('cursor', 'pointer');\n        });\n      // add nodes\n      const node = mesh\n        .append('g')\n        .attr('class', 'nodes')\n        .attr('data-cy', 'nodes')\n        .selectAll('g')\n        .data(nodes)\n        .enter()\n        .append('g')\n        .attr('data-cy', (d) => `node-${d.id}`)\n        .on('mouseenter', function handleNodeHover(_, d) {\n          d3.select(this).style('cursor', 'pointer');\n          highlightSiblings(d);\n        })\n        .on('mouseleave', (_, d) => {\n          deselectSiblings(d);\n        })\n        .on('click', (_, d) => {\n          highlightSelected(d);\n        });\n\n      // node circles\n      const nodeCircles = node.append('g');\n      nodeCircles\n        .append('circle')\n        .attr('r', DEFAULT_RADIUS)\n        .attr('cx', (d) => d.x)\n        .attr('cy', (d) => d.y)\n        .attr('class', (d) => d.node_type)\n        .attr('class', (d) => `id-${d.id}`)\n        .attr('fill', DEFAULT_NODE_COLOR)\n        .attr('stroke-dasharray', (d) => (d.enabled ? `1 0` : `5`))\n        .attr('stroke', (d) => renderStateColor(d.node_state));\n\n      // node type labels\n      node\n        .append('text')\n        .text((d) => renderNodeType(d.node_type))\n        .attr('x', (d) => d.x)\n        .attr('y', (d) => d.y)\n        .attr('text-anchor', 'middle')\n        .attr('dominant-baseline', 'central')\n        .attr('fill', DEFAULT_NODE_SYMBOL_TEXT_COLOR);\n\n      // node hostname labels\n      const hostNames = node.append('g').attr('class', 'node-state-label');\n      hostNames\n        .append('text')\n        .attr('x', (d) => d.x)\n        .attr('y', (d) => d.y + 40)\n        .text((d) => renderLabelText(d.node_state, d.hostname))\n        .attr('class', 'placeholder')\n        .attr('fill', 'white')\n        .attr('text-anchor', 'middle')\n        .each(function calculateLabelWidth() {\n          // eslint-disable-next-line react/no-this-in-sfc\n          const bbox = this.getBBox();\n          const padding = 10;\n          // eslint-disable-next-line react/no-this-in-sfc\n          d3.select(this.parentNode)\n            .append('rect')\n            .attr('x', bbox.x - padding / 2)\n            .attr('y', bbox.y)\n            .attr('width', bbox.width + padding)\n            .attr('height', bbox.height)\n            .style('stroke-width', 1)\n            .attr('rx', 4)\n            .attr('ry', 4)\n            .attr('fill', 'white')\n            .style('stroke', DEFAULT_NODE_STROKE_COLOR);\n        });\n      svg.selectAll('text.placeholder').remove();\n      hostNames\n        .append('text')\n        .attr('x', (d) => d.x)\n        .attr('y', (d) => d.y + 38)\n        .text((d) => renderLabelText(d.node_state, d.hostname))\n        .attr('font-size', DEFAULT_FONT_SIZE)\n        .attr('fill', 'black')\n        .attr('text-anchor', 'middle');\n\n      // add badge icons\n      const badges = nodeCircles.append('g').attr('class', 'node-state-badge');\n      badges.each(function drawStateBadge() {\n        // eslint-disable-next-line react/no-this-in-sfc\n        const bbox = this.parentNode.getBBox();\n        // eslint-disable-next-line react/no-this-in-sfc\n        d3.select(this)\n          .append('circle')\n          .attr('r', 9)\n          .attr('cx', bbox.x)\n          .attr('cy', bbox.y)\n          .attr('fill', (d) => renderStateColor(d.node_state));\n        d3.select(this)\n          .append('path')\n          .attr('class', (d) => `icon-${d.node_state}`)\n          .attr('d', (d) => renderLabelIcons(d.node_state))\n          .attr('transform', (d) => renderIconPosition(d.node_state, bbox))\n          .attr('fill', 'white');\n      });\n      svg.call(zoom);\n\n      function highlightSiblings(n) {\n        svg\n          .select(`circle.id-${n.id}`)\n          .attr('fill', DEFAULT_NODE_HIGHLIGHT_COLOR);\n        const immediate = links.filter(\n          (l) =>\n            n.hostname === l.source.hostname || n.hostname === l.target.hostname\n        );\n        immediate.forEach((s) => {\n          svg\n            .selectAll(`.link-${s.index}`)\n            .style('stroke', '#0066CC')\n            .style('stroke-width', '3px')\n            .attr('marker-end', 'url(#end-active)');\n        });\n      }\n\n      function deselectSiblings(n) {\n        svg.select(`circle.id-${n.id}`).attr('fill', DEFAULT_NODE_COLOR);\n        const immediate = links.filter(\n          (l) =>\n            n.hostname === l.source.hostname || n.hostname === l.target.hostname\n        );\n        immediate.forEach((s) => {\n          svg\n            .selectAll(`.link-${s.index}`)\n            .style('stroke', (d) => renderLinkStatusColor(d.link_state))\n            .style('stroke-width', '2px')\n            .attr('marker-end', (d) => {\n              if (d.link_state === 'adding') {\n                return 'url(#end-adding)';\n              }\n              if (d.link_state === 'removing') {\n                return 'url(#end-removing)';\n              }\n              return 'url(#end)';\n            });\n        });\n      }\n\n      function highlightSelected(n) {\n        if (svg.select(`circle.id-${n.id}`).attr('stroke-width') !== null) {\n          // toggle rings\n          svg\n            .select(`circle.id-${n.id}`)\n            .attr('stroke', (d) => renderStateColor(d.node_state))\n            .attr('stroke-width', null);\n          // show default empty state of tooltip\n          setIsNodeSelected(false);\n          setSelectedNode(null);\n          return;\n        }\n        svg\n          .selectAll('circle')\n          .attr('stroke', (d) => renderStateColor(d.node_state))\n          .attr('stroke-width', null);\n        svg\n          .select(`circle.id-${n.id}`)\n          .attr('stroke-width', '5px')\n          .attr('stroke', '#0066CC');\n        setIsNodeSelected(true);\n        setSelectedNode(n);\n      }\n    }\n  };\n\n  return (\n    <div id=\"chart\" style={{ position: 'relative', height: '100%' }}>\n      {showLegend && <Legend />}\n      {instance && (\n        <Tooltip\n          isNodeSelected={isNodeSelected}\n          renderNodeIcon={renderNodeIcon(selectedNode)}\n          selectedNode={selectedNode}\n          fetchInstance={fetchDetails}\n          instanceGroups={instanceGroups}\n          instanceDetail={instance}\n          isLoading={isLoading}\n          redirectToDetailsPage={() =>\n            redirectToDetailsPage(selectedNode, history)\n          }\n        />\n      )}\n      <Loader className=\"simulation-loader\" progress={simulationProgress} />\n      {fetchInstanceError && (\n        <AlertModal\n          variant=\"error\"\n          title={t`Error!`}\n          isOpen\n          onClose={dismissError}\n        >\n          {t`Failed to get instance.`}\n          <ErrorDetail error={fetchInstanceError} />\n        </AlertModal>\n      )}\n    </div>\n  );\n}\n\nexport default MeshGraph;\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}